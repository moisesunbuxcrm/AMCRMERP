{"version":3,"sources":["types/Status.ts","Layout/Layout.tsx","store/hooks.ts","types/EstimateStatus.ts","store/mock/customers-mock.ts","store/customersSlice.ts","types/ModuleType.ts","types/ItemType.ts","store/Estimate.ts","types/WinType.ts","store/mock/estimates-mock.ts","store/estimatesSlice.ts","store/mock/defaults-mock.ts","store/defaultsSlice.ts","Components/ModalOptions/ProductOptions.tsx","types/formats.ts","Components/Estimates/TotalsTable.tsx","Components/ProductSummary/ProductComponent.tsx","Components/ProductSummary/ImpactProductComponent.tsx","Components/ProductSummary/HardwareComponent.tsx","store/EstimateTotals.ts","store/validations/checkEmergencyExits.ts","store/validations.ts","store/validations/checkBathroomOpenings.ts","store/validations/checkRequiredHardware.ts","effects/useModifiedAlert.ts","Components/ModalOptions/RoomOptions.tsx","Components/Estimates/EstimateOptions.tsx","types/Colors.ts","Components/Estimates/Initial.tsx","Components/Estimates/CompactCustomerData.tsx","Components/Estimates/TwoColumnTotalsTable.tsx","store/EstimateItem.ts","store/Material.ts","store/Design.ts","Components/ProductSummary/MaterialComponent.tsx","Components/ProductSummary/DesignComponent.tsx","Components/Estimates/Main.tsx","Pages/Home.tsx","Components/Estimates/img/logo.png","Components/Estimates/PrintHeader.tsx","Pages/EstimateView.tsx","store/ImpactProduct.ts","store/mock/products-mock.ts","store/productsSlice.ts","Components/ModalOptions/AddHardwareConfirmation.tsx","Components/ModalOptions/ProductSearch.tsx","store/store.ts","Components/ProductDetails/ImpactProduct.tsx","Pages/ImpactProduct.tsx","Components/ModalOptions/MaterialSearch.tsx","Components/ProductDetails/Material.tsx","Pages/Material.tsx","Components/ModalOptions/DesignSearch.tsx","Components/ProductDetails/Design.tsx","Pages/Design.tsx","store/Hardware.ts","Components/ProductDetails/Hardware.tsx","Pages/Hardware.tsx","Pages/NoPrint.tsx","Components/Estimates/InvoiceTotals.tsx","Components/Estimates/Invoice.tsx","Pages/InvoiceView.tsx","Components/Estimates/Signature.tsx","Components/Estimates/Contract.tsx","Pages/ContractView.tsx","routes.tsx","index.tsx"],"names":["LoadingState","ModifiedState","Content","Layout","AppLayout","children","useAppDispatch","useDispatch","useAppSelector","useSelector","EstimateStatus","isNew","s","new","isModified","none","isDeleted","deleted","CustomerNames","c1","id","GetCustomerDetails","name","c","customername","RelationshipType","MarkupByRelationshipType","reltype2Markup","t","initialState","customerNames","customerNamesStatus","unavailable","customerDetails","customerDetailsStatus","customerDetailsRequested","error","fetchCustomerNames","createAsyncThunk","a","console","log","fetch","window","location","hostname","response","json","mock","fetchCustomerDetailsById","results","length","cn","find","cm","value","toString","label","customersSlice","createSlice","reducers","extraReducers","builder","addCase","pending","state","action","loading","fulfilled","succeeded","payload","rejected","failed","message","selectCustomerNames","customers","selectCustomerNamesStatus","selectCustomerDetails","selectCustomerDetailsStatus","ModuleType","colors","InProgress","Delivered","Approved","Rejected","isNotInProgress","isReadOnly","e","status","isRejected","string2status","toLowerCase","ItemType","createDefaultEstimate","vendor","vendor_phone","customerid","_modified","add_inst_discount","add_sales_discount","approved_date","undefined","defcolor","defglasscolor","delivered_date","deposit_percent_with_install","deposit_percent","estimatenum","folio","is_alteration","is_installation_included","new_construction_owner_responsability","notes","public_notes","pay_upon_completion","percent_final_inspection","permitId","permits","quotedate","formatDate","Date","rejected_date","salestax","status_reason","totalprice","warranty_years","qualifiername","items","d","twoDigits","n","getFullYear","getMonth","getDate","getHours","getMinutes","getSeconds","isDirty","dirty","i","item","WinType","ItemTypes","Object","keys","filter","key","isNaN","Number","id2ItemType","itemType2Id","indexOf","WinTypes","values","ip1","eid","ino","Window","ImpactProduct","SingleHungSeries","ip_base1","hw1","Hardware","None","hw_base1","e_base","ip_missingtype","ip_missingroomnum","ip_withescape","ip_withnoescape","ip_withclearbath","e_allwarnings","itemid","itemno","GetEstimate","e_nowarnings","estimate","estimateStatus","nextItemId","cleanNotes","replace","fetchEstimate","_fetchEstimate","msg","push","obj2URL","o","url","reduce","k","encodeURIComponent","startsWith","substr","saveItem","newItem","updateFileName","modtype","Material","Design","modified","method","headers","body","estimateitemid","saveEstimate","newEstimate","newItems","promises","forEach","estimateid","Promise","all","map","estimatesSlice","newID","createEstimate","customer","duplicateEstimate","updateEstimate","updateItem","updatedItem","deleteItem","copyItem","m","v","addItem","err","saving","actions","selectEstimate","estimates","selectEstimateStatus","selectEstimateError","Defaults","phone","fax","defaults","user","admin","company","address","town","zip","providers","roomtypes","defaultsStatus","fetchDefaults","arg","thunkAPI","defaultsSlice","selectDefaults","selectDefaultsStatus","selectId2RoomTypeConvertor","rt","selectRoomType2IdConvertor","type","ProductOptions","p","okButtonProps","style","display","title","visible","onCancel","handleCancel","className","onClick","handleImpactProduct","handleHardware","handleMaterial","handleDesign","currency","Intl","NumberFormat","minimumFractionDigits","maximumFractionDigits","round2Decimals","Math","round","percentTimes100","asMoney","format","moneyParser","asPercentage","percentageParser","phoneRegEx","formatPhone","txt","digits","replaceAll","substring","cs1","xs","sm","md","lg","xl","cs2","cs3","cs23","LeftIndent","props","TotalText","level","TotalAmount","textAlign","TotalsTable","totals","onChangeAdditionalDiscountProductsPercentage","onChangeAdditionalDiscountInstallPercentage","onChangePermits","onChangeSalesTax","includeInstallation","readOnly","additionalDiscountProductsPercentageStr","additionalDiscountProductsPercentage","additionalDiscountInstallPercentageStr","additionalDiscountInstallPercentage","permitsStr","totalPermits","salesTaxStr","salesTax","discountClass","gutter","countImpactProducts","totalImpactProducts","countStormPanels","totalStormPanels","countHardware","totalHardware","countMaterial","totalMaterial","countDesign","totalDesign","totalInstallation","totalOtherFees","discountAllProducts","discountInstallation","additionalDiscountProducts","editable","onChange","val","valF","additionalDiscountInstall","margin","totalBeforeTax","salesTaxDollars","finalPrice","ProductButtons","onEdit","itemIndex","onAdd","onDelete","onCopy","disabled","shape","icon","CopyFilled","marginRight","DeleteFilled","EditFilled","ProductComponent","description","onUpdateItemNo","onUpdateQuantity","qtyWidth","wrap","num","src","image","fallback","quantity","sales_price","colonial_fee","includes","inst_price","sales_discount","finalprice","ImpactProductComponent","rest","ds","roomtype","id2RoomType","is_screen","widthtxt","heighttxt","lengthtxt","glass_type","glass_color","interlayer","coating","roomnum","HardwareComponent","provider","product_ref","hardwaretype","configuration","total","getVal","pt","createEstimateTotals","ii","getItems","cp","ip","is_colonial","colonialPrice","instImpactProducts","discountImpactProducts","discountInstImpactProducts","inst_discount","StormPanel","discountStormPanels","instStormPanels","discountInstStormPanels","discountHardware","instHardware","discountInstHardware","discountMaterial","discountDesign","totalAllProducts","otherfees","totalDiscount","openingLimits","CasementWindowSeries","minWidth","minHeight","FixedGlass","FrenchDoor","HorizontalRollingSeries","SlidingDoor","PendingProblems","link","validateEstimate","h","problems","bedroomTypeId","roomType2Id","roomNumbersMissingTypes","accum","current","allBedroomItems","countRoomsMissingNumber","allBedroomItemsWithRoomnum","allBedroomNumbers","bedroomNumbersWithEscape","wintype","ol","width","height","bedroomNumbersMissingEscape","checkEmergencyExits","bathroomTypeId","allBathroomItems","allBathroomItemsWithClearOpening","roomNumbersWithClearOpening","checkBathroomOpenings","checkRequiredHardware","useModifiedAlert","RoomType","useEffect","alertUser","preventDefault","returnValue","addEventListener","removeEventListener","EstimateOptions","dispatch","es","useState","warrantyYearsDropdown","setWarrantyYearsDropdown","noPrintIfZero","noPrintIfFalsy","updateWarrantyYears","hasConditions","marginTop","Separator","UpCircleTwoTone","twoToneColor","size","direction","align","whiteSpace","marginBottom","checked","target","Option","cursor","years","toggleWarrantyYears","COLORS","hex","Initial","onChangeCustomer","onUpdateEstimate","isLoading","isFailed","id2LabeledData","selectedDefaultFrameColor","toUpperCase","selectedDefaultFrameColorHex","selectedDefaultGlassColor","selectedDefaultGlassColorHex","defaultFrameColorSelector","showSearch","optionFilterProp","filterOption","input","option","options","defaultGlassColorSelector","Ribbon","text","color","WarningOutlined","marginLeft","alignSelf","placeholder","reltype","customeraddress","customerphone","customermobile","contactname","contactaddress","contactphone","contactmobile","customeremail","folionumber","xxl","columns","dataIndex","render","verticalAlign","onCell","_","index","colSpan","CompactCustomerData","cols1","cols2","createDataRow1","label1","value1","createDataRow2","label2","value2","addDataRow1","always","addDataRow2","addDataRowShortest","lines","line","trim","endsWith","join","address2String","customercity","customerstate","customerzip","split","cdrows","row","hide_is_installation_included","hide_is_alteration","hide_both","dataSource","showHeader","pagination","rowClassName","record","TwoColumnTotalsTable","rightData","addDataRow","addDataRowAlways","leftData","splice","DefaultEstimateItem","cost_price","itemtype","DefaultMaterial","createItemTotals","DefaultDesign","MaterialComponent","DesignComponent","Title","Typography","Text","statuses","handleResult","res","history","notification","duration","success","showingError","Main","viewMenu","cs","customerDetailsMap","params","useParams","showProductOptions","setShowProductOptions","useHistory","setWarnings","expandedItems","setExpandedItems","status_customer","status_customerDetail","status_estimate","status_estimateError","status_default","useMemo","customerDetail","estimateError","default","customerId","setCustomerId","handleAddProduct","event","stopPropagation","handlers","handleEdit","RenderProduct","useCallback","updateItemNo","updateQuantity","createMaterialItemTotals","createDesignItemTotals","getHeaderFromItem","statusReadOnly","remainingItems","itemsList","isLoaded","Empty","PRESENTED_IMAGE_SIMPLE","activeKey","sort","b","Panel","header","extra","rejection_reason_tip","estimateStatusDate","statusMenu","updatedEstimate","date","updateEstimateStatus","setTimeout","appRoutes","useAppRoutes","customerData","canPrint","customeridStr","cid","totalsTable","float","overlay","DownOutlined","triggerType","newReason","PlusOutlined","SyncOutlined","spin","SaveOutlined","then","onSave","some","CopyOutlined","onDuplicate","AuditOutlined","open","w","showIcon","autoSize","maxLength","backgroundColor","border","Home","Paragraph","PrintHeader","phone1","phone2","span","logo","fontSize","strong","EstimateView","RoomOptions","isModalVisible","handleTypeOptions","Bedroom","Bathroom","Other","Unknown","DefaultImpactProduct","colonial_across","colonial_down","is_def_color","is_def_glass_color","is_standard","room_description","floornum","ProductSummaries","GetProductDetails","ps","wf","Fraction","hf","lf","valueOf","l","frame_color","productSummaries","productSummariesById","productSummariesByRef","productSummariesStatus","productDetails","productDetailsStatus","fetchProductSummaries","fetchProductDetailsById","productsState","getState","products","Array","isArray","Boolean","productsSlice","ref","selectProductSummaries","selectProductSummariesById","selectProductSummariesByRef","selectProductSummariesStatus","AddHardwareConfirmation","onYes","onNo","Select","ProductSearch","currentID","setID","setColor","setProvider","setItemType","setInterlayer","setWintype","setModtype","glasscolor","glassColor","setGlassColor","setRef","defaultStatus","productsById","productsStatus","unspecified","ifUnspecified","alt","id2ProductSummary","prodSummary","resetSearch","clearSearch","product2Label","isVisibleProductSummary","selectProduct","id2Ref","interlayers","ilmap","il","refs","onOk","handleProduct","footer","labelCol","wrapperCol","autoComplete","Item","cd","match","store","configureStore","reducer","customersReducer","estimatesReducer","defaultsReducer","productsReducer","ImpactProductDetail","onClose","showRoomOptions","setShowRoomOptions","showAddHardwareConfirmation","setShowAddHardwareConfirmation","productsByRef","createInitialProductCopy","impactProduct","setImpactProduct","editRoomDescription","setEditRoomDescription","showProductSearch","setShowProductSearch","saveAndClose","addHardware","updateOrSave","updateImpactProduct","newIP","existingRoomDescriptions","localeCompare","roomDescriptionEditor","flexGrow","min","autoFocus","onFocus","select","defaultValue","onBlur","PreviewGroup","hidden","onStep","formatter","max","step","parser","InfoCircleOutlined","CloseOutlined","details","ImpactProductPage","setItem","iid","goBack","MaterialSearch","setWidth","setHeight","setLength","materialProducts","isCandidateProduct","candidateProducts","widthValues","wMap","heightValues","hMap","lengthValues","MaterialDetail","material","setMaterial","updateMaterial","newM","MaterialPage","DesignSearch","designColors","designProducts","DesignDetail","design","setDesign","updateDesign","DesignPage","DefaultHardware","HardwareDetail","hardware","setHardware","undefinedOrNone","updateHardware","newHW","placement","onConfirm","okText","cancelText","HardwarePage","NoPrint","getMenuItems","mi","onclick","InvoiceTotals","Invoice","italic","showCount","InvoiceView","TitleCol","NameCol","Signature","Contract","ContractView","useLocation","pathname","showEstimate","showPrintableEstimate","showInvoice","showContract","showNoPrint","closeEstimate","href","getMenuKey","EditOutlined","AppstoreOutlined","DollarCircleOutlined","SolutionOutlined","Routes","menuKey","beforePrint","selectedKeys","Divider","menu","Button","MenuFoldOutlined","exact","path","component","ModuleHardware","ModuleImpactProducts","ModuleMaterials","ModuleDesign","appElement","document","getElementById","ReactDOM","StrictMode","basename","process"],"mappings":"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","file":"static/js/main.c15f2b2e.chunk.js","sourcesContent":["export enum LoadingState {\r\n    unavailable = \"unavailable\",\r\n    loading = \"loading\",\r\n    saving = \"saving\",\r\n    succeeded = \"succeeded\",\r\n    failed = \"failed\"\r\n}\r\n\r\nexport enum ModifiedState {\r\n    none = \"none\",\r\n    new = \"new\",\r\n    modified = \"modified\",\r\n    deleted = \"deleted\"\r\n}\r\n\r\nexport const isNew = (s:ModifiedState) => s === ModifiedState.new\r\nexport const isModified = (s:ModifiedState) => s !== ModifiedState.none\r\nexport const isDeleted = (s:ModifiedState) => s === ModifiedState.deleted\r\n\r\n","import React from 'react';\r\nimport './Layout.css';\r\nimport { Layout } from 'antd';\r\n\r\nconst { Content } = Layout;\r\n\r\ntype AppLayoutProps = {\r\n    children: React.ReactNode;\r\n}\r\n\r\nconst AppLayout = ({ children }: AppLayoutProps) => {\r\n    return (\r\n        <Layout>\r\n            <Content>\r\n                {children}\r\n            </Content>\r\n        </Layout>\r\n\r\n    );\r\n};\r\n\r\nexport default AppLayout;","import { TypedUseSelectorHook, useDispatch, useSelector } from 'react-redux'\r\nimport type { RootState, AppDispatch } from './store'\r\n\r\nexport const useAppDispatch = () => useDispatch<AppDispatch>()\r\nexport const useAppSelector: TypedUseSelectorHook<RootState> = useSelector\r\n","import { Estimate } from \"../store/Estimate\"\r\n\r\nexport enum EstimateStatus {\r\n    InProgress = \"In Progress\",\r\n    Delivered = \"Delivered\",\r\n    Approved = \"Approved\",\r\n    Rejected = \"Rejected\"\r\n}\r\n\r\nconst colors = {\r\n    [EstimateStatus.InProgress]: \"green\",\r\n    [EstimateStatus.Delivered]: \"#108ee9\",\r\n    [EstimateStatus.Approved]: \"#87d068\",\r\n    [EstimateStatus.Rejected]: \"#f50\",\r\n}\r\n\r\nexport const isNotInProgress = (s:EstimateStatus|undefined) => s !== EstimateStatus.InProgress\r\nexport const isReadOnly = (e:Estimate|undefined) => !e || isNotInProgress(e?.status)\r\nexport const isRejected = (s:EstimateStatus|undefined) => s === EstimateStatus.Rejected\r\nexport const status2color = (s:EstimateStatus|undefined) => {\r\n    if (s && colors[s])\r\n        return colors[s]\r\n    return \"#f50\"\r\n}\r\nexport const string2status = (s:string|undefined):EstimateStatus => {\r\n    switch(s?.toLowerCase()) {\r\n        case \"delivered\": return EstimateStatus.Delivered\r\n        case \"approved\": return EstimateStatus.Approved\r\n        case \"rejected\": return EstimateStatus.Rejected\r\n        default: return EstimateStatus.InProgress\r\n    }\r\n}\r\n","import { CustomerDetails } from \"../customersSlice\"\r\n\r\nexport const CustomerNames = [\r\n    { \"value\": \"4504\", \"label\": \"10300 CORAL WAY LLC\" }, \r\n    { \"value\": \"4646\", \"label\": \"10300 INVESTMENT LLC\" }, \r\n    { \"value\": \"5744\", \"label\": \"11020 PEACHTREE DRIVE LLC\" }, \r\n    { \"value\": \"7825\", \"label\": \"1125 ALHAMBRA LLC\" }, \r\n    { \"value\": \"6859\", \"label\": \"114 MENORES LLC\" }, \r\n    { \"value\": \"5733\", \"label\": \"1171 MANAGEMENT LLC\" }, \r\n    { \"value\": \"2826\", \"label\": \"12687 INVESTMENT CORP\" }, \r\n    { \"value\": \"3923\", \"label\": \"13260658 LLC TRS\" }, \r\n    { \"value\": \"4448\", \"label\": \"13306 BY THE SEA CORP\" }, \r\n    { \"value\": \"8882\", \"label\": \"1361 SW 124 CT'\" }, \r\n    { \"value\": \"7168\", \"label\": \"14170 SW 260 ST 102 MIAMI FLORIDA 33032 LLC\" }, \r\n    { \"value\": \"2020\", \"label\": \"14170 SW 260 ST 102 MIAMI FLORIDA 33032 LLC\" }, \r\n    { \"value\": \"839\", \"label\": \"147 BIRD ROAD DEVELOPMENT INC\" }]\r\n\r\nexport const c1 = (id:number):CustomerDetails => ({\r\n    \"contactaddress\":`contactaddress_${id}`,\r\n    \"contactmobile\":`contactmobile_${id}`,\r\n    \"contactname\":`contactname_${id}`,\r\n    \"contactphone\":`contactphone_${id}`,\r\n    \"customeraddress\":`${id} NE 158 ST`,\r\n    \"customercity\":`North Miami Beach`,\r\n    \"customeremail\":`email${id}@hotmail.com`,\r\n    \"customermobile\":`customermobile_${id}`,\r\n    \"customername\":`Name_${id}`,\r\n    \"customerphone\":`(305)968-780${id}`,\r\n    \"customerstate\":\"Florida\",\r\n    \"customerzip\":`33161`,\r\n    \"folionumber\":`123456789${id}`,\r\n    \"id\":id,\r\n    \"reltype\":2,\r\n})\r\n    \r\nexport const GetCustomerDetails = (id:number, name: string):CustomerDetails => {\r\n    let c = c1(id)\r\n    return {\r\n        ...c,\r\n        \"customername\":name??c.customername,\r\n    }\r\n}","import { createSlice, createAsyncThunk } from '@reduxjs/toolkit'\r\nimport { LoadingState } from '../types/Status'\r\nimport * as mock from './mock/customers-mock'\r\nimport { RootState } from './store'\r\n\r\nexport const RelationshipType = [\"None\", \"Home Owner\", \"Dealer\", \"Contractor\", \"Walk in\"]\r\nexport const MarkupByRelationshipType = [0, .45, .17, .35, .45]\r\nexport const reltype2Markup = (t:number|undefined) => t ? MarkupByRelationshipType[t] : 0 \r\n\r\nexport type CustomerName = {\r\n  value: string\r\n  label: string\r\n}\r\n\r\nexport type CustomerDetails = {\r\n  contactaddress: string\r\n  contactmobile: string\r\n  contactname: string\r\n  contactphone: string\r\n  customeraddress: string\r\n  customercity: string\r\n  customeremail: string\r\n  customermobile: string\r\n  customername: string\r\n  customerphone: string\r\n  customerstate: string\r\n  customerzip: string\r\n  folionumber: string\r\n  id: number\r\n  reltype: number\r\n}\r\n\r\nexport type CustomerDetailsMap = { \r\n  [key: string]: CustomerDetails \r\n}\r\n\r\nexport type CustomerDetailsRequests = { \r\n  [id: string]: boolean \r\n}\r\n\r\nexport type CustomersState = {\r\n    customerNames: CustomerName[]\r\n    customerNamesStatus: LoadingState,\r\n\r\n    customerDetails: CustomerDetailsMap\r\n    customerDetailsStatus: LoadingState,\r\n    customerDetailsRequested: CustomerDetailsRequests\r\n\r\n    error: string | null | undefined\r\n}\r\n\r\nconst initialState : CustomersState = {\r\n  customerNames: [],\r\n  customerNamesStatus: LoadingState.unavailable,\r\n  customerDetails: {},\r\n  customerDetailsStatus: LoadingState.unavailable,\r\n  customerDetailsRequested: {},\r\n  error: null,\r\n}\r\n\r\nexport const fetchCustomerNames = createAsyncThunk<CustomerName[]>('getCustomerNames', async () => {\r\n  console.log(\"Fetching customer names \")\r\n  if (process.env.NODE_ENV === \"production\") {\r\n    const response = await fetch(`http://${window.location.hostname}/AMCRMERP/htdocs/custom/amhpestimatesv2/db/getcustomernames.php`)\r\n    const json:CustomerName[] = await response.json();\r\n    return json;\r\n  }\r\n  \r\n  // For testing in dev\r\n  return mock.CustomerNames \r\n})\r\n\r\nexport const fetchCustomerDetailsById = createAsyncThunk<CustomerDetails, number>('getCustomerDetails', async (id:number) => {\r\n  console.log(\"Fetching customer \", id)\r\n  if (process.env.NODE_ENV === \"production\") {\r\n    const response = await fetch(`http://${window.location.hostname}/AMCRMERP/htdocs/custom/amhpestimatesv2/db/getcustomerdetails.php?id=${id}`)\r\n    const json:any = await response.json();\r\n    let results = null;\r\n    if (json.length && json.length>0)\r\n      results = json[0];\r\n    else\r\n      results = json;\r\n    return results as CustomerDetails;\r\n  }\r\n  \r\n  // For testing in dev\r\n  let cn = mock.CustomerNames.find(cm => cm.value === id.toString())?.label\r\n  return mock.GetCustomerDetails(id, cn??id.toString())\r\n})\r\n\r\nexport const customersSlice = createSlice({\r\n  name: 'customers',\r\n  initialState,\r\n  reducers: {\r\n  },\r\n  extraReducers: (builder) => {\r\n\r\n    builder.addCase(fetchCustomerNames.pending, (state, action) => {\r\n      state.customerNamesStatus = LoadingState.loading\r\n    })\r\n    builder.addCase(fetchCustomerNames.fulfilled, (state, action) => {\r\n      state.customerNamesStatus = LoadingState.succeeded\r\n      state.customerNames = action.payload\r\n    })\r\n    builder.addCase(fetchCustomerNames.rejected, (state, action) => {\r\n      state.customerNamesStatus = LoadingState.failed\r\n      state.error = action.error.message\r\n    })\r\n\r\n    builder.addCase(fetchCustomerDetailsById.pending, (state, action) => {\r\n      state.customerDetailsStatus = LoadingState.loading\r\n    })\r\n    builder.addCase(fetchCustomerDetailsById.fulfilled, (state, action) => {\r\n      state.customerDetailsStatus = LoadingState.succeeded\r\n      if (state.customerDetails && action.payload?.id) {\r\n        state.customerDetails[action.payload.id] = action.payload \r\n      }\r\n    })\r\n    builder.addCase(fetchCustomerDetailsById.rejected, (state, action) => {\r\n      state.customerDetailsStatus = LoadingState.failed\r\n      state.error = action.error.message\r\n    })\r\n\r\n  }\r\n})\r\n\r\nexport const selectCustomerNames = (state:RootState) : CustomerName[]|undefined => state.customers.customerNames\r\nexport const selectCustomerNamesStatus = (state:RootState) : LoadingState => state.customers.customerNamesStatus\r\n\r\nexport const selectCustomerDetails = (state:RootState) : CustomerDetailsMap|undefined => state.customers.customerDetails\r\nexport const selectCustomerDetailsStatus = (state:RootState) : LoadingState => state.customers.customerDetailsStatus\r\n\r\nexport default customersSlice.reducer","enum ModuleType {\r\n    ImpactProduct = \"Impact Product\",\r\n    Hardware = \"Hardware\",\r\n    StormPanel = \"StormPanel\",\r\n    Accordion = \"Accordion\",\r\n    Design = \"Design\",\r\n    Material = \"Material\",\r\n}\r\nexport default ModuleType ","enum ItemType {\r\n    None = \"\",\r\n    Window = \"Window\",\r\n    Door = \"Door\",\r\n    Hardware = \"Hardware\",\r\n}\r\n\r\nexport const ItemTypes:string[] = Object.keys(ItemType).filter(key => isNaN(Number(key)))\r\n\r\nexport const id2ItemType = (n:number):ItemType =>\r\n{\r\n    return ItemTypes[n] as ItemType\r\n}\r\n\r\nexport const itemType2Id = (i:string):number =>\r\n{\r\n    return ItemTypes.indexOf(i)\r\n}\r\n\r\nexport default ItemType ","import { EstimateStatus } from \"../types/EstimateStatus\";\r\nimport { isDeleted, isModified, ModifiedState } from \"../types/Status\";\r\nimport { CustomerDetails } from \"./customersSlice\";\r\nimport { EstimateItem } from \"./EstimateItem\";\r\n\r\nexport type Estimate = {\r\n  _modified:ModifiedState\r\n  add_inst_discount?: number\r\n  add_sales_discount?: number\r\n  customerid?: number\r\n  defcolor?: string\r\n  defglasscolor?: string\r\n  estimatenum?: string\r\n  folio?: string\r\n  deposit_percent?: number\r\n  deposit_percent_with_install?: number\r\n  percent_final_inspection?: number\r\n  warranty_years?: number\r\n  pay_upon_completion?: boolean\r\n  new_construction_owner_responsability?: boolean\r\n  status?: EstimateStatus\r\n  status_reason?: string\r\n  approved_date?: string\r\n  rejected_date?: string\r\n  delivered_date?: string\r\n  permitId?: number\r\n  id?: number\r\n  is_alteration?: boolean\r\n  is_installation_included?: boolean\r\n  notes?: string\r\n  public_notes?: string\r\n  permits?: number\r\n  quotedate?: string\r\n  salestax?: number\r\n  totalprice?: number\r\n  vendor?: string\r\n  vendor_phone?: string\r\n  qualifiername?: string\r\n\r\n  customer?: CustomerDetails\r\n  items: EstimateItem[]\r\n}\r\n\r\nexport const createDefaultEstimate = (vendor:string, vendor_phone:string, customerid?:number):Estimate => ({\r\n  _modified: ModifiedState.new,\r\n  add_inst_discount: 0,\r\n  add_sales_discount: 0,\r\n  approved_date: undefined,\r\n  customerid: customerid,\r\n  defcolor: \"WHITE\",\r\n  defglasscolor: \"WHITE\",\r\n  delivered_date: undefined,\r\n  deposit_percent_with_install: 0,\r\n  deposit_percent: 0,\r\n  estimatenum: undefined,\r\n  folio: undefined,\r\n  id: undefined,\r\n  is_alteration: false,\r\n  is_installation_included: true,\r\n  new_construction_owner_responsability: false,\r\n  notes: \"\",\r\n  public_notes: \"\",\r\n  pay_upon_completion: true,\r\n  percent_final_inspection: 0,\r\n  permitId: 0,\r\n  permits: 700,\r\n  quotedate: formatDate(new Date()),\r\n  rejected_date: undefined,\r\n  salestax: 0,\r\n  status: EstimateStatus.InProgress,\r\n  status_reason: \"\",\r\n  totalprice: 0,\r\n  vendor,\r\n  vendor_phone,\r\n  warranty_years: 5,\r\n  qualifiername: undefined,\r\n\r\n  items: []\r\n})\r\n\r\nexport const formatDate  = (d:Date|undefined) => {\r\n  const twoDigits = (n:number) => n>9 ? n.toString() : \"0\"+n\r\n  return d ? d.getFullYear() + \"-\" + twoDigits(d.getMonth()+1) + \"-\" + twoDigits(d.getDate())  + \" \" + twoDigits(d.getHours()) + \":\" + twoDigits(d.getMinutes()) + \":\" + twoDigits(d.getSeconds()) : \"\"\r\n}\r\n\r\nexport const isDirty = (e:Estimate):boolean => {\r\n  let dirty = isModified(e._modified);\r\n  if (!dirty && e.items) {\r\n    for (let i = 0; !dirty && i < e.items.length; i++) {\r\n      const item = e.items[i];\r\n      dirty = isModified(item._modified)\r\n    }\r\n  }\r\n  return dirty;\r\n}\r\nexport const getItems = (e:Estimate) => e.items ? e.items.filter(i => !isDeleted(i._modified)) : []\r\n","enum WinType {\r\n    CasementWindowSeries = \"Casement Window Series\",\r\n    FrenchDoor = \"French Door\",\r\n    FixedGlass = \"Fixed Glass\",\r\n    HorizontalRollingSeries = \"Horizontal Rolling Series\",\r\n    SingleHungSeries = \"Single Hung Series\",\r\n    SlidingDoor = \"Sliding Door\",\r\n    None = \"\"\r\n}\r\n\r\nexport const WinTypes:string[] = Object.values(WinType).filter(value => isNaN(Number(value)))\r\n\r\n\r\nexport default WinType ","import { EstimateStatus } from \"../../types/EstimateStatus\"\r\nimport ItemType from \"../../types/ItemType\"\r\nimport ModuleType from \"../../types/ModuleType\"\r\nimport { ModifiedState } from \"../../types/Status\"\r\nimport WinType from \"../../types/WinType\"\r\nimport { Estimate } from \"../Estimate\"\r\nimport { EstimateItem } from \"../EstimateItem\"\r\nimport { Hardware } from \"../Hardware\"\r\nimport { ImpactProduct } from '../ImpactProduct'\r\nimport { c1 } from \"./customers-mock\"\r\n\r\nconst ip_base1 = (id:number, eid:number, ino:number):EstimateItem => ({\r\n  \"_modified\":ModifiedState.none,\r\n  \"color\": \"BRONZE\",\r\n  \"cost_price\": 200+id,\r\n  \"estimateid\": eid,\r\n  \"finalprice\": 500+id,\r\n  \"id\": id,\r\n  \"image\": \"/AMCRMERP/htdocs/document.php?modulepart=product&attachment=0&file=36.75X50.375HRXOECOBB5.16C/36.75X50.375.png\",\r\n  \"inst_discount\": 0.1,\r\n  \"inst_price\": 300+id,\r\n  \"itemno\": ino,\r\n  \"itemtype\": ItemType.Window,\r\n  \"modtype\": ModuleType.ImpactProduct,\r\n  \"name\": `Eco window 36.75x25.75HRXOECOBB5.16C ${id}`,\r\n  \"otherfees\": 40 + id,\r\n  \"sales_discount\": 0.1,\r\n  \"sales_price\": 300 + id,\r\n  \"wintype\": WinType.SingleHungSeries,\r\n})\r\n\r\nconst hw_base1 = (id:number, eid:number, ino:number):EstimateItem => ({\r\n  \"_modified\":ModifiedState.none,\r\n  \"color\": \"BRONZE\",\r\n  \"cost_price\": 200+id,\r\n  \"estimateid\": eid,\r\n  \"finalprice\": 300+id,\r\n  \"id\": id,\r\n  \"image\": \"/AMCRMERP/htdocs/document.php?modulepart=product&entity=1&file=%2F619CENF58%26LATF59X%2F619CENF58%26LATF59.png\",\r\n  \"inst_discount\": 0.1,\r\n  \"inst_price\": 100+id,\r\n  \"itemno\": ino,\r\n  \"itemtype\": ItemType.Hardware,\r\n  \"modtype\": ModuleType.Hardware,\r\n  \"name\": `SATIN NICKEL CENTURY F58 & LAT F59 ACTIVE ${id}`,\r\n  \"otherfees\": 30 + id,\r\n  \"sales_discount\": 0.1,\r\n  \"sales_price\": 200 + id,\r\n  \"wintype\": WinType.None,\r\n})\r\n\r\nconst ip1 = (id:number, eid:number, ino:number):ImpactProduct => ({\r\n  ...ip_base1(id, eid, ino),\r\n  \"coating\": \"NONE\",\r\n  \"colonial_across\": 10+id,\r\n  \"colonial_down\": 20+id,\r\n  \"colonial_fee\": 0+id,\r\n  \"configuration\": \"XOX\",\r\n  \"frame_color\": \"BRONZE\",\r\n  \"glass_color\": \"BRONZE\",\r\n  \"glass_type\": \"Laminated\",\r\n  \"height\": 50.375,\r\n  \"heighttxt\": \"50 3/8\",\r\n  \"interlayer\": \"WHITE\",\r\n  \"is_colonial\": true,\r\n  \"is_def_color\": true,\r\n  \"is_def_glass_color\": true,\r\n  \"is_screen\": false,\r\n  \"is_standard\": true,\r\n  \"length\": 5,\r\n  \"lengthtxt\": \"5\",\r\n  \"product_ref\": `26.25X50.375SHELECOWG5.16C`,\r\n  \"provider\": \"ECO WINDOWS\",\r\n  \"room_description\":\"Main Bedroom\",\r\n  \"roomnum\": 1,\r\n  \"roomtype\": 1,\r\n  \"floornum\": 1,\r\n  \"width\": 26.25,\r\n  \"widthtxt\": \"26 1/4\",\r\n})\r\n\r\nconst hw1 = (id:number, eid:number, ino:number):Hardware => ({\r\n  ...hw_base1(id, eid, ino),\r\n  \"configuration\": \"X\",\r\n  \"hardwaretype\": \"French Door\",\r\n  \"provider\": \"MILLWORK\",\r\n  \"product_ref\": `619CENF58&LATF59X`,\r\n})\r\n\r\nconst e_base = (id:number):Estimate => {\r\n  const c = c1(id+1000)\r\n  return {\r\n    \"_modified\":ModifiedState.none,\r\n    \"add_inst_discount\":0.3,\r\n    \"add_sales_discount\":0.16,\r\n    \"approved_date\":\"2021-05-07 02:50:02\",\r\n    \"customerid\":c.id,\r\n    \"defcolor\":\"BRONZE\",\r\n    \"defglasscolor\":\"BRONZE\",\r\n    \"delivered_date\":undefined,\r\n    \"deposit_percent_with_install\":40,\r\n    \"deposit_percent\":50,\r\n    \"estimatenum\":\"E00002\",\r\n    \"folio\":\"04-3117-016-0342\",\r\n    \"id\":id,\r\n    \"is_alteration\":true,\r\n    \"is_installation_included\":true,\r\n    \"new_construction_owner_responsability\":false,\r\n    \"pay_upon_completion\":false,\r\n    \"percent_final_inspection\":10,\r\n    \"permitId\":0,\r\n    \"permits\":500,\r\n    \"quotedate\": \"2021-05-06 02:50:02\",\r\n    \"rejected_date\":undefined,\r\n    \"salestax\":.26,\r\n    \"status\":EstimateStatus.InProgress,\r\n    \"status_reason\":\"\",\r\n    \"totalprice\":1001.0000,\r\n    \"vendor\":\"Paul Dermody\",\r\n    \"vendor_phone\":\"123 456 7890\",\r\n    \"warranty_years\":10,\r\n    \"qualifiername\": \"Jose G Perez\",\r\n    \"customer\": c,\r\n    \"items\": []\r\n  }\r\n}\r\n\r\nconst ip_missingtype = (id:number, eid:number, ino:number):ImpactProduct => ({\r\n  ...ip1(id, eid, ino),\r\n  \"roomtype\": undefined,\r\n})\r\n\r\nconst ip_missingroomnum = (id:number, eid:number, ino:number):ImpactProduct => ({\r\n  ...ip1(id, eid, ino),\r\n  \"roomnum\": undefined,\r\n})\r\n\r\nconst ip_withescape = (id:number, eid:number, ino:number):ImpactProduct => ({\r\n  ...ip1(id, eid, ino),\r\n  \"wintype\": WinType.SingleHungSeries,\r\n  \"width\": 100,\r\n  \"height\": 56.75,\r\n  \"length\": 5,\r\n})\r\n\r\nconst ip_withnoescape = (id:number, eid:number, ino:number):ImpactProduct => ({\r\n  ...ip1(id, eid, ino),\r\n  \"wintype\": WinType.SingleHungSeries,\r\n  \"width\": 100,\r\n  \"height\": 56.749,\r\n  \"length\": 5,\r\n})\r\n\r\nconst ip_withclearbath = (id:number, eid:number, ino:number):ImpactProduct => ({\r\n  ...ip1(id, eid, ino),\r\n  \"roomtype\": 2,\r\n  \"interlayer\": \"CLEAR\"\r\n})\r\n\r\n\r\n// An estimate that generates no warnings or errors \r\nconst e_nowarnings = (id:number):Estimate => {\r\n  let itemid=100+id;\r\n  let itemno=1\r\n  return {\r\n    ...e_base(id),\r\n    \"items\": [\r\n      {\r\n        ...ip_withescape(itemid++, id, itemno++),\r\n        \"roomnum\": 1\r\n      } as ImpactProduct,\r\n      {\r\n        ...ip_withnoescape(itemid++, id, itemno++),\r\n        \"roomnum\": 1\r\n      } as ImpactProduct,\r\n      {\r\n        ...hw1(itemid++, id, itemno++),\r\n      } as Hardware,\r\n    ]\r\n  }\r\n}\r\n\r\n// An estimate that generates all warnings and errors \r\nconst e_allwarnings = (id:number):Estimate => {\r\n  let itemid=100+id;\r\n  let itemno=1\r\n  return {\r\n    ...e_base(id),\r\n    \"items\": [\r\n      {\r\n        ...ip_missingtype(itemid++, id, itemno++),\r\n        \"roomnum\": 1\r\n      } as ImpactProduct,\r\n      {\r\n        ...hw1(itemid++, id, itemno++),\r\n      } as Hardware,\r\n      {\r\n        ...ip_missingroomnum(itemid++, id, itemno++),\r\n      } as ImpactProduct,\r\n      {\r\n        ...ip_withescape(itemid++, id, itemno++),\r\n        \"roomnum\": 3\r\n      } as ImpactProduct,\r\n      {\r\n        ...ip_withnoescape(itemid++, id, itemno++),\r\n        \"roomnum\": 3\r\n      } as ImpactProduct,\r\n      {\r\n        ...ip_withnoescape(itemid++, id, itemno++),\r\n        \"roomnum\": 4\r\n      } as ImpactProduct,\r\n      {\r\n        ...ip_withnoescape(itemid++, id, itemno++),\r\n        \"roomnum\": 4\r\n      } as ImpactProduct,\r\n      {\r\n        ...ip_withclearbath(itemid++, id, itemno++),\r\n        \"roomnum\": 5\r\n      } as ImpactProduct,\r\n      {\r\n        ...ip_withclearbath(itemid++, id, itemno++),\r\n        \"roomnum\": 6\r\n      } as ImpactProduct,\r\n    ]\r\n  }\r\n}\r\n\r\nexport const GetEstimate = (id:number):Estimate => {\r\n  let e:Estimate = e_allwarnings(id)\r\n  switch(id) {\r\n    case 1: e = e_allwarnings(id)\r\n      break;\r\n    case 2: e = e_nowarnings(id)\r\n      break;\r\n  }\r\n\r\n  return e;\r\n}\r\n","import { createSlice, createAsyncThunk, PayloadAction } from '@reduxjs/toolkit'\r\nimport { EstimateStatus } from '../types/EstimateStatus'\r\nimport ModuleType from '../types/ModuleType'\r\nimport { isModified, LoadingState, ModifiedState } from '../types/Status'\r\nimport { Estimate, formatDate } from './Estimate'\r\nimport { EstimateItem } from './EstimateItem'\r\nimport * as mock from './mock/estimates-mock'\r\nimport { RootState } from './store'\r\n\r\nexport type EstimatesState = {\r\n    estimate?: Estimate\r\n    estimateStatus: LoadingState\r\n    error?: string\r\n    nextItemId: number\r\n}\r\n\r\nconst initialState : EstimatesState = {\r\n  estimate: undefined,\r\n  estimateStatus: LoadingState.unavailable,\r\n  nextItemId: -1\r\n}\r\n\r\nconst cleanNotes = (s:string) => {\r\n  s = s.replace(\"\\\\n\", \"\\n\")\r\n  s = s.replace(\"&qt;\", \"\\\"\")\r\n  return s;\r\n}\r\n\r\nexport const fetchEstimate = createAsyncThunk<Estimate, number>('fetchEstimate', async (id:number) => {\r\n  return _fetchEstimate(id)\r\n})\r\n\r\nexport const _fetchEstimate = async (id:number) => {\r\n  console.log(\"Fetching estimate \", id)\r\n  if (process.env.NODE_ENV === \"production\") {\r\n    const response = await fetch(`http://${window.location.hostname}/AMCRMERP/htdocs/custom/amhpestimatesv2/db/getEstimate.php?id=${id}`)\r\n    const json:any = await response.json();\r\n    if (json.msg) \r\n      throw json.msg\r\n    json._modified = ModifiedState.none;\r\n    if (json.notes)\r\n      json.notes = cleanNotes(json.notes)\r\n    if (json.public_notes)\r\n      json.public_notes = cleanNotes(json.public_notes)\r\n    if (json.items)\r\n      for (const i in json.items)\r\n        json.items[i]._modified = ModifiedState.none;\r\n    return {\r\n      ...json,\r\n        new_construction_owner_responsability: !!json.new_construction_owner_responsability,\r\n        pay_upon_completion: !!json.pay_upon_completion,\r\n    }\r\n  }\r\n  \r\n  // For testing in dev\r\n  let e = mock.GetEstimate(id)\r\n  let items = []\r\n  for (const i in e.items)\r\n    items.push({\r\n      ...e.items[i],\r\n      _modified: ModifiedState.none\r\n    })\r\n  return {\r\n    ...e,\r\n    items,\r\n    _modified: ModifiedState.none\r\n  }\r\n}\r\n\r\n/** Creates a query string for a URL using the properties of the object */\r\nconst obj2URL = (o:any) => {\r\n  let url:string = Object.keys(o).reduce((s:string, k:string) =>\r\n    s + ((o[k] !== undefined && typeof(o[k]) !== \"object\") ? `&${k}=${encodeURIComponent(o[k])}` : \"\"), \"\")\r\n  return url.startsWith(\"&\")?url.substr(1,url.length-1):\"\"\r\n}\r\n\r\nconst saveItem = async (item:EstimateItem):Promise<EstimateItem> => {\r\n  let newItem:EstimateItem = {...item}\r\n  let updateFileName = \"\"\r\n  switch(item.modtype) {\r\n    case ModuleType.ImpactProduct:\r\n      updateFileName = \"EstimateImpactProduct\"\r\n      break;\r\n    case ModuleType.Hardware:\r\n      updateFileName = \"EstimateHardware\"\r\n      break;\r\n    case ModuleType.Material:\r\n      updateFileName = \"EstimateMaterial\"\r\n      break;\r\n    case ModuleType.Design:\r\n      updateFileName = \"EstimateDesign\"\r\n      break;\r\n  }\r\n  \r\n  if (process.env.NODE_ENV === \"production\" && updateFileName !== \"\") {\r\n\r\n    // UPDATE ITEM\r\n    if (item._modified === ModifiedState.modified) {\r\n      const response = await fetch(\r\n        `http://${window.location.hostname}/AMCRMERP/htdocs/custom/amhpestimatesv2/db/update${updateFileName}.php`,\r\n        {\r\n          method: 'POST',\r\n          headers: {\r\n            'Content-Type': 'application/x-www-form-urlencoded',\r\n          },\r\n          body: obj2URL(item)\r\n        })\r\n      const json:any = await response.json();\r\n      if (json.error) \r\n        throw json.error\r\n      newItem = {\r\n        ...item\r\n      }\r\n    }\r\n\r\n    // CREATE ITEM\r\n    if (item._modified === ModifiedState.new) {\r\n      const response = await fetch(\r\n        `http://${window.location.hostname}/AMCRMERP/htdocs/custom/amhpestimatesv2/db/create${updateFileName}.php`,\r\n        {\r\n          method: 'POST',\r\n          headers: {\r\n            'Content-Type': 'application/x-www-form-urlencoded',\r\n          },\r\n          body: obj2URL(item)\r\n        })\r\n      const json:any = await response.json();\r\n      if (json.error) \r\n        throw json.error\r\n      newItem = {\r\n        ...item,\r\n        id:json.id,\r\n        estimateitemid:json.estimateitemid\r\n      } as any\r\n    }\r\n\r\n    // DELETE ITEM\r\n    if (item._modified === ModifiedState.deleted) {\r\n      const response = await fetch(\r\n        `http://${window.location.hostname}/AMCRMERP/htdocs/custom/amhpestimatesv2/db/delete${updateFileName}.php`,\r\n        {\r\n          method: 'POST',\r\n          headers: {\r\n            'Content-Type': 'application/x-www-form-urlencoded',\r\n          },\r\n          body: \"id=\"+item.id\r\n        })\r\n      const json:any = await response.json();\r\n      if (json.error) \r\n        throw json.error\r\n    }\r\n  }\r\n    \r\n  return {\r\n    ...newItem,\r\n    _modified: ModifiedState.none\r\n  }\r\n}\r\n\r\nexport const saveEstimate = createAsyncThunk<Estimate, Estimate>('saveEstimate', async (estimate:Estimate) => {\r\n  let newEstimate:Estimate = {...estimate}\r\n  let newItems:EstimateItem[] = []\r\n  \r\n  console.log(\"Saving estimate \", estimate)\r\n  if (process.env.NODE_ENV === \"production\") {\r\n\r\n    // UPDATE ESTIMATE\r\n    if (estimate._modified === ModifiedState.modified) {\r\n      const response = await fetch(\r\n        `http://${window.location.hostname}/AMCRMERP/htdocs/custom/amhpestimatesv2/db/updateEstimate.php`,\r\n        {\r\n          method: 'POST',\r\n          headers: {\r\n            'Content-Type': 'application/x-www-form-urlencoded',\r\n          },\r\n          body: obj2URL(estimate)\r\n        })\r\n      const json:any = await response.json();\r\n      if (json.msg) \r\n        throw json.msg\r\n      if (json.notes)\r\n        json.notes = cleanNotes(json.notes)\r\n      if (json.public_notes)\r\n        json.public_notes = cleanNotes(json.public_notes)\r\n      newEstimate = {\r\n        ...json,\r\n        new_construction_owner_responsability: !!json.new_construction_owner_responsability,\r\n        pay_upon_completion: !!json.pay_upon_completion,\r\n      }\r\n    }\r\n\r\n    // CREATE ESTIMATE\r\n    if (estimate._modified === ModifiedState.new) {\r\n      const response = await fetch(\r\n        `http://${window.location.hostname}/AMCRMERP/htdocs/custom/amhpestimatesv2/db/createEstimate.php`,\r\n        {\r\n          method: 'POST',\r\n          headers: {\r\n            'Content-Type': 'application/x-www-form-urlencoded',\r\n          },\r\n          body: obj2URL(estimate)\r\n        })\r\n      const json:any = await response.json();\r\n      if (json.msg) \r\n        throw json.msg\r\n      if (json.notes)\r\n        json.notes = cleanNotes(json.notes)\r\n      if (json.public_notes)\r\n        json.public_notes = cleanNotes(json.public_notes)\r\n      newEstimate = {\r\n        ...json,\r\n        new_construction_owner_responsability: !!json.new_construction_owner_responsability,\r\n        pay_upon_completion: !!json.pay_upon_completion,\r\n      }\r\n    }\r\n\r\n    // Update items\r\n    let promises:Promise<void>[] = []\r\n    estimate.items?.forEach(i => {\r\n      promises.push((async () => {\r\n        if (isModified(i._modified)) {\r\n          let newItem = await saveItem({\r\n            ...i,\r\n            estimateid: newEstimate.id || 0,\r\n          })\r\n          if (i._modified !== ModifiedState.deleted)\r\n            newItems.push(newItem)\r\n        }\r\n        else\r\n          newItems.push({...i})\r\n      })())\r\n    })\r\n    await Promise.all(promises)\r\n  }\r\n  else {\r\n    if (!newEstimate.id)\r\n      newEstimate.id = 999 // simulate a new estimate being created\r\n    newItems = newEstimate.items?.filter(i => i._modified !== ModifiedState.deleted).map(i => ({\r\n      ...i,\r\n      _modified: ModifiedState.none\r\n    }))\r\n  }\r\n\r\n  return {\r\n    ...newEstimate,\r\n    items: newItems?.map(i => ({\r\n      ...i,\r\n      _modified: ModifiedState.none\r\n    })),\r\n    _modified: ModifiedState.none\r\n  }\r\n})\r\n\r\nexport const duplicateEstimate2 = createAsyncThunk<Estimate, Estimate>('duplicateEstimate2', async (estimate:Estimate) => {  \r\n  let newEstimate:Estimate = {...estimate}\r\n\r\n  if (process.env.NODE_ENV === \"production\") {\r\n    const response = await fetch(\r\n      `http://${window.location.hostname}/AMCRMERP/htdocs/custom/amhpestimatesv2/db/copyEstimate.php`,\r\n      {\r\n        method: 'POST',\r\n        headers: {\r\n          'Content-Type': 'application/x-www-form-urlencoded',\r\n        },\r\n        body: obj2URL({id: estimate.id})\r\n      })\r\n    const json:any = await response.json();\r\n    if (json.msg && json.msg !== \"OK\") \r\n      throw json.msg\r\n    newEstimate = await _fetchEstimate(json.newID)\r\n  }\r\n  else {\r\n    newEstimate = await _fetchEstimate((newEstimate.id||0) + 1000)\r\n  }\r\n  return {\r\n    ...newEstimate,\r\n  }\r\n})\r\n\r\n// const _updateItemNumbers = (items:EstimateItem[]) => {\r\n//   let index = 0;\r\n//   return items.map((item:EstimateItem) => {\r\n//     index++;\r\n//     if (item.itemno !== index)\r\n//       return {...item, itemno: index}\r\n//     return item\r\n//   })\r\n// }\r\n\r\nexport const estimatesSlice = createSlice({\r\n  name: 'estimate',\r\n  initialState,\r\n  reducers: {\r\n    createEstimate: (state, action:PayloadAction<Estimate>) => {\r\n      state.estimate = {\r\n        ...action.payload,\r\n        customer: action.payload.customer ? {...action.payload.customer} : undefined,\r\n        items: action.payload.items?.map(i => ({...i})),\r\n        _modified: isModified(action.payload._modified) ? action.payload._modified : ModifiedState.new\r\n      }\r\n    },\r\n    duplicateEstimate: (state, action:PayloadAction<Estimate>) => {\r\n      state.estimate = {\r\n        ...action.payload,\r\n        id: undefined,\r\n        estimatenum:undefined,\r\n        quotedate: formatDate(new Date()),\r\n        status: EstimateStatus.InProgress,\r\n        status_reason: undefined,\r\n        approved_date: undefined,\r\n        rejected_date: undefined,\r\n        delivered_date: undefined,\r\n        customer: action.payload.customer ? {\r\n          ...action.payload.customer\r\n        } : undefined,\r\n        permitId: undefined,\r\n        items: action.payload.items?.map(i => ({\r\n          ...i,\r\n          id: undefined,\r\n          estimateid: 0,\r\n          _modified: ModifiedState.new\r\n        })),\r\n        _modified: ModifiedState.new\r\n      }\r\n    },\r\n    updateEstimate: (state, action:PayloadAction<Estimate>) => {\r\n      state.estimate = {\r\n        ...action.payload,\r\n        customer: action.payload.customer ? {...action.payload.customer} : undefined,\r\n        items: action.payload.items?.map(i => ({...i})),\r\n        _modified: isModified(action.payload._modified) ? action.payload._modified : ModifiedState.modified\r\n      }\r\n    },\r\n    updateItem: (state, action:PayloadAction<EstimateItem>) => {\r\n      let updatedItem = {\r\n        ...action.payload,\r\n        _modified: isModified(action.payload._modified) ? action.payload._modified : ModifiedState.modified\r\n      }\r\n      let items:EstimateItem[] = [];\r\n      if (state.estimate && state.estimate.items) {\r\n        items = state.estimate.items.map(i => i.id === action.payload.id ? updatedItem : i)          \r\n        state.estimate = {\r\n          ...state.estimate,\r\n          items: items\r\n        }\r\n      }\r\n    },\r\n    deleteItem: (state, action:PayloadAction<EstimateItem>) => {\r\n      if (state.estimate) {\r\n        let items:EstimateItem[] = [];\r\n        if (state.estimate.items)\r\n          items = state.estimate.items.filter(i => i.itemno !== action.payload.itemno)\r\n        if (action.payload._modified !== ModifiedState.new)\r\n          items.push({\r\n            ...action.payload,\r\n            _modified: ModifiedState.deleted\r\n          })\r\n        state.estimate = {\r\n          ...state.estimate,\r\n          items: items,\r\n          _modified: state.estimate._modified\r\n        }\r\n      }\r\n    },\r\n    copyItem: (state, action:PayloadAction<EstimateItem>) => {\r\n      if (state.estimate) {\r\n        let items:EstimateItem[] = [];\r\n        if (state.estimate.items) {\r\n          items = [\r\n            ...state.estimate.items, \r\n            {\r\n              ...action.payload, \r\n              id: state.nextItemId--, \r\n              itemno: state.estimate.items.map(i => i.itemno||0).reduce((m,v) => m<v?v:m, 0)+1,\r\n              _modified: ModifiedState.new\r\n            }\r\n          ]\r\n          state.estimate = {\r\n            ...state.estimate,\r\n            items: items,\r\n            _modified: state.estimate._modified\r\n          }\r\n        }\r\n      }\r\n    },\r\n    addItem: (state, action:PayloadAction<EstimateItem>) => {\r\n      if (state.estimate) {\r\n        let items:EstimateItem[] = state.estimate.items;\r\n        items = [\r\n          ...state.estimate.items, \r\n          {\r\n            ...action.payload, \r\n            id: state.nextItemId--, \r\n            itemno: state.estimate.items ? state.estimate.items.map(i => i.itemno||0).reduce((m,v) => m<v?v:m, 0)+1 : 1,\r\n            _modified: ModifiedState.new\r\n          }\r\n        ]\r\n        state.estimate = {\r\n          ...state.estimate,\r\n          items: items,\r\n          _modified: state.estimate._modified\r\n        }\r\n      }\r\n    }\r\n  },\r\n  extraReducers: (builder) => {\r\n    builder.addCase(fetchEstimate.pending, (state) => {\r\n      state.estimateStatus = LoadingState.loading\r\n    })\r\n    builder.addCase(fetchEstimate.fulfilled, (state, action) => {\r\n      if ((action.payload as any).err) {\r\n          state.estimateStatus = LoadingState.failed\r\n          state.estimate = undefined\r\n          state.error = (action.payload as any).err\r\n      }\r\n      else {\r\n          state.estimateStatus = LoadingState.succeeded\r\n          state.estimate = action.payload\r\n          state.error = undefined\r\n      }\r\n    })\r\n    builder.addCase(fetchEstimate.rejected, (state, action) => {\r\n      state.estimateStatus = LoadingState.failed\r\n      state.error = action.error.message\r\n    })\r\n\r\n    builder.addCase(saveEstimate.pending, (state) => {\r\n      state.estimateStatus = LoadingState.saving\r\n    })\r\n    builder.addCase(saveEstimate.fulfilled, (state, action) => {\r\n      state.estimateStatus = LoadingState.succeeded\r\n      state.estimate = action.payload\r\n      state.error = undefined\r\n    })\r\n    builder.addCase(saveEstimate.rejected, (state, action) => {\r\n      state.estimateStatus = LoadingState.failed\r\n      state.error = action.error.message\r\n    })\r\n  }\r\n})\r\n\r\nexport const { createEstimate, updateEstimate, duplicateEstimate, updateItem, deleteItem, copyItem, addItem } = estimatesSlice.actions\r\n\r\nexport const selectEstimate = (state:RootState) : Estimate|undefined => state.estimates.estimate\r\nexport const selectEstimateStatus = (state:RootState) : LoadingState => state.estimates.estimateStatus\r\nexport const selectEstimateError = (state:RootState) : string => state.estimates.error??\"\"\r\n\r\nexport default estimatesSlice.reducer","\r\nexport const Defaults = {\r\n    \"user\": {\"name\":\"PD\",\"admin\":false, \"phone\":\"1234567890\"},\r\n    \"company\":{\"name\":\"A & M Hurricane Protection\", \"address\":\"1050 E 15 STREET\",\"town\":\"HIALEAH\",\"zip\":\"33010\",\"state\":\"Florida\", phone: \"(305) 885-0678\", fax: \"(305) 482-0510\"},\r\n    \"colors\":[\r\n        {\"value\":\"5\",\"label\":\"ALUMINUM\"},\r\n        {\"value\":\"11\",\"label\":\"AZURE\"},\r\n        {\"value\":\"1\",\"label\":\"BEIGE\"},\r\n        {\"value\":\"2\",\"label\":\"BRONZE\"},\r\n        {\"value\":\"7\",\"label\":\"CLEAR\"},\r\n        {\"value\":\"10\",\"label\":\"CLEAR ANODIZE\"},\r\n        {\"value\":\"12\",\"label\":\"GRAY\"},\r\n        {\"value\":\"3\",\"label\":\"IVORY\"},\r\n        {\"value\":\"4\",\"label\":\"MILL FINISH\"},\r\n        {\"value\":\"9\",\"label\":\"NONE\"},\r\n        {\"value\":\"8\",\"label\":\"PENDING\"},\r\n        {\"value\":\"6\",\"label\":\"WHITE\"}\r\n    ],\r\n    \"providers\":[\r\n        {\"value\":\"7\",\"label\":\"ECO WINDOWS\"},\r\n        {\"value\":\"2\",\"label\":\"EMS HV 1\"},\r\n        {\"value\":\"5\",\"label\":\"EMS HV 2\"},\r\n        {\"value\":\"6\",\"label\":\"EMS Panels\"},\r\n        {\"value\":\"4\",\"label\":\"FS Panels\"},\r\n        {\"value\":\"3\",\"label\":\"FS Performance 2\"},\r\n        {\"value\":\"10\",\"label\":\"JB GARAGE DOORS\"},\r\n        {\"value\":\"11\",\"label\":\"MILLWORK\"},\r\n        {\"value\":\"9\",\"label\":\"MR. GLASS\"},\r\n        {\"value\":\"8\",\"label\":\"PGT WINDOWS\"},\r\n        {\"value\":\"1\",\"label\":\"RC AS 500\"}\r\n    ],\r\n    \"roomtypes\":[\r\n        {\"value\":\"4\",\"label\":\"Back Door\"},\r\n        {\"value\":\"2\",\"label\":\"Bathroom\"},\r\n        {\"value\":\"1\",\"label\":\"Bedroom\"},\r\n        {\"value\":\"5\",\"label\":\"Front Door\"},\r\n        {\"value\":\"6\",\"label\":\"Kitchen\"},\r\n        {\"value\":\"7\",\"label\":\"Living Room\"},\r\n        {\"value\":\"8\",\"label\":\"Side Door\"},\r\n        {\"value\":\"9\",\"label\":\"Slide Door\"},\r\n        {\"value\":\"3\",\"label\":\"Other\"},\r\n        {\"value\":\"0\",\"label\":\"Unknown\"},\r\n    ],\r\n    \"itemtypes\":[\r\n        {\"value\":\"1\",\"label\":\"3F\"},\r\n        {\"value\":\"2\",\"label\":\"ADJ\"},\r\n        {\"value\":\"3\",\"label\":\"CEI\"},\r\n        {\"value\":\"4\",\"label\":\"EXT\"},\r\n        {\"value\":\"5\",\"label\":\"F\"},\r\n        {\"value\":\"6\",\"label\":\"H\"},\r\n        {\"value\":\"7\",\"label\":\"REM\"},\r\n        {\"value\":\"8\",\"label\":\"STD\"},\r\n        {\"value\":\"9\",\"label\":\"U\"},\r\n        {\"value\":\"10\",\"label\":\"WO\"}\r\n    ],\r\n    \"mounts\":[\r\n        {\"value\":\"5\",\"label\":\"CC\"},\r\n        {\"value\":\"4\",\"label\":\"CFL\"},\r\n        {\"value\":\"3\",\"label\":\"CW\"},\r\n        {\"value\":\"2\",\"label\":\"WFL\"},\r\n        {\"value\":\"1\",\"label\":\"WW\"}\r\n    ],\r\n    \"angulartypes\":[\r\n        {\"value\":\"1\",\"label\":\"1x3\"},\r\n        {\"value\":\"8\",\"label\":\"1x4x1/4\"},\r\n        {\"value\":\"7\",\"label\":\"1x4x1/8\"},\r\n        {\"value\":\"16\",\"label\":\"22.5\\u00ba\"},\r\n        {\"value\":\"13\",\"label\":\"2x2\"},\r\n        {\"value\":\"2\",\"label\":\"2x3\"},\r\n        {\"value\":\"6\",\"label\":\"2x4\"},\r\n        {\"value\":\"10\",\"label\":\"2x4x1/4\"},\r\n        {\"value\":\"9\",\"label\":\"2x4x1/8\"},\r\n        {\"value\":\"3\",\"label\":\"2x5\"},\r\n        {\"value\":\"12\",\"label\":\"2x6x1/4\"},\r\n        {\"value\":\"11\",\"label\":\"2x6x1/8\"},\r\n        {\"value\":\"4\",\"label\":\"2x7\"},\r\n        {\"value\":\"15\",\"label\":\"45\\u00ba\"},\r\n        {\"value\":\"14\",\"label\":\"90\\u00ba\"},\r\n        {\"value\":\"5\",\"label\":\"N/A\"}\r\n    ],\r\n    \"locksizes\":[\r\n        {\"value\":\"2\",\"label\":\"-6\"},\r\n        {\"value\":\"1\",\"label\":\"-4\"},\r\n        {\"value\":\"3\",\"label\":\"0\"}\r\n    ],\r\n    \"lockins\":[\r\n        {\"value\":\"1\",\"label\":\"IN\"},\r\n        {\"value\":\"2\",\"label\":\"OUT\"},\r\n        {\"value\":\"3\",\"label\":\"OUT IN\"},\r\n        {\"value\":\"4\",\"label\":\"OUT OUT\"}\r\n    ],\r\n    \"defaultvalues\":{\r\n        \"PERMIT\":\"500\",\r\n        \"INSTTIME\":\"8\",\r\n        \"CHECK50\":\"Y\",\r\n        \"SIGNATUREREQ\":\"N\",\r\n        \"YEARSWARRANTY\":\"10\",\r\n        \"CHECK10YEARSWARRANTY\":\"Y\",\r\n        \"LIFETIMEWARRANTY\":\"N\",\r\n        \"CHECKFREEOPENINGCLOSING\":\"N\",\r\n        \"CHECKNOPAYMENT\":\"Y\",\r\n        \"PO_TEMPLATE\":\"po_standard\",\r\n        \"ESTHTVALUE\":\"8\",\r\n        \"CHECK10YEARSFREEMAINTENANCE\":\"Y\",\r\n        \"HTVALUE\":\"2\",\r\n        \"MATERIAL\":\"ALUMINUM\",\r\n        \"COLOR\":\"NONE\",\r\n        \"PROVIDERID\":\"3\",\r\n        \"LOCKIN\":\"OUT\",\r\n        \"LOCKSIZE\":\"0\",\r\n        \"SQFEETPRICE\":\"14\"\r\n    },\r\n    \"configurations\":[\r\n        {\"value\":\"1\",\"label\":\"EQUAL LITES\"},\r\n        {\"value\":\"2\",\"label\":\"O\"},\r\n        {\"value\":\"3\",\"label\":\"OX\"},\r\n        {\"value\":\"14\",\"label\":\"OXX\"},\r\n        {\"value\":\"12\",\"label\":\"OXXO\"},\r\n        {\"value\":\"4\",\"label\":\"UNEQUAL LITES\"},\r\n        {\"value\":\"15\",\"label\":\"X\"},\r\n        {\"value\":\"5\",\"label\":\"XL\"},\r\n        {\"value\":\"6\",\"label\":\"XO\"},\r\n        {\"value\":\"11\",\"label\":\"XOX\"},\r\n        {\"value\":\"8\",\"label\":\"XOX 1/3 1/3 1/3\"},\r\n        {\"value\":\"7\",\"label\":\"XOX 1/4 1/2 1/3\"},\r\n        {\"value\":\"9\",\"label\":\"XR\"},\r\n        {\"value\":\"10\",\"label\":\"XX\"},\r\n        {\"value\":\"13\",\"label\":\"XXO\"}\r\n    ],\r\n}\r\n\r\n","import { createSlice, createAsyncThunk } from '@reduxjs/toolkit'\r\nimport { LoadingState } from '../types/Status';\r\nimport * as mock from './mock/defaults-mock';\r\nimport { RootState } from './store'\r\n\r\nexport type UserData = {\r\n  name: string\r\n  admin: boolean\r\n  phone: string\r\n}\r\n\r\nexport type CompanyData = {\r\n  name: string\r\n  address: string\r\n  town: string\r\n  zip: string\r\n  state: string\r\n  phone: string\r\n  fax: string\r\n}\r\n\r\nexport type LabeledData = {\r\n  value: string\r\n  label: string\r\n}\r\n\r\nexport type DefaultData = {\r\n  user: UserData\r\n  company: CompanyData\r\n  colors: LabeledData[]\r\n  providers: LabeledData[]\r\n  roomtypes: LabeledData[]\r\n};\r\n\r\nconst InitialData = {\r\n  user: { name: \"\", admin: false, phone: \"\"},\r\n  company: { name: \"\", address: \"\", town: \"\", zip: \"\", state: \"\", phone: \"\", fax: \"\"},\r\n  colors: [],\r\n  providers: [],\r\n  roomtypes: [],\r\n};\r\n\r\nexport type DefaultsState = {\r\n    defaults?: DefaultData\r\n    defaultsStatus: LoadingState,\r\n\r\n    error?: string\r\n}\r\n\r\nconst initialState : DefaultsState = {\r\n  defaults: InitialData,\r\n  defaultsStatus: LoadingState.unavailable\r\n}\r\n\r\nexport const fetchDefaults = createAsyncThunk<DefaultData>('getDefaults', async (arg:void, thunkAPI:any) => {\r\n  if (process.env.NODE_ENV === \"production\") {\r\n    const response = await fetch(`http://${window.location.hostname}/AMCRMERP/htdocs/custom/amhpestimatesv2/formdata.js.php`)\r\n    const json:DefaultData = await response.json();\r\n    return json;\r\n  }\r\n  \r\n  // For testing in dev\r\n  return mock.Defaults\r\n})\r\n\r\nexport const defaultsSlice = createSlice({\r\n  name: 'defaults',\r\n  initialState,\r\n  reducers: {\r\n  },\r\n  extraReducers: (builder) => {\r\n\r\n    builder.addCase(fetchDefaults.pending, (state, action) => {\r\n      state.defaultsStatus = LoadingState.loading\r\n    })\r\n    builder.addCase(fetchDefaults.fulfilled, (state, action) => {\r\n      state.defaultsStatus = LoadingState.succeeded\r\n      state.defaults = action.payload\r\n    })\r\n    builder.addCase(fetchDefaults.rejected, (state, action) => {\r\n      state.defaultsStatus = LoadingState.failed\r\n      state.error = action.error.message\r\n    })\r\n  }\r\n})\r\n\r\nexport const selectDefaults = (state:RootState) : DefaultData|undefined => state.defaults.defaults\r\nexport const selectDefaultsStatus = (state:RootState) : LoadingState => state.defaults.defaultsStatus\r\nexport const selectDefaultsError = (state:RootState) : string => state.defaults.error ? state.defaults.error : \"\"\r\n\r\nexport type RoomTypeConverterFunction = (id?:string|undefined) => string|undefined\r\n/** This selector returns a function that knows how to convert a room type id into a string. The string is the roomtype name if the room types have been loaded from the database, otherwise it is just the id */\r\nexport const selectId2RoomTypeConvertor = (state:RootState):RoomTypeConverterFunction => \r\n  (id?:string|undefined) => {\r\n    let label\r\n    if (state.defaults.defaults?.roomtypes)\r\n      label = state.defaults.defaults.roomtypes.find(rt => rt.value === id)?.label\r\n\r\n    if (!label)\r\n      label = id\r\n\r\n    return label\r\n  }\r\n\r\nexport const selectRoomType2IdConvertor = (state:RootState):RoomTypeConverterFunction => \r\n  (type?:string|undefined) => {\r\n    let value\r\n    if (state.defaults.defaults?.roomtypes)\r\n      value = state.defaults.defaults.roomtypes.find(rt => rt.label === type)?.value\r\n\r\n    if (!value)\r\n      value = type\r\n\r\n    return value\r\n  }\r\n\r\nexport default defaultsSlice.reducer","import { Modal, Button } from 'antd';\r\nimport './styles.css';\r\n\r\ntype ProductOptionsProps = {\r\n    visible: boolean\r\n    handleImpactProduct: () => void\r\n    handleHardware: () => void\r\n    handleMaterial: () => void\r\n    handleDesign: () => void\r\n    handleCancel: () => void\r\n}\r\n\r\nconst ProductOptions = (p: ProductOptionsProps) => {\r\n    return (\r\n        <Modal\r\n            okButtonProps={{ style: { display: 'none' } }}\r\n            title=\"Product Type\"\r\n            visible={p.visible} \r\n            onCancel={p.handleCancel}>\r\n            <div className='buttons_grid'>\r\n                <Button className='button_product' onClick={p.handleImpactProduct}>Impact Product</Button>\r\n                <Button className='button_product' onClick={p.handleHardware}>Hardware</Button>\r\n                <Button className='button_product' onClick={p.handleMaterial}>Material</Button>\r\n                <Button className='button_product' onClick={p.handleDesign}>Design</Button>\r\n            </div>\r\n        </Modal>\r\n    );\r\n};\r\n\r\nexport default ProductOptions;","const currency = new Intl.NumberFormat('us-EN', { style: 'currency', currency: 'USD', minimumFractionDigits: 2, maximumFractionDigits: 2 })\r\n\r\nconst round2Decimals = (value:number|undefined):number => Math.round((value||0)*100)/100\r\nconst percentTimes100 = (value:number|undefined):number => Math.round((value||0)*10_000)/100 // Convert to 0..1 value to percentage and round to 2 digits after decimal point avoiding JS rounding errors\r\nconst asMoney = (value:number|undefined):string => currency.format(value||0)\r\nconst moneyParser = (value:string|undefined):number => Number((value||\"\").replace(/[^\\d.]/g, ''))\r\nconst asPercentage = (value:number|undefined):string => `${percentTimes100(value)}%`\r\nconst percentageParser = (value:string|undefined):number => Number((value||\"\").replace('%', ''))/100\r\n\r\nconst phoneRegEx = /[^0-9]/g\r\nconst formatPhone = (txt:string|undefined):string|undefined => {\r\n    let digits:string = (txt||\"\").replaceAll(phoneRegEx,\"\")\r\n\r\n    if (digits !== \"\") {\r\n        // remove extra digits\r\n        digits = digits.substring(0,10)\r\n\r\n        // add missing digits\r\n        if (digits.length < 10)\r\n            digits = \"0000000000\".substring(digits.length) + digits\r\n\r\n        return digits.substring(0,3) + \"-\" + digits.substring(3,6) + \"-\" + digits.substring(6);\r\n    }\r\n    return undefined\r\n}\r\n\r\nexport { asMoney, moneyParser, asPercentage, percentageParser, percentTimes100, round2Decimals, formatPhone }","import { Col, Divider, Row } from \"antd\";\r\nimport Text from \"antd/lib/typography/Text\";\r\nimport Title from \"antd/lib/typography/Title\";\r\nimport { EstimateTotals } from \"../../store/EstimateTotals\";\r\nimport { asMoney, percentTimes100, round2Decimals } from \"../../types/formats\";\r\n\r\nexport type TotalsTableProps = {\r\n    totals:EstimateTotals\r\n    onChangeAdditionalDiscountProductsPercentage?: (val:number) => void\r\n    onChangeAdditionalDiscountInstallPercentage?: (val:number) => void\r\n    onChangePermits?: (val:number) => void\r\n    onChangeSalesTax?: (val:number) => void\r\n    includeInstallation: boolean\r\n    readOnly: boolean\r\n}\r\n\r\nconst cs1 =  {xs:2,     sm:8,   md:8,   lg:12,  xl:12}\r\nconst cs2 =  {xs:14,    sm:10,  md:10,  lg:8,   xl:8}\r\nconst cs3 =  {xs:8,     sm:6,   md:6,   lg:4,   xl:4}\r\nconst cs23 = {xs:22,    sm:16,  md:16,  lg:12,  xl:12}\r\nconst LeftIndent = (props:any) => <Col {...cs1} className={props.className}></Col>\r\nconst TotalText = (props:any) => <Col {...cs2} className={props.className}><Title level={5}>{props.children}</Title></Col>\r\nconst TotalAmount = (props:any) => <Col {...cs3} style={{textAlign:\"right\"}} className={props.className}><Text>{props.children}</Text></Col>\r\n\r\nconst TotalsTable = ({totals, onChangeAdditionalDiscountProductsPercentage, onChangeAdditionalDiscountInstallPercentage, onChangePermits, onChangeSalesTax, includeInstallation, readOnly}: TotalsTableProps) => {\r\n    const additionalDiscountProductsPercentageStr = percentTimes100(totals.additionalDiscountProductsPercentage).toString()\r\n    const additionalDiscountInstallPercentageStr = percentTimes100(totals.additionalDiscountInstallPercentage).toString()\r\n    const permitsStr = round2Decimals(totals.totalPermits).toString()\r\n    const salesTaxStr = percentTimes100(totals.salesTax).toString()\r\n\r\n    const updateAdditionalDiscountProductsPercentage = (val:string) => {\r\n        if (!isNaN(Number(val)) && onChangeAdditionalDiscountProductsPercentage !== undefined) {\r\n            let valF = Number(val)/100\r\n            if (valF !== totals.additionalDiscountProductsPercentage) {\r\n                onChangeAdditionalDiscountProductsPercentage(valF)\r\n            }\r\n        }\r\n    }\r\n\r\n    const updateAdditionalDiscountInstallPercentage = (val:string) => {\r\n        if (!isNaN(Number(val)) && onChangeAdditionalDiscountInstallPercentage !== undefined) {\r\n            let valF = Number(val)/100\r\n            if (valF !== totals.additionalDiscountInstallPercentage) {\r\n                onChangeAdditionalDiscountInstallPercentage(valF)\r\n            }\r\n        }\r\n    }\r\n\r\n    const updatePermits = (val:string) => {\r\n        let valF = Number(val)\r\n        if (!isNaN(valF) && onChangePermits !== undefined) {\r\n            if (valF !== totals.totalPermits) {\r\n                onChangePermits(valF)\r\n            }\r\n        }\r\n    }\r\n\r\n    const updateSalesTax = (val:string) => {\r\n        if (!isNaN(Number(val)) && onChangeSalesTax !== undefined) {\r\n            let valF = Number(val)/100\r\n            if (valF !== totals.salesTax) {\r\n                onChangeSalesTax(valF)\r\n            }\r\n        }\r\n    }\r\n\r\n    const discountClass = (v:number) => v === 0 ? \"hide-on-print\" : \"\"\r\n\r\n    return (\r\n        <Row className=\"totals-table\" gutter={[24, 4]}>\r\n            {totals.countImpactProducts > 0 \r\n                ? <>\r\n                    <LeftIndent></LeftIndent>\r\n                    <TotalText>Total Impact Products</TotalText>\r\n                    <TotalAmount>{asMoney(totals.totalImpactProducts)}</TotalAmount>\r\n                </>\r\n                : null}\r\n\r\n            {totals.countStormPanels > 0 \r\n                ? <>\r\n                    <LeftIndent></LeftIndent>\r\n                    <TotalText>Total Storm Panels</TotalText>\r\n                    <TotalAmount>{asMoney(totals.totalStormPanels)}</TotalAmount>\r\n                </>\r\n                : null}\r\n\r\n            {totals.countHardware > 0 \r\n                ? <>\r\n                    <LeftIndent></LeftIndent>\r\n                    <TotalText>Total Hardware</TotalText>\r\n                    <TotalAmount>{asMoney(totals.totalHardware)}</TotalAmount>\r\n                    </>\r\n                : null}\r\n\r\n            {totals.countMaterial > 0 \r\n                ? <>\r\n                    <LeftIndent></LeftIndent>\r\n                    <TotalText>Total Material</TotalText>\r\n                    <TotalAmount>{asMoney(totals.totalMaterial)}</TotalAmount>\r\n                    </>\r\n                : null}\r\n\r\n            {totals.countDesign > 0 \r\n                ? <>\r\n                    <LeftIndent></LeftIndent>\r\n                    <TotalText>Total Design</TotalText>\r\n                    <TotalAmount>{asMoney(totals.totalDesign)}</TotalAmount>\r\n                    </>\r\n                : null}\r\n\r\n            {includeInstallation ? \r\n                <>\r\n                    <LeftIndent></LeftIndent>\r\n                    <TotalText>Total Installation</TotalText>\r\n                    <TotalAmount>{asMoney(totals.totalInstallation)}</TotalAmount>\r\n                </> : \"\"}\r\n\r\n            <LeftIndent></LeftIndent>\r\n            <TotalText>Total Other Fees</TotalText>\r\n            <TotalAmount>{asMoney(totals.totalOtherFees)}</TotalAmount>\r\n\r\n            <LeftIndent className={discountClass(totals.discountAllProducts)}></LeftIndent>\r\n            <TotalText className={discountClass(totals.discountAllProducts)}>Product Discounts</TotalText>\r\n            <TotalAmount className={discountClass(totals.discountAllProducts)}>{asMoney(-totals.discountAllProducts)}</TotalAmount>\r\n\r\n            {includeInstallation ? \r\n                <>\r\n                    <LeftIndent className={discountClass(totals.discountInstallation)}></LeftIndent>\r\n                    <TotalText className={discountClass(totals.discountInstallation)}>Installation Discounts</TotalText>\r\n                    <TotalAmount className={discountClass(totals.discountInstallation)}>{asMoney(-totals.discountInstallation)}</TotalAmount>\r\n                </> : \"\"}\r\n\r\n            <LeftIndent className={discountClass(totals.additionalDiscountProducts)}></LeftIndent>\r\n            <TotalText className={discountClass(totals.additionalDiscountProducts)}>Additional Product Dsc % <Text editable={!readOnly && { onChange: updateAdditionalDiscountProductsPercentage }}>{additionalDiscountProductsPercentageStr}</Text></TotalText>\r\n            <TotalAmount className={discountClass(totals.additionalDiscountProducts)}>{asMoney(-totals.additionalDiscountProducts)}</TotalAmount>\r\n\r\n            {includeInstallation ? \r\n                <>\r\n                    <LeftIndent className={discountClass(totals.additionalDiscountInstall)}></LeftIndent>\r\n                    <TotalText className={discountClass(totals.additionalDiscountInstall)}>Additional Installation Dsc % <Text editable={!readOnly && { onChange: updateAdditionalDiscountInstallPercentage }}>{additionalDiscountInstallPercentageStr}</Text></TotalText>\r\n                    <TotalAmount className={discountClass(totals.additionalDiscountInstall)}>{asMoney(-totals.additionalDiscountInstall)}</TotalAmount>\r\n                </> : \"\"}\r\n\r\n            <LeftIndent></LeftIndent>\r\n            <TotalText>Permits $<Text editable={!readOnly && { onChange: updatePermits }}>{permitsStr}</Text></TotalText>\r\n            <TotalAmount>{asMoney(totals.totalPermits)}</TotalAmount>\r\n\r\n            <LeftIndent></LeftIndent>\r\n            <Col {...cs23}>\r\n                <Divider style={{margin:\"12px 0px\"}}/>\r\n            </Col>\r\n\r\n            <LeftIndent></LeftIndent>\r\n            <TotalText>Subtotal</TotalText>\r\n            <TotalAmount>{asMoney(totals.totalBeforeTax)}</TotalAmount>\r\n\r\n            <LeftIndent></LeftIndent>\r\n            <TotalText>Sales Tax %<Text editable={!readOnly && { onChange: updateSalesTax }}>{salesTaxStr}</Text></TotalText>\r\n            <TotalAmount>{asMoney(totals.salesTaxDollars)}</TotalAmount>\r\n\r\n            <LeftIndent></LeftIndent>\r\n            <TotalText>Total Amount</TotalText>\r\n            <TotalAmount>{asMoney(totals.finalPrice)}</TotalAmount>\r\n        </Row>)\r\n}\r\n\r\nexport default TotalsTable;","import { CopyFilled, DeleteFilled, EditFilled } from '@ant-design/icons';\r\nimport { Row, Col, Image, Button } from 'antd';\r\nimport Text from \"antd/lib/typography/Text\";\r\nimport { Estimate } from '../../store/Estimate';\r\nimport { EstimateItem } from '../../store/EstimateItem';\r\nimport { ImpactProduct } from '../../store/ImpactProduct';\r\nimport { asMoney, asPercentage } from '../../types/formats';\r\nimport ModuleType from '../../types/ModuleType';\r\nimport './styles.css';\r\n\r\nexport interface ButtonProps {\r\n    item: EstimateItem\r\n    itemIndex?: number\r\n    onAdd?: (e:any,index?:number) => void\r\n    onEdit?: (e:any,item:EstimateItem) => void\r\n    onDelete?: (e:any,item:EstimateItem) => void\r\n    onCopy?: (e:any,item:EstimateItem) => void\r\n    readOnly: boolean\r\n}\r\n\r\nexport const ProductButtons = ({ item, itemIndex, onAdd, onEdit, onDelete, onCopy, readOnly }: ButtonProps) =>\r\n    <>\r\n        <Button disabled={readOnly} type=\"primary\" shape=\"round\" onClick={(e:any) => onCopy && onCopy(e, item)} icon={<CopyFilled />} style={{marginRight: \".5rem\"}} title=\"Copy\"/>\r\n        <Button disabled={readOnly} type=\"primary\" shape=\"round\" onClick={(e:any) => onDelete && onDelete(e, item)} icon={<DeleteFilled />} style={{marginRight: \".5rem\"}} title=\"Delete\"/>\r\n        <Button type=\"primary\" shape=\"round\" onClick={(e:any) => onEdit && onEdit(e, item)} icon={<EditFilled />}  title=\"Edit\"/>\r\n    </>\r\n\r\nexport interface ProductComponentProps {\r\n    e: Estimate\r\n    item: EstimateItem\r\n    description?: JSX.Element\r\n    onUpdateItemNo?: (val:number) => void\r\n    onUpdateQuantity?: (val:number) => void\r\n    readOnly: boolean\r\n}\r\n\r\nconst ProductComponent = ({ e, item, description, onUpdateItemNo, onUpdateQuantity, readOnly }: ProductComponentProps) => {\r\n    const qtyWidth = item.modtype === ModuleType.Material ? 2 : 1\r\n    const updateItemNo = (val:string) => {\r\n        const num:number = Number(val)\r\n        if (onUpdateItemNo && !isNaN(num)) \r\n            onUpdateItemNo(num)\r\n    }\r\n    const updateQuantity = (val:string) => {\r\n        const num:number = Number(val)\r\n        if (onUpdateQuantity && !isNaN(num)) \r\n            onUpdateQuantity(num)\r\n    }\r\n\r\n    return (\r\n        <>\r\n            <Row gutter={[6, 6]} className=\"product-component\" wrap={false}>\r\n                <Col xs={1} sm={1} md={1} lg={1} xl={1}>\r\n                    <div className='title_container'>\r\n                        <p className='table_text'>#</p>\r\n                    </div>\r\n                    <div className='context_container'>\r\n                        <Text editable={!readOnly && { onChange: updateItemNo }}>{item.itemno}</Text>\r\n                    </div>\r\n                </Col>\r\n                <Col xs={6} sm={6} md={6} lg={6} xl={6}>\r\n                    <div className='title_container'>\r\n                        <p className='table_text'>Description</p>\r\n                    </div>\r\n                    <div className='context_container'>\r\n                        <p className='table_text description'>{item.name}</p>\r\n                        {description}\r\n                    </div>\r\n                </Col>\r\n                <Col xs={5} sm={5} md={5} lg={5} xl={5}>\r\n                    <div className='title_container'>\r\n                        <p className='table_text'>Image</p>\r\n                    </div>\r\n                    <div className='context_container'>\r\n                        <Image\r\n                            src={(process.env.REACT_APP_URL_PREFIX||\"\") + item.image}\r\n                            fallback=\"data:image/png;base64,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\"\r\n                        />\r\n                    </div>\r\n                </Col>\r\n                <Col xs={qtyWidth} sm={qtyWidth} md={qtyWidth} lg={qtyWidth} xl={qtyWidth}>\r\n                    <div className='title_container'>\r\n                        <p className='table_text'>Qty</p>\r\n                    </div>\r\n                    <div className='context_container'>\r\n                        {item.modtype === ModuleType.Material \r\n                            ? <Text editable={!readOnly && { onChange: updateQuantity }}>{item.quantity}</Text>\r\n                            : <p className='table_text'>{item.quantity}</p> \r\n                        }\r\n                    </div>\r\n                </Col>\r\n                <Col xs={3} sm={3} md={3} lg={3} xl={3}>\r\n                    <div className='title_container'>\r\n                        <p className='table_text'>Unit Price</p>\r\n                    </div>\r\n                    <div className='context_container'>\r\n                        <p className='table_text'>{asMoney(item.sales_price)}</p>\r\n                    </div>\r\n                </Col>\r\n                {item.modtype===ModuleType.ImpactProduct ? \r\n                    <Col xs={2} sm={2} md={2} lg={2} xl={2}>\r\n                        <div className='title_container'>\r\n                            <p className='table_text'>Colonial</p>\r\n                        </div>\r\n                        <div className='context_container'>\r\n                            <p className='table_text'>{asMoney((item as ImpactProduct).colonial_fee)}</p>\r\n                        </div>\r\n                    </Col> : \"\"}\r\n                {![ModuleType.Material, ModuleType.Design].includes(item.modtype) ? \r\n                    <Col xs={2} sm={2} md={2} lg={2} xl={2}>\r\n                        <div className='title_container'>\r\n                            <p className='table_text'>Install</p>\r\n                        </div>\r\n                        <div className='context_container'>\r\n                            <p className='table_text'>{asMoney(e.is_installation_included ? item.inst_price : 0)}</p>\r\n                        </div>\r\n                    </Col> : \"\"}\r\n                <Col xs={2} sm={2} md={2} lg={2} xl={2}>\r\n                    {item.sales_discount && item.sales_discount > 0 ? \r\n                        <>\r\n                            <div className='title_container'>\r\n                                <p className='table_text'>Dsc</p>\r\n                            </div>\r\n                            <div className='context_container'>\r\n                                <p className='table_text'>{asPercentage(item.sales_discount)}</p>\r\n                            </div>\r\n                        </> : \r\n                        <>\r\n                            <div className='title_container'>\r\n                                <p className='table_text'>&nbsp;</p>\r\n                            </div>\r\n                            <div className='context_container'>\r\n                                <p className='table_text'>&nbsp;</p>\r\n                            </div>\r\n                        </>\r\n                    }\r\n                </Col>\r\n                <Col xs={2} sm={2} md={2} lg={2} xl={2}>\r\n                    <div className='title_container'>\r\n                        <p className='table_text'>Total</p>\r\n                    </div>\r\n                    <div className='context_container'>\r\n                        <p className='table_text'>{asMoney(item.finalprice)}</p>\r\n                    </div>\r\n                </Col>\r\n\r\n            </Row>\r\n        </>\r\n    );\r\n};\r\n\r\nexport default ProductComponent; ","import { useAppSelector } from '../../store/hooks';\r\nimport { ImpactProduct } from '../../store/ImpactProduct';\r\nimport ProductComponent, { ProductComponentProps } from './ProductComponent';\r\nimport * as ds from '../../store/defaultsSlice';\r\nimport { LoadingState } from '../../types/Status';\r\n\r\nexport interface ImpactProductProps extends ProductComponentProps {\r\n    item: ImpactProduct\r\n    readOnly: boolean\r\n}\r\n\r\nconst ImpactProductComponent = ({ item, ...rest }: ImpactProductProps) => {\r\n    const defaults: ds.DefaultData | undefined = useAppSelector(ds.selectDefaults)\r\n    const defaultStatus = useAppSelector(ds.selectDefaultsStatus)\r\n    const id2RoomType = (id?:string):string|undefined => defaults?.roomtypes ? defaults.roomtypes.find(rt => rt.value === id)?.label : undefined\r\n    const roomtype = (defaultStatus === LoadingState.loading || item.roomtype === undefined) \r\n        ? \"Unknown\"\r\n        : id2RoomType(item.roomtype.toString())\r\n\r\n    return (\r\n        <ProductComponent\r\n            item={item} \r\n            description={\r\n                <>\r\n                    <p className='table_text'>Screen: {item.is_screen?\"Yes\":\"No\"}</p>\r\n                    <p className='table_text'>Size: {item.widthtxt||\"?\"} x {item.heighttxt||\"?\"} x {item.lengthtxt||\"?\"}</p>\r\n                    <p className='table_text'>Glass Type: {item.glass_type}</p>\r\n                    <p className='table_text'>Glass Color: {item.glass_color}</p>\r\n                    <p className='table_text'>Interlayer: {item.interlayer}</p>\r\n                    <p className='table_text'>Coating: {item.coating}</p>\r\n                    <p className='table_text'>Type of Room: {roomtype}</p>\r\n                    <p className='table_text'>Room {item.roomnum}</p>\r\n                </>\r\n            }\r\n\r\n            {...rest}\r\n        />)\r\n};\r\n\r\nexport default ImpactProductComponent;\r\n\r\n","import { Estimate } from '../../store/Estimate';\r\nimport { Hardware } from '../../store/Hardware';\r\nimport ProductComponent, { ProductComponentProps } from './ProductComponent';\r\n\r\nexport interface HardwareComponentProps extends ProductComponentProps {\r\n    e: Estimate\r\n    item: Hardware\r\n    readOnly: boolean\r\n}\r\n\r\nconst HardwareComponent = ({ e, item, ...rest }: HardwareComponentProps) => {\r\n    return (\r\n        <ProductComponent\r\n            e={e}\r\n            item={item} \r\n            description={\r\n                <>\r\n                    <p className='table_text'>Provider: {item.provider}</p>\r\n                    <p className='table_text'>Reference: {item.product_ref}</p>\r\n                    <p className='table_text'>Hardware Type: {item.hardwaretype}</p>\r\n                    <p className='table_text'>Configuration: {item.configuration}</p>        \r\n                </>\r\n            }\r\n            {...rest}\r\n        />)\r\n};\r\n\r\nexport default HardwareComponent;","import ModuleType from \"../types/ModuleType\"\r\nimport { Estimate, getItems } from \"./Estimate\"\r\nimport { EstimateItem } from \"./EstimateItem\"\r\nimport { ImpactProduct } from \"./ImpactProduct\"\r\nimport { round2Decimals } from \"../types/formats\";\r\n\r\nexport interface EstimateTotals {\r\n    countImpactProducts: number\r\n    totalImpactProducts: number\r\n    discountImpactProducts:number\r\n    instImpactProducts: number\r\n    discountInstImpactProducts: number\r\n\r\n    countStormPanels: number\r\n    totalStormPanels: number\r\n    discountStormPanels: number\r\n    instStormPanels: number\r\n    discountInstStormPanels: number\r\n\r\n    countHardware: number\r\n    totalHardware: number\r\n    discountHardware: number\r\n    instHardware: number\r\n    discountInstHardware: number\r\n    \r\n    countMaterial: number\r\n    totalMaterial: number\r\n    discountMaterial: number\r\n    \r\n    countDesign: number\r\n    totalDesign: number\r\n    discountDesign: number\r\n    \r\n    discountAllProducts: number\r\n    \r\n    totalInstallation: number\r\n    discountInstallation: number\r\n\r\n    totalOtherFees: number\r\n    totalDiscount: number\r\n\r\n    additionalDiscountProductsPercentage:number\r\n    additionalDiscountProducts: number\r\n    additionalDiscountInstallPercentage: number\r\n    additionalDiscountInstall: number\r\n\r\n    totalPermits: number\r\n    totalBeforeTax: number\r\n    salesTax: number\r\n    salesTaxDollars: number\r\n    finalPrice: number\r\n}\r\n\r\n// Calculates total of given property in all items matching the product type\r\nconst total = (\r\n    items: EstimateItem[],                          // List of items over which to calculate total\r\n    getVal: (i:EstimateItem) => any,                // Extract a value from an estimate item - must return value or undefined\r\n    pt?:ModuleType                                 // Filter for items of this type, must be a valid type or undefined\r\n):number => \r\n    items.filter(i => pt===undefined || pt === i.modtype)\r\n    .map(i => getVal(i))\r\n    .filter(v => v !== undefined)\r\n    .reduce((t:number, v:number) => t+v, 0)\r\n\r\nexport const createEstimateTotals = (e:Estimate|undefined, additionalDiscountProductsPercentage:number, additionalDiscountInstallPercentage: number, totalPermits: number, salesTax: number):EstimateTotals => {\r\n    if (e && e.items) {\r\n        let ii:EstimateItem[] = getItems(e)\r\n\r\n        const colonialPrice = (i:EstimateItem) => {\r\n            let cp:number = 0\r\n            if (i.modtype === ModuleType.ImpactProduct) {\r\n                let ip = i as ImpactProduct\r\n                if (ip.is_colonial)\r\n                    cp = ip.colonial_fee || 0\r\n            }\r\n            return cp\r\n        }\r\n\r\n        const countImpactProducts = ii.filter(i => i.modtype === ModuleType.ImpactProduct).length\r\n        const totalImpactProducts = total(ii, i => (i.sales_price||0) + colonialPrice(i), ModuleType.ImpactProduct)\r\n        const instImpactProducts = e.is_installation_included ? total(ii, i => i.inst_price, ModuleType.ImpactProduct ) : 0\r\n        const discountImpactProducts = total(ii, i => (i.sales_price||0) * (i.sales_discount||0), ModuleType.ImpactProduct )\r\n        const discountInstImpactProducts = e.is_installation_included ? total(ii, i => (i.inst_price||0) * (i.inst_discount||0), ModuleType.ImpactProduct ) : 0\r\n\r\n        const countStormPanels = ii.filter(i => i.modtype === ModuleType.StormPanel).length\r\n        const totalStormPanels = total(ii, i => i.sales_price, ModuleType.StormPanel)\r\n        const discountStormPanels = total(ii, i => (i.sales_price||0) * (i.sales_discount||0), ModuleType.StormPanel)\r\n        const instStormPanels = e.is_installation_included ? total(ii, i => i.inst_price, ModuleType.StormPanel) : 0\r\n        const discountInstStormPanels = e.is_installation_included ? total(ii, i => (i.inst_price||0) * (i.inst_discount||0), ModuleType.StormPanel) : 0\r\n\r\n        const countHardware = ii.filter(i => i.modtype === ModuleType.Hardware).length\r\n        const totalHardware = total(ii, i => i.sales_price, ModuleType.Hardware)\r\n        const discountHardware = total(ii, i => (i.sales_price||0) * (i.sales_discount||0), ModuleType.Hardware)\r\n        const instHardware = e.is_installation_included ? total(ii, i => i.inst_price, ModuleType.Hardware) : 0\r\n        const discountInstHardware = e.is_installation_included ? total(ii, i => (i.inst_price||0) * (i.inst_discount||0), ModuleType.Hardware) : 0\r\n\r\n        const countMaterial = ii.filter(i => i.modtype === ModuleType.Material).length\r\n        const totalMaterial = total(ii, i => (i.sales_price||0)*(i.quantity||1), ModuleType.Material)\r\n        const discountMaterial = total(ii, i => (i.sales_price||0) * (i.quantity||1) * (i.sales_discount||0), ModuleType.Material)\r\n\r\n        const countDesign = ii.filter(i => i.modtype === ModuleType.Design).length\r\n        const totalDesign = total(ii, i => (i.sales_price||0)*(i.quantity||1), ModuleType.Design)\r\n        const discountDesign = total(ii, i => (i.sales_price||0) * (i.quantity||1) * (i.sales_discount||0), ModuleType.Design)\r\n\r\n        const totalInstallation = e.is_installation_included ? total(ii, i => i.inst_price) : 0\r\n        const discountInstallation = e.is_installation_included ? total(ii, i => (i.inst_price||0) * (i.inst_discount||0)) : 0\r\n\r\n        const totalAllProducts = total(ii, i => i.sales_price)\r\n        const totalOtherFees = total(ii, i => i.otherfees)\r\n        const discountAllProducts = total(ii, i => (i.sales_price||0) * (i.sales_discount||0))\r\n        const totalDiscount = discountAllProducts+discountInstallation\r\n        \r\n        const additionalDiscountProducts = totalAllProducts*additionalDiscountProductsPercentage\r\n        const additionalDiscountInstall = totalInstallation*additionalDiscountInstallPercentage\r\n        const totalBeforeTax = \r\n              totalAllProducts + totalOtherFees - discountAllProducts\r\n            + totalInstallation - discountInstallation\r\n            - additionalDiscountProducts\r\n            - additionalDiscountInstall\r\n            + totalPermits\r\n\r\n        const salesTaxDollars = (totalAllProducts - discountAllProducts - additionalDiscountProducts) * (salesTax||0)\r\n\r\n        const finalPrice = round2Decimals(totalBeforeTax + salesTaxDollars)\r\n\r\n        return {\r\n            countImpactProducts,\r\n            totalImpactProducts,\r\n            instImpactProducts,\r\n            discountImpactProducts,\r\n            discountInstImpactProducts,\r\n\r\n            countStormPanels,\r\n            totalStormPanels,\r\n            discountStormPanels,\r\n            instStormPanels,\r\n            discountInstStormPanels,\r\n            \r\n            countHardware,\r\n            totalHardware,\r\n            discountHardware,\r\n            instHardware,\r\n            discountInstHardware,\r\n\r\n            countMaterial,\r\n            totalMaterial,\r\n            discountMaterial,\r\n\r\n            countDesign,\r\n            totalDesign,\r\n            discountDesign,\r\n\r\n            discountAllProducts,\r\n\r\n            totalInstallation,\r\n            discountInstallation,\r\n\r\n            totalOtherFees,\r\n            totalDiscount,\r\n\r\n            additionalDiscountProductsPercentage,\r\n            additionalDiscountProducts,\r\n            additionalDiscountInstallPercentage,\r\n            additionalDiscountInstall,\r\n\r\n            totalPermits,\r\n            totalBeforeTax,\r\n            salesTax,\r\n            salesTaxDollars,\r\n            finalPrice\r\n        }\r\n    }\r\n    \r\n    return {\r\n        countImpactProducts:0,\r\n        totalImpactProducts:0,\r\n        instImpactProducts:0,\r\n        discountImpactProducts:0,\r\n        discountInstImpactProducts:0,\r\n\r\n        countStormPanels:0,\r\n        totalStormPanels:0,\r\n        discountStormPanels:0,\r\n        instStormPanels:0,\r\n        discountInstStormPanels:0,\r\n        \r\n        countHardware:0,\r\n        totalHardware:0,\r\n        discountHardware:0,\r\n        instHardware:0,\r\n        discountInstHardware:0,\r\n\r\n        countMaterial:0,\r\n        totalMaterial:0,\r\n        discountMaterial:0,\r\n\r\n        countDesign:0,\r\n        totalDesign:0,\r\n        discountDesign:0,\r\n\r\n        discountAllProducts:0,\r\n\r\n        totalInstallation:0,\r\n        discountInstallation:0,\r\n\r\n        totalOtherFees:0,\r\n        totalDiscount:0,\r\n\r\n        additionalDiscountProductsPercentage:0,\r\n        additionalDiscountProducts:0,\r\n        additionalDiscountInstallPercentage:0,\r\n        additionalDiscountInstall:0,\r\n\r\n        totalPermits:0,\r\n        totalBeforeTax:0,\r\n        salesTax:0,\r\n        salesTaxDollars:0,\r\n        finalPrice:0\r\n    }\r\n}\r\n\r\n","import { ImpactProduct } from \"../../store/ImpactProduct\"\r\nimport ModuleType from \"../../types/ModuleType\"\r\nimport { isDeleted } from \"../../types/Status\"\r\nimport WinType from \"../../types/WinType\"\r\nimport { Estimate } from \"../Estimate\"\r\nimport { ValidationHelpers, EstimateProblem, PendingProblems } from \"../validations\"\r\n\r\nconst openingLimits:any = {\r\n    [WinType.CasementWindowSeries]: { minWidth: 0, minHeight: 36.75 },\r\n    [WinType.FixedGlass]: { minWidth: 0, minHeight: 0 },\r\n    [WinType.FrenchDoor]: { minWidth: 0, minHeight: 0 },\r\n    [WinType.HorizontalRollingSeries]: { minWidth: 52.375, minHeight: 0 },\r\n    [WinType.SingleHungSeries]: { minWidth: 0, minHeight: 56.75 },\r\n    [WinType.SlidingDoor]: { minWidth: 0, minHeight: 0 },\r\n}\r\n\r\n/**\r\n * Check all bedrooms to make sure they have at least one escape window. Also, highlight any rooms with no type.\r\n */\r\nexport const checkEmergencyExits = (e:Estimate|undefined, h:ValidationHelpers):EstimateProblem[] => {\r\n    const problems:EstimateProblem[] = []\r\n\r\n    // Check if room type data is loaded\r\n    const bedroomTypeId = h.roomType2Id(\"Bedroom\")\r\n    if (!bedroomTypeId)\r\n        return [PendingProblems]\r\n\r\n    // Get list of rooms that have no type\r\n    const ip = e?.items?.filter(i => !isDeleted(i._modified) && i.modtype === ModuleType.ImpactProduct).map(i => i as ImpactProduct)\r\n    const roomNumbersMissingTypes = ip?.reduce((accum, current) => {\r\n        if (!current.roomtype)\r\n            if (current.roomnum && !accum.includes(current.roomnum))\r\n                accum.push(current.roomnum)\r\n\r\n        return accum;\r\n    }, [] as number[])\r\n    if (roomNumbersMissingTypes && roomNumbersMissingTypes.length > 0)\r\n        problems.push({\r\n            msg: `Some rooms are missing a type - so we can't confirm if escape openings are required. Please check room numbers: ${roomNumbersMissingTypes}`,\r\n            link: \"\",\r\n            type: \"warning\"\r\n        })\r\n\r\n    // Get list of bedrooms that have no number\r\n    const allBedroomItems = ip?.filter(i => i.roomtype?.toString() === bedroomTypeId)\r\n    const countRoomsMissingNumber = allBedroomItems?.reduce((accum, current) => {\r\n        if (current.roomnum === undefined || current.roomnum <= 0)\r\n            accum++\r\n        return accum;\r\n    }, 0)\r\n    if (countRoomsMissingNumber && countRoomsMissingNumber > 0)\r\n        problems.push({\r\n            msg: `${countRoomsMissingNumber} rooms are missing a room number so we can't check for escape openings.`,\r\n            link: \"\",\r\n            type: \"warning\"\r\n        })\r\n\r\n    // Get list of bedrooms missing an escape window.\r\n    // Step 1: Get list of bedroom numbers\r\n    // Step 2: Get list of bedrooms with an escape window.\r\n    // Step 3: Compare the two lists.\r\n    const allBedroomItemsWithRoomnum = allBedroomItems?.filter(i => i.roomnum !== undefined && i.roomnum > 0)\r\n    const allBedroomNumbers = allBedroomItemsWithRoomnum?.reduce((accum, current) => {\r\n        if (current.roomnum && !accum.includes(current.roomnum))\r\n            accum.push(current.roomnum)                \r\n        return accum;\r\n    }, [] as number[])\r\n    const bedroomNumbersWithEscape = allBedroomItemsWithRoomnum?.reduce((accum, current) => {\r\n        if (current.wintype && current.roomnum && !accum.includes(current.roomnum)) {\r\n            let ol = openingLimits[current.wintype]\r\n            if (ol \r\n                && current.width\r\n                && current.width >= ol.minWidth\r\n                && current.height\r\n                && current.height >= ol.minHeight)\r\n                accum.push(current.roomnum)\r\n        }\r\n        return accum;\r\n    }, [] as number[])\r\n\r\n    const bedroomNumbersMissingEscape = allBedroomNumbers?.filter(i => !bedroomNumbersWithEscape?.includes(i))\r\n    bedroomNumbersMissingEscape?.forEach(n => problems.push({\r\n        msg: `Room ${n} is missing an escape opening.`,\r\n        link: \"\",\r\n        type: \"error\"\r\n    }))\r\n\r\n    return problems\r\n}\r\n","import { Estimate } from \"./Estimate\"\r\nimport { checkBathroomOpenings } from \"./validations/checkBathroomOpenings\"\r\nimport { checkEmergencyExits } from \"./validations/checkEmergencyExits\"\r\nimport { checkRequiredHardware } from \"./validations/checkRequiredHardware\"\r\n\r\nexport interface EstimateProblem {\r\n    msg: string\r\n    link: string\r\n    type: \"warning\"|\"error\"|\"info\"\r\n}\r\n\r\nexport interface ValidationHelpers {\r\n    id2RoomType: (id?:string) => string|undefined\r\n    roomType2Id: (id?:string) => string|undefined\r\n}\r\n\r\nexport const PendingProblems:EstimateProblem = {\r\n    msg: \"Validating...\",\r\n    link: \"\",\r\n    type: \"info\"\r\n}\r\n\r\n/**\r\n * Check estimate for required elemnts like escape rooms and opaque windows in bathrooms, etc.\r\n */\r\nexport const validateEstimate = (e:Estimate|undefined, h:ValidationHelpers):EstimateProblem[] => {\r\n    // Check all bathrooms have an interlayer that is clear\r\n    // If an item is a french door or fiberglass then ask for hardware\r\n\r\n    const problems:EstimateProblem[] = [] // {msg:\"error\",link:\"yes\",type:\"error\"}, {msg:\"warning\",link:\"\",type:\"warning\"}, {msg:\"info\",link:\"\",type:\"info\"}\r\n\r\n    problems.push(...checkEmergencyExits(e,h))\r\n    problems.push(...checkBathroomOpenings(e,h))\r\n    problems.push(...checkRequiredHardware(e,h))\r\n\r\n    return problems\r\n}\r\n","import ModuleType from \"../../types/ModuleType\"\r\nimport { isDeleted } from \"../../types/Status\"\r\nimport { Estimate } from \"../Estimate\"\r\nimport { ImpactProduct } from \"../ImpactProduct\"\r\nimport { ValidationHelpers, EstimateProblem, PendingProblems } from \"../validations\"\r\n\r\n/**\r\n * Warn about all bathrooms that have an interlayer that is clear\r\n */\r\nexport const checkBathroomOpenings = (e:Estimate|undefined, h:ValidationHelpers):EstimateProblem[] => {\r\n    const problems:EstimateProblem[] = []\r\n\r\n    // Check if room type data is loaded\r\n    const bathroomTypeId = h.roomType2Id(\"Bathroom\")\r\n    if (!bathroomTypeId)\r\n        return [PendingProblems]\r\n\r\n    // Get bathrooms\r\n    const ip = e?.items?.filter(i => !isDeleted(i._modified) && i.modtype === ModuleType.ImpactProduct).map(i => i as ImpactProduct)\r\n    const allBathroomItems = ip?.filter(i => i.roomtype?.toString() === bathroomTypeId)\r\n    const allBathroomItemsWithClearOpening = allBathroomItems?.filter(i => i.interlayer?.toString() === \"CLEAR\")\r\n    const roomNumbersWithClearOpening = allBathroomItemsWithClearOpening?.reduce((accum, current) => {\r\n        if (current.roomnum && !accum.includes(current.roomnum))\r\n            accum.push(current.roomnum)\r\n\r\n        return accum;\r\n    }, [] as number[])\r\n    if (roomNumbersWithClearOpening && roomNumbersWithClearOpening.length > 0)\r\n        problems.push({\r\n            msg: `Some bathrooms have clear openings. Please confirm with client or check room numbers: ${roomNumbersWithClearOpening}`,\r\n            link: \"\",\r\n            type: \"warning\"\r\n        })\r\n\r\n    return problems\r\n}","import { Estimate } from \"../Estimate\"\r\nimport { ValidationHelpers, EstimateProblem, PendingProblems } from \"../validations\"\r\n\r\n/**\r\n * Check all french door or fiberglass have hardware\r\n */\r\nexport const checkRequiredHardware = (e:Estimate|undefined, h:ValidationHelpers):EstimateProblem[] => {\r\n    const problems:EstimateProblem[] = []\r\n\r\n    // Check if room type data is loaded\r\n    const bedroomTypeId = h.roomType2Id(\"Bedroom\")\r\n    if (!bedroomTypeId)\r\n        return [PendingProblems]\r\n\r\n    return problems\r\n}\r\n\r\n","import { useEffect } from \"react\"\r\nimport { Estimate, isDirty } from \"../store/Estimate\"\r\nimport { EstimateItem } from \"../store/EstimateItem\"\r\nimport { isModified } from \"../types/Status\"\r\n\r\nfunction useModifiedAlert(estimate:Estimate|undefined, item?:EstimateItem) {\r\n    useEffect(() => {\r\n        const alertUser = (e:BeforeUnloadEvent) => {\r\n            if ((estimate && isDirty(estimate)) || (item && isModified(item._modified))) {\r\n                e.preventDefault()\r\n                e.returnValue = \"Please save your changes first.\"\r\n            }\r\n        }\r\n\r\n        window.addEventListener('beforeunload', alertUser)\r\n        return () => {\r\n            window.removeEventListener('beforeunload', alertUser)\r\n        }\r\n    }, [estimate, item])\r\n}\r\n\r\nexport default useModifiedAlert","import React from 'react';\r\nimport { Modal, Button } from 'antd';\r\nimport './styles.css';\r\n\r\nexport enum RoomType {\r\n    Unknown,\r\n    Bedroom,\r\n    Bathroom,\r\n    Other\r\n}\r\n\r\ntype RoomOptionsProps = {\r\n    isModalVisible: boolean;\r\n    handleCancel: () => void;\r\n    handleTypeOptions?: (type:RoomType) => void;\r\n}\r\n\r\nconst RoomOptions = ({ isModalVisible, handleCancel, handleTypeOptions }: RoomOptionsProps) => {\r\n    return (\r\n        <Modal\r\n            okButtonProps={{ style: { display: 'none' } }}\r\n            title=\"In what type of room is this opening located?\"\r\n            visible={isModalVisible} \r\n            onCancel={handleCancel}>\r\n            <div className='buttons_grid'>\r\n                <Button className='button_product' onClick={() => handleTypeOptions && handleTypeOptions(RoomType.Bedroom)}>Bedroom</Button>\r\n                <Button className='button_product' onClick={() => handleTypeOptions && handleTypeOptions(RoomType.Bathroom)}>Bathroom</Button>\r\n                <Button className='button_product' onClick={() => handleTypeOptions && handleTypeOptions(RoomType.Other)}>Other</Button>\r\n                <Button className='button_product' onClick={() => handleTypeOptions && handleTypeOptions(RoomType.Unknown)}>I don't know</Button>\r\n            </div>\r\n        </Modal>\r\n    );\r\n};\r\n\r\nexport default RoomOptions;","import { UpCircleTwoTone } from \"@ant-design/icons\";\r\nimport { Checkbox, Select, Space } from \"antd\";\r\nimport Title from \"antd/lib/typography/Title\";\r\nimport { useEffect, useState } from \"react\";\r\nimport { Estimate } from \"../../store/Estimate\";\r\nimport * as es from '../../store/estimatesSlice';\r\nimport { useAppDispatch, useAppSelector } from '../../store/hooks';\r\n\r\nconst depositPercentDefault=50\r\nconst depositWithInstallationPercentDefault=40\r\nconst finalInspectionDefault=10\r\nconst warrantyYearsDefault=5\r\n\r\nexport interface EstimateOptionsProps {\r\n    readOnly: boolean\r\n}\r\n\r\nconst EstimateOptions = ({readOnly}:EstimateOptionsProps) => {\r\n    const dispatch = useAppDispatch();\r\n    const estimate: Estimate | undefined = useAppSelector(es.selectEstimate)\r\n\r\n    const deposit_percent = estimate && estimate.deposit_percent !== undefined ? estimate.deposit_percent : 0\r\n    const deposit_percent_with_install = estimate && estimate.deposit_percent_with_install !== undefined ? estimate.deposit_percent_with_install : 0\r\n    const percent_final_inspection = estimate && estimate.percent_final_inspection !== undefined ? estimate.percent_final_inspection : 0\r\n\r\n    const warranty_years = estimate && estimate.warranty_years !== undefined ? estimate.warranty_years : 0\r\n    const [warrantyYearsDropdown, setWarrantyYearsDropdown] = useState(warrantyYearsDefault)\r\n    \r\n    const new_construction_owner_responsability = estimate && estimate.new_construction_owner_responsability !== undefined ? estimate.new_construction_owner_responsability : false\r\n    const pay_upon_completion = estimate && estimate.pay_upon_completion !== undefined ? estimate.pay_upon_completion : false\r\n\r\n    const noPrintIfZero = (v:number) => v === 0 ? \"hide-on-print\" : \"\"\r\n    const noPrintIfFalsy = (v:boolean|number) => v === false || v === 0 ? \"hide-on-print\" : \"\"\r\n\r\n    useEffect(() => {\r\n        if (estimate) {\r\n            if (!estimate.warranty_years && warrantyYearsDropdown !== warrantyYearsDefault)\r\n                setWarrantyYearsDropdown(warrantyYearsDefault)\r\n            if (estimate.warranty_years && warrantyYearsDropdown !== estimate.warranty_years)\r\n                setWarrantyYearsDropdown(Number(estimate.warranty_years||0))\r\n        }\r\n        else\r\n            setWarrantyYearsDropdown(warrantyYearsDefault)\r\n    }, [estimate, warrantyYearsDropdown])\r\n\r\n    const updateWarrantyYears = (val:number) => {\r\n        if (estimate)\r\n            dispatch(es.updateEstimate({...estimate, warranty_years: val}))\r\n    }\r\n\r\n    const toggleWarrantyYears = (val:number) => {\r\n        if (estimate) {\r\n            const years = estimate.warranty_years && estimate.warranty_years>0?0:val\r\n            dispatch(es.updateEstimate({...estimate, warranty_years: years}))\r\n        }\r\n    }\r\n\r\n    const hasConditions = \r\n        deposit_percent>0 || \r\n        deposit_percent_with_install>0 ||\r\n        percent_final_inspection>0 ||\r\n        warranty_years>0 ||\r\n        new_construction_owner_responsability ||\r\n        pay_upon_completion\r\n\r\n    const m = { style: {marginTop: \".2em\"} }\r\n    const Separator = () => <UpCircleTwoTone style={{margin:\"0 1em 0 1em\"}} twoToneColor=\"#aaaaaa\"/>\r\n\r\n    return (\r\n        <Space size={[0, 0]} direction=\"vertical\" align=\"center\" style={{width: \"100%\"}} className={\"estimate-options \" + noPrintIfFalsy(hasConditions)}>\r\n            <Title level={4}>Conditions</Title>\r\n            <div style={{textAlign: \"center\"}}>\r\n                <Separator/>\r\n                <Space {...m} direction=\"horizontal\" style={{whiteSpace: \"nowrap\"}} className={noPrintIfZero(deposit_percent)} onClick={(e) => !readOnly && estimate && dispatch(es.updateEstimate({...estimate, deposit_percent: estimate.deposit_percent && estimate.deposit_percent>0?0:depositPercentDefault}))}>\r\n                    <Title style={{marginBottom: \"2px\"}} level={5}>{depositPercentDefault}% Deposit</Title>\r\n                    <Checkbox \r\n                        checked={deposit_percent>0} \r\n                        onChange={(e) => estimate && dispatch(es.updateEstimate({...estimate, deposit_percent: e.target.checked ? depositPercentDefault : 0}))}\r\n                        disabled={readOnly}\r\n                    />\r\n                    <Separator/>\r\n                </Space>\r\n                \r\n                <Space {...m} direction=\"horizontal\" style={{whiteSpace: \"nowrap\"}} className={noPrintIfZero(deposit_percent_with_install)} onClick={(e) => !readOnly && estimate && dispatch(es.updateEstimate({...estimate, deposit_percent_with_install: estimate.deposit_percent_with_install && estimate.deposit_percent_with_install>0?0:depositWithInstallationPercentDefault}))}>\r\n                    <Title style={{marginBottom: \"2px\"}} level={5}>{depositWithInstallationPercentDefault}% Deposit With Installation</Title>\r\n                    <Checkbox \r\n                        checked={deposit_percent_with_install>0} \r\n                        onChange={(e) => estimate && dispatch(es.updateEstimate({...estimate, deposit_percent_with_install: e.target.checked ? depositWithInstallationPercentDefault : 0}))}\r\n                        disabled={readOnly}\r\n                    />\r\n                    <Separator/>\r\n                </Space>\r\n\r\n                <Space {...m} direction=\"horizontal\" style={{whiteSpace: \"nowrap\"}} className={noPrintIfZero(percent_final_inspection)} onClick={(e) => !readOnly && estimate && dispatch(es.updateEstimate({...estimate, percent_final_inspection: estimate.percent_final_inspection && estimate.percent_final_inspection>0?0:finalInspectionDefault}))}>\r\n                    <Title style={{marginBottom: \"2px\"}} level={5}>{finalInspectionDefault}% Final Inspection</Title>\r\n                    <Checkbox \r\n                        checked={percent_final_inspection>0} \r\n                        onChange={(e) => estimate && dispatch(es.updateEstimate({...estimate, percent_final_inspection: e.target.checked ? finalInspectionDefault : 0}))}\r\n                        disabled={readOnly}\r\n                    />\r\n                    <Separator/>\r\n                </Space>\r\n\r\n                <Space {...m} direction=\"horizontal\" style={{whiteSpace: \"nowrap\"}} className={noPrintIfZero(warranty_years)} >\r\n                    <Select size=\"small\" value={warrantyYearsDropdown} onChange={(val) => { updateWarrantyYears(Number(val)) }} disabled={readOnly} onClick={e => e.preventDefault()} >\r\n                        <Select.Option value=\"10\">10</Select.Option>\r\n                        <Select.Option value=\"5\">5</Select.Option>\r\n                    </Select>\r\n                    <Title style={{marginBottom: \"2px\", cursor:\"pointer\"}} onClick={() => !readOnly && toggleWarrantyYears(warrantyYearsDropdown)} level={5}>Years Warranty</Title>\r\n                    <Checkbox \r\n                        checked={warranty_years>0} \r\n                        onChange={(e) => updateWarrantyYears(e.target.checked ? warrantyYearsDropdown : 0)}\r\n                        disabled={readOnly}\r\n                    />\r\n                    <Separator/>\r\n                </Space>\r\n\r\n                <Space {...m} direction=\"horizontal\" style={{whiteSpace: \"nowrap\"}} className={noPrintIfFalsy(new_construction_owner_responsability)} onClick={(e) => !readOnly && estimate && dispatch(es.updateEstimate({...estimate, new_construction_owner_responsability: !estimate.new_construction_owner_responsability}))}>\r\n                    <Title style={{marginBottom: \"2px\"}} level={5}>New construction the buck is owner responsibility</Title>\r\n                    <Checkbox \r\n                        checked={estimate?.new_construction_owner_responsability} \r\n                        onChange={(e) => estimate && dispatch(es.updateEstimate({...estimate, new_construction_owner_responsability: e.target.checked}))}\r\n                        disabled={readOnly}\r\n                    />\r\n                    <Separator/>\r\n                </Space>\r\n\r\n                <Space {...m} direction=\"horizontal\" style={{whiteSpace: \"nowrap\"}} className={noPrintIfFalsy(pay_upon_completion)} onClick={(e) => !readOnly && estimate && dispatch(es.updateEstimate({...estimate, pay_upon_completion: !estimate.pay_upon_completion}))}>\r\n                    <Title level={5}>Pay after job is complete</Title>\r\n                    <Checkbox \r\n                        checked={estimate?.pay_upon_completion} \r\n                        onChange={(e) => estimate && dispatch(es.updateEstimate({...estimate, pay_upon_completion: e.target.checked}))}\r\n                        disabled={readOnly}\r\n                    />\r\n                    <Separator/>\r\n                </Space>\r\n            </div>\r\n        </Space>\r\n       )\r\n}\r\n\r\nexport default EstimateOptions;","export const COLORS = [\r\n    {\r\n        id: '5',\r\n        name: 'ALUMINUM',\r\n        hex: '#D0D5DB'\r\n    },\r\n    {\r\n        id: '11',\r\n        name: 'AZURE',\r\n        hex: '#007FFF'\r\n    },\r\n    {\r\n        id: '1',\r\n        name: 'BEIGE',\r\n        hex: '#E1C699'\r\n    },\r\n    {\r\n        id: '2',\r\n        name: 'BRONZE',\r\n        hex: '#B08D57'\r\n    },\r\n    {\r\n        id: '7',\r\n        name: 'CLEAR',\r\n        hex: 'transparent'\r\n    },\r\n    {\r\n        id: '10',\r\n        name: 'CLEAR ANODIZE',\r\n        hex: 'transparent'\r\n    },\r\n    {\r\n        id: '12',\r\n        name: 'GRAY',\r\n        hex: '#808080'\r\n    },\r\n    {\r\n        id: '3',\r\n        name: 'IVORY',\r\n        hex: '#FFFFF0'\r\n    },\r\n    {\r\n        id: '4',\r\n        name: 'MILL FINISH',\r\n        hex: '#B0B3B7'\r\n    },\r\n    {\r\n        id: '9',\r\n        name: 'NONE',\r\n        hex: 'transparent'\r\n    },\r\n    {\r\n        id: '8',\r\n        name: 'NONE',\r\n        hex: 'transparent'\r\n    },\r\n    {\r\n        id: '6',\r\n        name: 'WHITE',\r\n        hex: '#FFFFFF'\r\n    }\r\n]\r\n","import { WarningOutlined } from \"@ant-design/icons\"\r\nimport { Badge, Checkbox, Col, Divider, Input, Row, Select } from \"antd\"\r\nimport Title from \"antd/lib/typography/Title\"\r\nimport { CustomerName, RelationshipType } from \"../../store/customersSlice\"\r\nimport { LabeledData, DefaultData } from '../../store/defaultsSlice';\r\nimport { Estimate } from \"../../store/Estimate\";\r\nimport { COLORS } from \"../../types/Colors\"\r\nimport { formatPhone } from \"../../types/formats\";\r\n\r\ntype Props = {\r\n    estimate?:Estimate\r\n    customerNames?: CustomerName[]\r\n    onChangeCustomer:(c:string)=>void\r\n    onUpdateEstimate:(e:Estimate)=>void\r\n    isLoading:boolean\r\n    isFailed:boolean\r\n    defaults?: DefaultData\r\n    readOnly: boolean\r\n}\r\n\r\nconst Initial = ({\r\n    estimate, \r\n    customerNames, \r\n    onChangeCustomer,\r\n    onUpdateEstimate,\r\n    isLoading,\r\n    isFailed,\r\n    defaults,\r\n    readOnly\r\n}:Props) => {\r\n\r\n    const reltype2Text = (t:number|undefined) => t ? RelationshipType[t] : \"None\" \r\n    const id2LabeledData = (id:string) => COLORS.find(c => c.id === id)\r\n    const selectedDefaultFrameColor = estimate?.defcolor?.toUpperCase();\r\n    const selectedDefaultFrameColorHex = selectedDefaultFrameColor && COLORS.find(key => key.name === selectedDefaultFrameColor)?.hex\r\n    const selectedDefaultGlassColor = estimate?.defglasscolor?.toUpperCase();\r\n    const selectedDefaultGlassColorHex = selectedDefaultGlassColor && COLORS.find(key => key.name === selectedDefaultGlassColor)?.hex\r\n    let defaultFrameColorSelector =\r\n        <>\r\n            <Title level={5}>Frame Color</Title>\r\n            <Select<LabeledData>\r\n                showSearch\r\n                className='input show1'\r\n                optionFilterProp=\"label\"\r\n                onChange={e => {\r\n                        if (estimate) \r\n                            onUpdateEstimate({...estimate, defcolor: id2LabeledData(e as any)?.name })\r\n                    }\r\n                }\r\n                filterOption={(input, option) => option?.label ? option.label.toString().toLowerCase().indexOf(input.toLowerCase()) >= 0 : true}\r\n                options={defaults?.colors}\r\n                value={estimate?.defcolor?.toUpperCase() as any}\r\n                disabled={readOnly}\r\n            />\r\n        </>\r\n    let defaultGlassColorSelector =\r\n        <>\r\n            <Title level={5}>Glass Color</Title>\r\n            <Select<LabeledData>\r\n                showSearch\r\n                className='input show1'\r\n                optionFilterProp=\"label\"\r\n                onChange={e => {\r\n                        if (estimate) \r\n                            onUpdateEstimate({...estimate, defglasscolor: id2LabeledData(e as any)?.name })\r\n                    }\r\n                }\r\n                filterOption={(input, option) => option?.label ? option.label.toString().toLowerCase().indexOf(input.toLowerCase()) >= 0 : true}\r\n                options={defaults?.colors}\r\n                value={estimate?.defglasscolor?.toUpperCase() as any}\r\n                disabled={readOnly}\r\n            />\r\n    </>\r\n\r\n    if (selectedDefaultFrameColorHex)\r\n        defaultFrameColorSelector = \r\n            <Badge.Ribbon\r\n                text={selectedDefaultFrameColor}\r\n                color={selectedDefaultFrameColorHex}>\r\n                {defaultFrameColorSelector}\r\n            </Badge.Ribbon>\r\n\r\n    if (selectedDefaultGlassColorHex)\r\n        defaultGlassColorSelector = \r\n            <Badge.Ribbon\r\n                text={selectedDefaultGlassColor}\r\n                color={selectedDefaultGlassColorHex}>\r\n                {defaultGlassColorSelector}\r\n            </Badge.Ribbon>\r\n\r\n    return <Row className=\"customer-info\" gutter={[24, 24]}>\r\n        <Col xs={24} sm={24} md={12} lg={12} xl={12}>\r\n            <Title level={5}>Customer Name</Title>\r\n            <Select<CustomerName>\r\n                showSearch\r\n                className='input show1'\r\n                optionFilterProp=\"label\"\r\n                onChange={c => {\r\n                    onChangeCustomer(c.toString()) // Not sure why, but c value is not the expected type (cs.CustomerName) - it's just the customer id\r\n                }}\r\n                filterOption={(input, option) => option?.label ? option.label.toString().toLowerCase().indexOf(input.toLowerCase()) >= 0 : true}\r\n                options={customerNames}\r\n                value={estimate?.customer?.customername as any}\r\n                loading={isLoading}\r\n                disabled={readOnly}\r\n            />\r\n\r\n            {isFailed ? <WarningOutlined style={{ marginLeft: \"1rem\", display: \"flex\", alignSelf: \"center\" }} /> : null}\r\n\r\n            <Title level={5}>Relationship Type</Title>\r\n            <Input className='input show2' placeholder='Relationship Type' disabled={true} value={reltype2Text(estimate?.customer?.reltype)} />\r\n\r\n            <Divider style={{marginTop: \"0px\" }}/>\r\n\r\n            <Title level={5}>Estimate Number</Title>\r\n            <Input className='input show2' placeholder='Estimate Number' disabled={true} value={estimate?.estimatenum} />\r\n\r\n            <Title level={5}>Customer Name</Title>\r\n            <Input className='input show4' placeholder='Customer Name' disabled={true} value={estimate?.customer?.customername} />\r\n\r\n            <Title level={5}>Customer Address</Title>\r\n            <Input className='input show3' placeholder='Customer Address' disabled={true} value={estimate?.customer?.customeraddress} />\r\n\r\n            <Title level={5}>Customer Phone</Title>\r\n            <Input className='input show3' placeholder='Customer Phone' disabled={true} value={formatPhone(estimate?.customer?.customerphone)} />\r\n\r\n            <Title level={5}>Customer Mobile</Title>\r\n            <Input className='input show3' placeholder='Customer Mobile' disabled={true} value={formatPhone(estimate?.customer?.customermobile)} />\r\n\r\n\r\n        </Col>\r\n\r\n        <Col xs={24} sm={24} md={12} lg={12} xl={12}>\r\n\r\n            <Title level={5}>Contact Name</Title>\r\n            <Input className='input show1' placeholder=\"Contact Name\" disabled={true} value={estimate?.customer?.contactname} />\r\n\r\n            <Title level={5}>Contact Address</Title>\r\n            <Input className='input show3' placeholder=\"Contact Address\" disabled={true} value={estimate?.customer?.contactaddress} />\r\n\r\n            <Title level={5}>Contact Phone</Title>\r\n            <Input className='input show2' placeholder='Contact Phone' disabled={true} value={formatPhone(estimate?.customer?.contactphone)} />\r\n\r\n            <Title level={5}>Contact Mobile</Title>\r\n            <Input className='input show4' placeholder='Contact Mobile' disabled={true} value={formatPhone(estimate?.customer?.contactmobile)} />\r\n\r\n            <Title level={5}>E-Mail</Title>\r\n            <Input className='input show2' placeholder='E-Mail' disabled={true} value={estimate?.customer?.customeremail} />\r\n\r\n            <Title level={5}>Salesperson</Title>\r\n            <Input className='input show4' placeholder='Salesperson' disabled={true} value={estimate?.vendor + (estimate?.vendor_phone ? \" (\"+formatPhone(estimate?.vendor_phone) + \")\" : \"\")} />\r\n\r\n            <Title level={5}>Folio #</Title>\r\n            <Input className='input show4' placeholder='Folio #' disabled={true} value={estimate?.customer?.folionumber} />\r\n        </Col>\r\n\r\n        <Col xxl={24}>\r\n            <div className='flex_container show3'>\r\n                <Checkbox\r\n                    checked={estimate?.is_installation_included}\r\n                    onChange={e => {\r\n                            if (estimate) \r\n                                onUpdateEstimate({...estimate, is_installation_included: e.target.checked })\r\n                        }\r\n                    }\r\n                    disabled={readOnly}\r\n                >\r\n                    <Title level={5}>Include installation services</Title>\r\n                </Checkbox>\r\n                <Checkbox\r\n                    checked={estimate?.is_alteration}\r\n                    onChange={e => {\r\n                            if (estimate) \r\n                                onUpdateEstimate({...estimate, is_alteration: e.target.checked })\r\n                        }\r\n                    }\r\n                    disabled={readOnly}\r\n                >\r\n                    <Title level={5}>Alteration</Title>\r\n                </Checkbox>\r\n            </div>\r\n        </Col>\r\n\r\n        <Col xs={24} sm={24} md={12} lg={12} xl={12}>\r\n            {defaultFrameColorSelector}\r\n        </Col>\r\n        <Col xs={24} sm={24} md={12} lg={12} xl={12}>\r\n            {defaultGlassColorSelector}\r\n        </Col>\r\n    </Row>\r\n}\r\n\r\nexport default Initial","import { Checkbox, Col, Row, Table } from \"antd\"\r\nimport { ColumnsType } from \"antd/lib/table\";\r\nimport Title from \"antd/lib/typography/Title\"\r\nimport { RelationshipType } from \"../../store/customersSlice\"\r\nimport { Estimate } from \"../../store/Estimate\";\r\nimport { formatPhone } from \"../../types/formats\";\r\n\r\ntype Props = {\r\n    estimate?:Estimate\r\n    isFailed:boolean\r\n}\r\n\r\ninterface CompactCustomerDataType1 {\r\n    label1: string\r\n    value1: string\r\n}\r\n\r\ninterface CompactCustomerDataType2 {\r\n    label2: string\r\n    value2: string\r\n}\r\n\r\ninterface CompactCustomerDataType extends CompactCustomerDataType1, CompactCustomerDataType2 {\r\n    key: string\r\n}\r\n\r\nconst columns: ColumnsType<CompactCustomerDataType> = [\r\n    {\r\n        title: 'Label1',\r\n        dataIndex: 'label1',\r\n        key: 'label1',\r\n        render: text => <b style={{ whiteSpace: \"nowrap\", verticalAlign: \"top\"}}>{text}</b>,\r\n        align: 'left',\r\n        className: 'CCDLabel'\r\n    },\r\n    {\r\n        title: 'Value1',\r\n        dataIndex: 'value1',\r\n        key: 'value1',\r\n        render: text => <b style={{ verticalAlign: \"top\"}}>{text}</b>,\r\n        className: 'CCDValue',\r\n        onCell: (_, index) => ({\r\n            colSpan: (index as number) === 0 ? 3 : 1,\r\n          }),\r\n    },\r\n    {\r\n        title: 'Label2',\r\n        dataIndex: 'label2',\r\n        key: 'label2',\r\n        render: text => <b style={{ whiteSpace: \"nowrap\", verticalAlign: \"top\"}}>{text}</b>,\r\n        align: 'left',\r\n        className: 'CCDLabel',\r\n        onCell: (_, index) => ({\r\n            colSpan: (index as number) === 0 ? 0 : 1,\r\n          }),\r\n    },\r\n    {\r\n        title: 'Value2',\r\n        dataIndex: 'value2',\r\n        key: 'value2',\r\n        render: text => <b style={{ verticalAlign: \"top\"}}>{text}</b>,\r\n        className: 'CCDValue',\r\n        onCell: (_, index) => ({\r\n            colSpan: (index as number) === 0 ? 0 : 1,\r\n          }),\r\n    },\r\n];\r\n\r\n/**\r\n * Takes an array of address components (like street, state, zip, commas, and newlines)\r\n * and creates a string where newlines and commas are removed if not neeed because address\r\n * components are missing\r\n */\r\nconst address2String = (a:(string|undefined)[]):string => {\r\n    let lines:string[] = []\r\n    let line = \"\"\r\n    a.forEach((v, i) => {\r\n        v = v || \"\"\r\n        if (v === \"\\n\") {\r\n            if (line !== \"\") {\r\n                lines.push(line.trim() + v);\r\n                line = \"\"\r\n            }\r\n        }\r\n        else if (v === \",\") {\r\n            if (line !== \"\" && !line.endsWith(\", \"))\r\n                line += \", \"\r\n        }\r\n        else if (v !== \"\") {\r\n            if (line !== \"\" && !line.endsWith(\" \"))\r\n                line += \" \"\r\n            line += v\r\n        }\r\n    })\r\n    if (line !== \"\")\r\n        lines.push(line.trim());\r\n    return lines.join(\"\")\r\n} \r\n\r\n// const checkAddress = (a:string, b:string) => {\r\n//     console.log(\"\\\"\" + a + \"\\\" == \\\"\" + b + \"\\\"\")\r\n//     console.assert(a === b)\r\n// }\r\n\r\nconst CompactCustomerData = ({\r\n    estimate, \r\n    isFailed\r\n}:Props) => {\r\n    // checkAddress(address2String([\"1 Main St.\", \",\", \"\\n\", \"New York\", \",\", \"\\n\", \"NY\", \"10001\"]), \"1 Main St.,\\nNew York,\\nNY 10001\")\r\n    // checkAddress(address2String([\"1 Main St.\", \",\", \"\\n\", undefined, \",\", \"\\n\", \"NY\", \"10001\"]), \"1 Main St.,\\nNY 10001\")\r\n    // checkAddress(address2String([undefined, \"Main St.\", \",\", \"\\n\", \"New York\", \",\", \"\\n\", \"NY\", \"10001\"]), \"Main St.,\\nNew York,\\nNY 10001\")\r\n    // checkAddress(address2String([undefined, \",\", \"\\n\", undefined, \",\", \"\\n\", undefined, undefined]), \"\")\r\n    // checkAddress(address2String([\"1 Main St.\", \",\", \"\\n\", \"New York\", \",\", \"\\n\", \"NY\", undefined]), \"1 Main St.,\\nNew York,\\nNY\")\r\n    \r\n    const reltype2Text = (t:number|undefined) => t ? RelationshipType[t] : \"None\" \r\n\r\n    // To create the table of customer data\r\n    // Collect data for left side in cols1 and the data for the right side in cols2\r\n    // Then merge them all into rows for the table\r\n\r\n    const cols1:CompactCustomerDataType1[] = []\r\n    const cols2:CompactCustomerDataType2[] = []\r\n    const createDataRow1 = (label:string, value:string):CompactCustomerDataType1 => ({label1:label?label+\":\":\"\", value1:value})\r\n    const createDataRow2 = (label:string, value:string):CompactCustomerDataType2 => ({label2:label?label+\":\":\"\", value2:value})\r\n    const addDataRow1 = (label:string, value:string|undefined, always:boolean = false) => {\r\n        if (value || always)\r\n            cols1.push(createDataRow1(label, value||\"\"))\r\n    }\r\n    const addDataRow2 = (label:string, value:string|undefined, always:boolean = false) => {\r\n        if (value || always)\r\n            cols2.push(createDataRow2(label, value||\"\"))\r\n    }\r\n    const addDataRowShortest = (label:string, value:string|undefined, always:boolean = false) => {\r\n        if (value || always) {\r\n            if (cols1.length > cols2.length)\r\n                cols2.push(createDataRow2(label, value||\"\"))\r\n            else\r\n                cols1.push(createDataRow1(label, value||\"\"))\r\n        }\r\n    }\r\n\r\n    addDataRow1('Estimate #', estimate?.estimatenum, true)\r\n    addDataRow1('Customer Phone', formatPhone(estimate?.customer?.customerphone))\r\n    addDataRow1('Customer Mobile', formatPhone(estimate?.customer?.customermobile))\r\n    addDataRow1('Customer E-Mail', estimate?.customer?.customeremail)\r\n\r\n    // Address needs to use several rows\r\n    let address:string[] = address2String([\r\n        estimate?.customer?.customeraddress, \",\", \"\\n\", \r\n        estimate?.customer?.customercity, \",\" ,\"\\n\", \r\n        estimate?.customer?.customerstate, estimate?.customer?.customerzip]).split(\"\\n\")\r\n    address.forEach((e,i) => addDataRow2(i === 0?'Customer Address':'', e));\r\n    addDataRow2('Folio #', estimate?.customer?.folionumber)\r\n    addDataRow2('Salesperson', estimate?.vendor + (estimate?.vendor_phone ? \" (\"+formatPhone(estimate?.vendor_phone) + \")\" : \"\"))\r\n\r\n    addDataRowShortest('Contact Name', estimate?.customer?.contactname)\r\n    addDataRowShortest('Contact Address', estimate?.customer?.contactaddress)\r\n    addDataRowShortest('Contact Phone', formatPhone(estimate?.customer?.contactphone))\r\n    addDataRowShortest('Contact Mobile', formatPhone(estimate?.customer?.contactmobile))\r\n    addDataRowShortest('Relationship Type', reltype2Text(estimate?.customer?.reltype))\r\n    addDataRowShortest('Frame Color', estimate?.defcolor?.toUpperCase())\r\n    addDataRowShortest('Glass Color', estimate?.defglasscolor?.toUpperCase())\r\n   \r\n    // Merges cols1 and cols2 into an array of rows with customer name in first row\r\n    let cdrows:CompactCustomerDataType[] = [{key:\"cn\", label1:\"Customer Name:\", value1:estimate?.customer?.customername||\"\", label2:\" \", value2:\" \"}] \r\n    let i:number=0\r\n    while(cols1.length > i || cols2.length > i) {\r\n        let row:CompactCustomerDataType = {key:\"\"+i, label1:\" \", value1:\" \", label2:\"\", value2:\"\"}\r\n        if (cols1.length > i)\r\n            row = {...row, label1:cols1[i].label1, value1:cols1[i].value1 }\r\n        if (cols2.length > i)\r\n            row = {...row, label2:cols2[i].label2, value2:cols2[i].value2 }\r\n        cdrows.push(row)\r\n        i++\r\n    }\r\n\r\n    const hide_is_installation_included = !estimate?.is_installation_included\r\n    const hide_is_alteration = !estimate?.is_alteration\r\n    const hide_both = hide_is_installation_included && hide_is_alteration\r\n\r\n    return <>\r\n        <Row className=\"customer-info\" gutter={[24, 24]}>\r\n            <Col xl={24}>\r\n                <Table \r\n                    dataSource={cdrows} \r\n                    columns={columns} \r\n                    showHeader={false} \r\n                    pagination={false} \r\n                    size=\"small\" \r\n                    rowClassName={(record, index) => index === 0 ? 'table-row-customername' :  ''}\r\n                />\r\n            </Col>\r\n\r\n            <Col className={hide_both ? \"hide-on-print\" : \"\"}>\r\n                <div className='flex_container show3' >\r\n                    <Checkbox\r\n                        checked={estimate?.is_installation_included}\r\n                        disabled={true}\r\n                        className={hide_is_installation_included ? \"hide-on-print\" : \"\"}\r\n                    >\r\n                        <Title level={5}>Include installation services</Title>\r\n                    </Checkbox>\r\n                    <Checkbox\r\n                        checked={estimate?.is_alteration}\r\n                        disabled={true}\r\n                        className={hide_is_alteration ? \"hide-on-print\" : \"\"}\r\n                    >\r\n                        <Title level={5}>Alteration</Title>\r\n                    </Checkbox>\r\n                </div>\r\n            </Col>\r\n        </Row>\r\n    </>\r\n}\r\n\r\nexport default CompactCustomerData","import { Col, Row, Table } from \"antd\"\r\nimport { ColumnsType } from \"antd/lib/table\";\r\nimport { EstimateTotals } from \"../../store/EstimateTotals\";\r\nimport { asMoney, percentTimes100 } from \"../../types/formats\";\r\n\r\ntype Props = {\r\n    totals:EstimateTotals\r\n    includeInstallation: boolean\r\n}\r\n\r\ninterface CompactTotalsTableType {\r\n    label: string\r\n    value: string\r\n    key: string\r\n}\r\n\r\nconst columns: ColumnsType<CompactTotalsTableType> = [\r\n    {\r\n        title: 'Label',\r\n        dataIndex: 'label',\r\n        key: 'label',\r\n        render: text => <b style={{ whiteSpace: \"nowrap\", verticalAlign: \"top\"}}>{text}</b>,\r\n        align: 'right',\r\n        className: 'CCDLabel',\r\n        width: 300\r\n    },\r\n    {\r\n        title: 'Value',\r\n        dataIndex: 'value',\r\n        key: 'value',\r\n        className: 'CCDValue',\r\n        width: 100\r\n    },\r\n];\r\n\r\nconst TwoColumnTotalsTable = ({\r\n    totals, \r\n    includeInstallation,\r\n}:Props) => {\r\n    const salesTaxStr = percentTimes100(totals.salesTax).toString()\r\n\r\n    const rightData:CompactTotalsTableType[] = []\r\n    const addDataRow = (label:string, value:number|undefined) => {\r\n        if (value)\r\n            rightData.push({label:label+\":\", value: asMoney(value), key: label})\r\n    }\r\n    const addDataRowAlways = (label:string, value:number|undefined) => {\r\n        rightData.push({label:label+\":\", value: value?asMoney(value):asMoney(0), key: label})\r\n    }\r\n\r\n    addDataRow('Total Impact Products', totals.totalImpactProducts)\r\n    addDataRow('Total Storm Panels', totals.totalStormPanels)\r\n    addDataRow('Total Hardware', totals.totalHardware)\r\n    addDataRow('Total Material', totals.totalMaterial)\r\n    addDataRow('Total Design', totals.totalDesign)\r\n    if (includeInstallation)\r\n        addDataRow('Total Installation', totals.totalInstallation)\r\n\r\n    addDataRow('Total Other Fees', totals.totalOtherFees)\r\n    addDataRow('Product Discounts', -totals.discountAllProducts)\r\n    if (includeInstallation)\r\n        addDataRow('Installation Discounts', -totals.discountInstallation)\r\n\r\n    addDataRow('Additional Product Dsc', -totals.additionalDiscountProducts)\r\n    addDataRow('Additional Installation Dsc', -totals.additionalDiscountInstall)\r\n    addDataRowAlways('Permits', totals.totalPermits)\r\n    addDataRowAlways('Subtotal', totals.totalBeforeTax)\r\n    addDataRowAlways('Sales Tax %'+salesTaxStr, totals.salesTaxDollars)\r\n    addDataRowAlways('Total Amount', totals.finalPrice)\r\n\r\n    const leftData:CompactTotalsTableType[] = rightData.splice(0, rightData.length/2,)\r\n\r\n    return <Row className=\"customer-info\" gutter={[24, 24]}>\r\n        <Col md={12}>\r\n            <Table dataSource={leftData} columns={columns} showHeader={false} pagination={false} size=\"small\" className=\"totals-table\" />\r\n        </Col>\r\n\r\n        <Col md={12}>\r\n            <Table dataSource={rightData} columns={columns} showHeader={false} pagination={false} size=\"small\" className=\"totals-table\" />\r\n        </Col>\r\n    </Row>\r\n}\r\n\r\nexport default TwoColumnTotalsTable","import ItemType from '../types/ItemType'\r\nimport ModuleType from '../types/ModuleType'\r\nimport { ModifiedState } from '../types/Status'\r\nimport WinType from '../types/WinType'\r\n\r\nexport interface EstimateItem {\r\n    _modified:ModifiedState\r\n    color?: string\r\n    cost_price?: number\r\n    estimateid: number\r\n    finalprice?: number\r\n    id?: number\r\n    image?: string\r\n    inst_discount?: number\r\n    inst_price?: number\r\n    itemno?: number\r\n    itemtype: ItemType\r\n    modtype: ModuleType\r\n    name?: string\r\n    notes?: string\r\n    otherfees?: number\r\n    quantity?: number\r\n    sales_discount?: number\r\n    sales_price?: number\r\n    wintype: WinType\r\n}\r\n\r\nexport const  DefaultEstimateItem:EstimateItem = {\r\n    _modified: ModifiedState.new,\r\n    color: \"\",\r\n    cost_price: 0,\r\n    estimateid: 0,\r\n    finalprice: 0,\r\n    id: 0,\r\n    image: \"\",\r\n    inst_discount: 0,\r\n    inst_price: 0,\r\n    itemno: 1,\r\n    itemtype: ItemType.None,\r\n    modtype: ModuleType.ImpactProduct,\r\n    name: \"\",\r\n    notes: \"\",\r\n    otherfees: 0,\r\n    quantity: 1,\r\n    sales_discount: 0,\r\n    sales_price: 0,\r\n    wintype: WinType.None,\r\n}","import ItemType from \"../types/ItemType\";\r\nimport ModuleType from \"../types/ModuleType\";\r\nimport { CustomerDetails, reltype2Markup } from \"./customersSlice\";\r\nimport { Estimate } from './Estimate';\r\nimport { DefaultEstimateItem, EstimateItem } from \"./EstimateItem\";\r\n\r\nexport interface MaterialTotals {\r\n    sales_price: number // unit cost_price plus markup\r\n    finalprice: number // total sales_prices plus installation minus discounts\r\n}\r\n\r\nexport interface Material extends EstimateItem {\r\n    height?: number\r\n    heighttxt?: string\r\n    length?: number\r\n    lengthtxt?: string\r\n    product_ref?:string\r\n    provider?:string\r\n    width?: number\r\n    widthtxt?: string\r\n}\r\n\r\nexport const DefaultMaterial:Material = {\r\n    ...DefaultEstimateItem,\r\n    itemtype: ItemType.Hardware,\r\n    modtype: ModuleType.Material\r\n}\r\n\r\nexport const createItemTotals = (e:Estimate, i:Material|undefined, c:CustomerDetails|undefined):MaterialTotals => {\r\n    if (i) {\r\n        const sales_price = Math.round(\r\n            ((i.cost_price||0)\r\n              + (i.cost_price||0) * reltype2Markup(c?.reltype))*100)/100\r\n    \r\n        const unit_finalprice = \r\n            sales_price\r\n            - (i.cost_price||0) * (i.sales_discount||0)\r\n            + (e.is_installation_included ? (i.inst_price||0) - (i.inst_price||0) * (i.inst_discount||0) : 0)\r\n        const finalprice =\r\n            unit_finalprice * (i.quantity||1)\r\n\r\n        return {\r\n            sales_price,\r\n            finalprice\r\n        }\r\n    }\r\n    \r\n    return {\r\n        sales_price:0,\r\n        finalprice:0\r\n    }\r\n}\r\n","import ItemType from \"../types/ItemType\";\r\nimport ModuleType from \"../types/ModuleType\";\r\nimport { CustomerDetails, reltype2Markup } from \"./customersSlice\";\r\nimport { Estimate } from './Estimate';\r\nimport { DefaultEstimateItem, EstimateItem } from \"./EstimateItem\";\r\n\r\nexport interface DesignTotals {\r\n    sales_price: number // unit cost_price plus markup\r\n    finalprice: number // total sales_prices plus installation minus discounts\r\n}\r\n\r\nexport interface Design extends EstimateItem {\r\n    height?: number\r\n    heighttxt?: string\r\n    product_ref?:string\r\n    provider?:string\r\n    width?: number\r\n    widthtxt?: string\r\n}\r\n\r\nexport const DefaultDesign:Design = {\r\n    ...DefaultEstimateItem,\r\n    itemtype: ItemType.Hardware,\r\n    modtype: ModuleType.Design\r\n}\r\n\r\nexport const createItemTotals = (e:Estimate, i:Design|undefined, c:CustomerDetails|undefined):DesignTotals => {\r\n    if (i) {\r\n        const sales_price = Math.round(\r\n            ((i.cost_price||0)\r\n            + (i.cost_price||0) * reltype2Markup(c?.reltype))*100)/100\r\n    \r\n        const finalprice = \r\n            sales_price\r\n            - (i.cost_price||0) * (i.sales_discount||0)\r\n            + (e.is_installation_included ? (i.inst_price||0) - (i.inst_price||0) * (i.inst_discount||0) : 0)\r\n        return {\r\n            sales_price,\r\n            finalprice\r\n        }\r\n    }\r\n    \r\n    return {\r\n        sales_price:0,\r\n        finalprice:0\r\n    }\r\n}\r\n","import ProductComponent, { ProductComponentProps } from './ProductComponent';\r\nimport { Material } from '../../store/Material';\r\n\r\nexport interface MaterialProps extends ProductComponentProps {\r\n    item: Material\r\n    readOnly: boolean\r\n}\r\n\r\nconst MaterialComponent = ({ item, ...rest }: MaterialProps) => {\r\n    return (\r\n        <ProductComponent\r\n            item={item} \r\n            description={\r\n                <>\r\n                    <p className='table_text'>Size: {item.widthtxt||\"?\"} x {item.heighttxt||\"?\"} x {item.lengthtxt||\"?\"}</p>\r\n                    <p className='table_text'>Color: {item.color}</p>\r\n                </>\r\n            }\r\n\r\n            {...rest}\r\n        />)\r\n};\r\n\r\nexport default MaterialComponent;\r\n\r\n","import ProductComponent, { ProductComponentProps } from './ProductComponent';\r\nimport { Design } from '../../store/Design';\r\n\r\nexport interface DesignProps extends ProductComponentProps {\r\n    item: Design\r\n    readOnly: boolean\r\n}\r\n\r\nconst DesignComponent = ({ item, ...rest }: DesignProps) => {\r\n    return (\r\n        <ProductComponent\r\n            item={item} \r\n            description={\r\n                <>\r\n                    <p className='table_text'>Size: {item.widthtxt||\"?\"} x {item.heighttxt||\"?\"}</p>\r\n                    <p className='table_text'>Color: {item.color}</p>\r\n                </>\r\n            }\r\n\r\n            {...rest}\r\n        />)\r\n};\r\n\r\nexport default DesignComponent;\r\n\r\n","import { useCallback, useEffect, useMemo, useState } from 'react';\r\nimport '../../Styles/main.css';\r\nimport { Typography, Divider, message, Collapse, notification, Row, Col, Button, Spin, Empty, Alert, Space, Tag, Menu, Dropdown } from 'antd';\r\nimport { useAppDispatch, useAppSelector } from '../../store/hooks';\r\nimport * as cs from '../../store/customersSlice';\r\nimport * as es from '../../store/estimatesSlice';\r\nimport * as ds from '../../store/defaultsSlice';\r\nimport { AppDispatch } from '../../store/store';\r\nimport { useHistory, useParams } from \"react-router-dom\";\r\nimport { History, LocationState } from 'history';\r\nimport ProductOptions from '../ModalOptions/ProductOptions';\r\nimport TotalsTable from '../Estimates/TotalsTable';\r\nimport ModuleType from '../../types/ModuleType';\r\nimport ImpactProductComponent from '../ProductSummary/ImpactProductComponent';\r\nimport HardwareComponent from '../ProductSummary/HardwareComponent';\r\nimport { Hardware } from '../../store/Hardware';\r\nimport { ImpactProduct } from '../../store/ImpactProduct';\r\nimport { EstimateItem } from '../../store/EstimateItem';\r\nimport { createEstimateTotals } from '../../store/EstimateTotals';\r\nimport { ProductButtons } from '../ProductSummary/ProductComponent';\r\nimport { isDeleted, isModified, LoadingState, ModifiedState } from '../../types/Status';\r\nimport { createDefaultEstimate, Estimate, formatDate, isDirty } from '../../store/Estimate';\r\nimport { AuditOutlined, CopyOutlined, DownOutlined, PlusOutlined, SaveOutlined, SyncOutlined, WarningOutlined } from '@ant-design/icons';\r\nimport { EstimateProblem, validateEstimate } from '../../store/validations';\r\nimport { asMoney } from \"../../types/formats\";\r\nimport TextArea from 'antd/lib/input/TextArea';\r\nimport useModifiedAlert from '../../effects/useModifiedAlert';\r\nimport EstimateOptions from '../Estimates/EstimateOptions';\r\nimport { EstimateStatus, isNotInProgress, isReadOnly, isRejected, status2color, string2status } from '../../types/EstimateStatus';\r\nimport MenuItem from 'antd/lib/menu/MenuItem';\r\nimport Initial from './Initial';\r\nimport { useAppRoutes } from '../../routes';\r\nimport CompactCustomerData from './CompactCustomerData';\r\nimport TwoColumnTotalsTable from './TwoColumnTotalsTable';\r\nimport { createItemTotals as createMaterialItemTotals, Material } from '../../store/Material';\r\nimport { createItemTotals as createDesignItemTotals, Design } from '../../store/Design';\r\nimport MaterialComponent from '../ProductSummary/MaterialComponent';\r\nimport DesignComponent from '../ProductSummary/DesignComponent';\r\n\r\nconst { Title, Text } = Typography;\r\n\r\nconst isLoading = (statuses: any): boolean => {\r\n    if (!isFailed(statuses)) { // False if something failed\r\n        for (const key in statuses) {\r\n            if (statuses[key] === LoadingState.loading)\r\n                return true;\r\n        }\r\n    }\r\n    return false;\r\n}\r\n\r\nconst isFailed = (statuses: any): boolean => {\r\n    for (const key in statuses) {\r\n        if (statuses[key] === LoadingState.failed)\r\n            return true;\r\n    }\r\n    return false;\r\n}\r\n\r\nconst isLoaded = (statuses: any): boolean => {\r\n    for (const key in statuses) {\r\n        if (![LoadingState.succeeded, LoadingState.unavailable, LoadingState.saving, \"\"].includes(statuses[key]))\r\n            return false;\r\n    }\r\n    return true;\r\n}\r\n\r\nconst handleResult = (res:any, title:string, history:History<LocationState>) => {\r\n    if (res.error) {\r\n        console.error(res.error)\r\n        notification.error({\r\n            message: title,\r\n            description: res.error.message,\r\n            duration: 10\r\n        })\r\n    }\r\n    else {\r\n        if (res.payload?.id)\r\n            history.replace(`/${res.payload.id}`)\r\n        notification.success({\r\n            message: title,\r\n            description: \"Success!\",\r\n            duration: 10\r\n        })\r\n    }\r\n}\r\n\r\nconst onSave = (dispatch: AppDispatch, estimate: Estimate|undefined, history:History<LocationState>) => {\r\n    if (estimate) {\r\n        if (!estimate.id)\r\n            dispatch(es.saveEstimate(estimate)).then((res:any)=> handleResult(res, \"Create Estimate\", history))\r\n        else\r\n            dispatch(es.saveEstimate(estimate)).then((res:any)=> handleResult(res, \"Save Estimate\", history))\r\n    }\r\n}\r\n\r\nconst onDelete = (event:any, dispatch: AppDispatch, estimate: Estimate, item:EstimateItem) => {\r\n    dispatch(es.deleteItem(item))\r\n    event && event.stopPropagation()\r\n}\r\n\r\nconst onCopy = (event:any, dispatch: AppDispatch, estimate: Estimate, item:EstimateItem) => {\r\n    dispatch(es.copyItem(item))\r\n    event && event.stopPropagation()\r\n}\r\n\r\ntype RenderProductProps = {\r\n    item: EstimateItem\r\n    readOnly: boolean\r\n}\r\n\r\ninterface ParamTypes {\r\n    eid: string\r\n}\r\n\r\nlet showingError: string = \"\";\r\n\r\ninterface MainProps {\r\n    viewMenu: (eid:number) => JSX.Element\r\n    readOnly: boolean\r\n} \r\n\r\nconst Main = ({viewMenu, readOnly}:MainProps) => {\r\n    // Data Access\r\n    const dispatch = useAppDispatch();\r\n    const customerNames: cs.CustomerName[] | undefined = useAppSelector(cs.selectCustomerNames)\r\n    const customerDetailsMap = useAppSelector(cs.selectCustomerDetails)\r\n    const defaults: ds.DefaultData | undefined = useAppSelector(ds.selectDefaults)\r\n    const id2RoomType:ds.RoomTypeConverterFunction = useAppSelector(ds.selectId2RoomTypeConvertor)\r\n    const roomType2Id:ds.RoomTypeConverterFunction = useAppSelector(ds.selectRoomType2IdConvertor)\r\n    const estimate: Estimate | undefined = useAppSelector(es.selectEstimate)\r\n    var params = useParams<ParamTypes>();\r\n    const [showProductOptions, setShowProductOptions] = useState<boolean>(false)\r\n    const history = useHistory();\r\n    const [problems, setWarnings] = useState<EstimateProblem[]>([]);\r\n    const [expandedItems, setExpandedItems] = useState<string | string[]>([]);\r\n\r\n    const status_customer = useAppSelector(cs.selectCustomerNamesStatus)\r\n    const status_customerDetail = useAppSelector(cs.selectCustomerDetailsStatus)\r\n    const status_estimate = useAppSelector(es.selectEstimateStatus)\r\n    const status_estimateError = useAppSelector(es.selectEstimateError)\r\n    const status_default = useAppSelector(ds.selectDefaultsStatus)\r\n\r\n    // Status collection\r\n    const statuses = useMemo(() => ({\r\n       customer: status_customer,\r\n       customerDetail: status_customerDetail,\r\n       estimate: status_estimate,\r\n       estimateError: status_estimateError,\r\n       default: status_default\r\n    }), [status_customer, status_customerDetail, status_default, status_estimate, status_estimateError])\r\n\r\n    if (isFailed(statuses) && showingError === \"\") {\r\n        showingError = statuses.estimateError\r\n        message.error(statuses.estimateError, undefined, () => {\r\n            showingError = \"\"\r\n        });\r\n    }\r\n\r\n    const onDuplicate = (dispatch: AppDispatch, estimate: Estimate|undefined, history:History<LocationState>) => {\r\n        if (estimate && estimate.id) {\r\n            dispatch(es.duplicateEstimate({ ...estimate, vendor: defaults?.user?.name, vendor_phone: defaults?.user?.phone }))\r\n            history.replace(`/`)\r\n            notification.success({\r\n                message: \"Estimate cloned\",\r\n                description: \"Success!\",\r\n                duration: 10\r\n            })\r\n        }\r\n    }\r\n    \r\n    // Customer details\r\n    const [customerId, setCustomerId] = useState<number | undefined>(undefined)\r\n    let customer: cs.CustomerDetails | undefined = undefined;\r\n    if (customerDetailsMap && customerId && customerDetailsMap[customerId]) {\r\n        customer = customerDetailsMap[customerId]\r\n    }\r\n\r\n    useEffect(() => {\r\n        if (customer && estimate !== undefined && (estimate?.customer === undefined || estimate?.customer?.id !== customer?.id))\r\n            dispatch(es.updateEstimate({ ...estimate, customer: customer, customerid: Number(customer?.id) }))\r\n    }, [customer, estimate, dispatch])\r\n\r\n    // Data retrieval\r\n    useEffect(() => {\r\n        if (estimate === undefined && defaults?.user.name) {\r\n            // If we know the id then load the estimate\r\n            if (params.eid)\r\n                dispatch(es.fetchEstimate(Number(params.eid)))\r\n            else\r\n                dispatch(es.createEstimate(createDefaultEstimate(defaults.user.name, defaults.user.phone, 0)))\r\n        }\r\n    }, [dispatch, params.eid, estimate, defaults?.user.name, defaults?.user.phone])\r\n\r\n    useEffect(() => {\r\n        if (customerNames === undefined || customerNames.length === 0)\r\n            dispatch(cs.fetchCustomerNames())\r\n    }, [dispatch, customerNames])\r\n\r\n    useEffect(() => {\r\n        if (defaults?.colors.length === 0)\r\n            dispatch(ds.fetchDefaults())\r\n    }, [dispatch, defaults])\r\n\r\n    useEffect(() => {\r\n        if (customerId)\r\n            dispatch(cs.fetchCustomerDetailsById(customerId))\r\n    }, [dispatch, customerId])\r\n\r\n    // Validation\r\n    useEffect(() => {\r\n        if (estimate)\r\n            setWarnings(validateEstimate(estimate, {id2RoomType, roomType2Id}))\r\n    }, [dispatch, estimate, id2RoomType, roomType2Id])\r\n\r\n    useModifiedAlert(estimate)\r\n\r\n    const handleAddProduct = (event:any, index:number|undefined) => {\r\n        event && event.stopPropagation()\r\n        setShowProductOptions(true);\r\n    }\r\n\r\n    const addImpactProduct = () => {\r\n        setShowProductOptions(false)\r\n        if (estimate && estimate.id)\r\n            history.push(`/impact/${estimate.id}`)\r\n        else\r\n            history.push(`/impact`)\r\n    }\r\n\r\n    const addHardware = () => {\r\n        setShowProductOptions(false)\r\n        if (estimate && estimate.id)\r\n            history.push(`/hardware/${estimate.id}`)\r\n        else\r\n            history.push(`/hardware`)\r\n    }\r\n\r\n    const addMaterial = () => {\r\n        setShowProductOptions(false)\r\n        if (estimate && estimate.id)\r\n            history.push(`/material/${estimate.id}`)\r\n        else\r\n            history.push(`/material`)\r\n    }\r\n\r\n    const addDesign = () => {\r\n        setShowProductOptions(false)\r\n        if (estimate && estimate.id)\r\n            history.push(`/design/${estimate.id}`)\r\n        else\r\n            history.push(`/design`)\r\n    }\r\n\r\n    const handleEdit = (event:any, item:EstimateItem) => {\r\n        event && event.stopPropagation()\r\n        switch(item.modtype) {\r\n            case ModuleType.ImpactProduct:\r\n                history.push(`/impact/${estimate?.id}/${item.id}`)\r\n                break\r\n            case ModuleType.Hardware:\r\n                history.push(`/hardware/${estimate?.id}/${item.id}`)\r\n                break\r\n            case ModuleType.Material:\r\n                history.push(`/material/${estimate?.id}/${item.id}`)\r\n                break\r\n            case ModuleType.Design:\r\n                history.push(`/design/${estimate?.id}/${item.id}`)\r\n                break\r\n        }\r\n    }\r\n    \r\n    const onChangeCustomer = (customeridStr: string) => {\r\n        try {\r\n            let cid = Number(customeridStr)\r\n            setCustomerId(cid)\r\n            if (estimate === undefined)\r\n                dispatch(es.updateEstimate(createDefaultEstimate(defaults?.user?.name||\"\", defaults?.user?.phone||\"\", cid)))\r\n            else {\r\n                dispatch(es.updateEstimate({ ...estimate, customerid: cid }))\r\n            }\r\n        }\r\n        catch (err) {\r\n            console.error(err)\r\n        }\r\n    }\r\n\r\n    const onChangeInternalNotes = (notes: string) => {\r\n        if (estimate !== undefined)\r\n            dispatch(es.updateEstimate({ ...estimate, notes }))\r\n    }\r\n\r\n    const onChangePublicNotes = (notes: string) => {\r\n        if (estimate !== undefined)\r\n            dispatch(es.updateEstimate({ ...estimate, public_notes: notes }))\r\n    }\r\n\r\n    let handlers:any = null\r\n    if (estimate)\r\n        handlers = { \r\n            onAdd: (e:any, index:number) => estimate && handleAddProduct(e, index),\r\n            onEdit: (e:any, item:EstimateItem) => estimate && handleEdit(e, item),\r\n            onDelete: (e:any, item:EstimateItem) => estimate && onDelete(e, dispatch, estimate, item),\r\n            onCopy: (e:any, item:EstimateItem) => estimate && onCopy(e, dispatch, estimate, item),\r\n        }\r\n\r\n    const RenderProduct = useCallback(({item, readOnly}:RenderProductProps) => {\r\n        const updateItemNo = (val:number) => \r\n            dispatch(es.updateItem({ ...item, itemno: val }))\r\n        const updateQuantity = (val:number) => \r\n            dispatch(es.updateItem({ ...item, quantity: val || 1, finalprice: item.sales_price }))\r\n        if (handlers && estimate) {\r\n            switch(item.modtype) {\r\n                case ModuleType.ImpactProduct:\r\n                    return (<ImpactProductComponent readOnly={readOnly} e={estimate} item={item as ImpactProduct} onUpdateQuantity={updateQuantity} onUpdateItemNo={updateItemNo}/> )\r\n                case ModuleType.Hardware:\r\n                    return (<HardwareComponent readOnly={readOnly} e={estimate} item={item as Hardware} onUpdateQuantity={updateQuantity} onUpdateItemNo={updateItemNo}/>)\r\n                case ModuleType.Material:\r\n                    return (<MaterialComponent readOnly={readOnly} e={estimate} item={item as Material} onUpdateQuantity={\r\n                            val => {\r\n                                val = val || 1\r\n                                let updatedItem = { ...item, quantity: val }\r\n                                updatedItem = { ...updatedItem, finalprice: createMaterialItemTotals(estimate,updatedItem,estimate.customer).finalprice }\r\n                                dispatch(es.updateItem(updatedItem))\r\n                            }\r\n                        } onUpdateItemNo={updateItemNo} /> )\r\n                case ModuleType.Design:\r\n                    return (<DesignComponent readOnly={readOnly} e={estimate} item={item as Design} onUpdateQuantity={\r\n                            val => {\r\n                                val = val || 1\r\n                                let updatedItem = { ...item, quantity: val }\r\n                                updatedItem = { ...updatedItem, finalprice: createDesignItemTotals(estimate,updatedItem,estimate.customer).finalprice }\r\n                                dispatch(es.updateItem(updatedItem))\r\n                            }\r\n                        } onUpdateItemNo={updateItemNo} /> )\r\n            }\r\n        }\r\n        return <span>Unknown Product: {item.modtype}</span>\r\n    }, [dispatch, estimate, handlers])\r\n\r\n    const shouldSave = ():boolean => {\r\n        return !!(estimate && estimate.customerid && (\r\n            isModified(estimate._modified) || \r\n            (estimate.items !== undefined && estimate.items.some(i => isModified(i._modified)))) )\r\n    }\r\n\r\n    const getHeaderFromItem = useCallback((item:EstimateItem) => {\r\n        let txt = `Opening ${item.itemno}: ${item.name}`\r\n        if (item.modtype === ModuleType.ImpactProduct) {\r\n            let ip:ImpactProduct = item as ImpactProduct\r\n            let roomtype = id2RoomType(ip.roomtype?.toString())\r\n            if (!roomtype || roomtype === \"Unknown\")\r\n                roomtype = \"Room\"\r\n            txt += ` - ${roomtype} ${ip.roomnum ?? \" number missing\"}`\r\n        }\r\n\r\n        return (\r\n            <div className=\"item-summary-header\">\r\n                <div className=\"product-title\">{txt}</div>\r\n                <div className=\"product-price\">{asMoney((item.sales_price||0)*(item.quantity||1))}</div>\r\n            </div>\r\n        )\r\n    }, [id2RoomType])\r\n\r\n    readOnly = readOnly || isReadOnly(estimate)\r\n    const statusReadOnly = readOnly && !isModified(estimate?._modified || ModifiedState.modified)\r\n    const remainingItems = estimate?.items?.filter(i => !isDeleted(i._modified))\r\n    let itemsList = useMemo(() => {\r\n        let itemsList:React.ReactNode|null = null\r\n        if (isLoading(statuses))\r\n            itemsList = <div className='flex_container_center show4'><Spin style={{ marginLeft: \"1rem\", display: \"flex\", alignSelf: \"center\" }} size=\"large\" /></div>\r\n        if (isFailed(statuses))\r\n            itemsList = <div className='flex_container_center show4'><WarningOutlined style={{ marginLeft: \"1rem\", display: \"flex\", alignSelf: \"center\" }} /></div>\r\n        if (isLoaded(statuses)) {\r\n            if (remainingItems === undefined || remainingItems.length === 0) \r\n                itemsList = <div className='flex_container_center show4'><Empty image={Empty.PRESENTED_IMAGE_SIMPLE} description=\"Empty\" style={{margin: \"0px\"}}/></div>\r\n            else\r\n                itemsList = <Collapse activeKey={expandedItems} onChange={(items) => setExpandedItems(items)} >\r\n                        {\r\n                            remainingItems\r\n                                .sort((a,b) => (a.itemno??0) - (b.itemno??0))\r\n                                .map((item, index) => \r\n                                <Collapse.Panel className=\"item-summary\" header={getHeaderFromItem(item)} key={index} extra={<ProductButtons readOnly={readOnly} item={item} itemIndex={index+1} {...handlers} />}>\r\n                                    <RenderProduct item={item} readOnly={readOnly} />\r\n                                </Collapse.Panel>)\r\n                        }\r\n                    </Collapse>\r\n        }\r\n        return itemsList\r\n    }, [RenderProduct, expandedItems, getHeaderFromItem, handlers, readOnly, remainingItems, statuses])\r\n\r\n    const rejection_reason_missing = \"No reason specified\"\r\n    const rejection_reason_tip = \"Click here to edit reason for rejection\"\r\n\r\n    const updateEstimateStatus = (s:string) => {\r\n        const status:EstimateStatus = string2status(s)\r\n        if (estimate && estimate.status !== status) {\r\n            const updatedEstimate = {...estimate,status}\r\n            const date = formatDate(new Date())\r\n            switch(status) {\r\n                case EstimateStatus.Approved: {\r\n                    updatedEstimate.approved_date = date\r\n                    break;\r\n                }\r\n                case EstimateStatus.Rejected: {\r\n                    updatedEstimate.rejected_date = date\r\n                    break;\r\n                }\r\n                case EstimateStatus.Delivered: {\r\n                    updatedEstimate.delivered_date = date\r\n                    break;\r\n                }\r\n            }\r\n            dispatch(es.updateEstimate(updatedEstimate))\r\n        }\r\n    }\r\n    const estimateStatusDate = (() => {\r\n        switch(estimate?.status) {\r\n            case EstimateStatus.Approved: return estimate?.approved_date\r\n            case EstimateStatus.Rejected: return estimate?.rejected_date\r\n            case EstimateStatus.Delivered: return estimate?.delivered_date\r\n            default: return undefined\r\n        }\r\n    })()\r\n\r\n    const statusMenu = (\r\n        <Menu>\r\n            {Object.keys(EstimateStatus).map((s,i) => <MenuItem key={i} onClick={() => updateEstimateStatus(s) }>{s}</MenuItem>)}\r\n        </Menu>)\r\n\r\n    const totals = createEstimateTotals(estimate, estimate?.add_sales_discount||0, estimate?.add_inst_discount||0, estimate?.permits||0, estimate?.salestax||0)\r\n    if (estimate && totals.finalPrice !== estimate.totalprice)\r\n        setTimeout(() => dispatch(es.updateEstimate({...estimate, totalprice: totals.finalPrice})), 0)\r\n\r\n    const appRoutes = useAppRoutes()\r\n    const customerData = appRoutes.canPrint() \r\n        ? <CompactCustomerData \r\n            estimate={estimate}\r\n            isFailed={isFailed(statuses)}\r\n        />\r\n        : <Initial \r\n            estimate={estimate}\r\n            customerNames={customerNames}\r\n            onChangeCustomer={onChangeCustomer}\r\n            onUpdateEstimate={(e:Estimate) => dispatch(es.updateEstimate(e))}\r\n            isLoading={isLoading(statuses)}\r\n            isFailed={isFailed(statuses)}\r\n            defaults={defaults}\r\n            readOnly={readOnly}\r\n        />\r\n\r\n    const totalsTable = appRoutes.canPrint() \r\n        ? <TwoColumnTotalsTable \r\n            totals={totals} \r\n            includeInstallation={estimate?.is_installation_included || false}\r\n        />\r\n        : <TotalsTable \r\n            totals={totals} \r\n            onChangeAdditionalDiscountProductsPercentage={(val:number) => estimate && dispatch(es.updateEstimate({...estimate, add_sales_discount: val}))}\r\n            onChangeAdditionalDiscountInstallPercentage={(val:number) => estimate && dispatch(es.updateEstimate({...estimate, add_inst_discount: val}))}\r\n            onChangePermits={(val:number) => estimate && dispatch(es.updateEstimate({...estimate, permits: val}))}\r\n            onChangeSalesTax={(val:number) => estimate && dispatch(es.updateEstimate({...estimate, salestax: val}))}\r\n            includeInstallation={estimate?.is_installation_included || false}\r\n            readOnly={readOnly}\r\n        />\r\n\r\n    return (\r\n        <>\r\n            <Row>\r\n                <Col xs={24}>\r\n                    <Title level={3} style={{ color: '#32445e', textAlign:\"center\", float: \"left\", width: \"100%\" }}>Estimate</Title>\r\n                    {estimate && estimate.id && viewMenu(estimate.id)}\r\n                </Col>\r\n                <Col xs={24}>\r\n\r\n                    <Text className=\"hide-on-print\">State:</Text>\r\n                    <Dropdown overlay={statusMenu} disabled={statusReadOnly} className=\"hide-on-print\">\r\n                        <Tag style={{ margin: \"1em 0em 2.3em 2em\" }} color={status2color(string2status(estimate?.status))}>{estimate?.status} <DownOutlined /></Tag>\r\n                    </Dropdown>\r\n\r\n                    {estimateStatusDate && (\r\n                        <Text style={{margin: \"1em .5em 2em 1em\"}} className=\"hide-on-print\">\r\n                                    Date: {estimateStatusDate}\r\n                        </Text>)}\r\n\r\n                    {isRejected(estimate?.status) ? <>\r\n                        <Text style={{margin: \"1em .5em 2em 1em\"}} className=\"hide-on-print\">\r\n                                Reason:\r\n                        </Text>\r\n                        <Text style={{margin: \"1em 2em 2em 0em\", width: \"20em\"}} className=\"hide-on-print\" editable={!statusReadOnly && { \r\n                                triggerType:[\"text\"], \r\n                                onChange: val => {\r\n                                    let newReason:string|undefined = val;\r\n                                    if (newReason === rejection_reason_tip)\r\n                                        newReason = undefined\r\n                                    estimate && dispatch(es.updateEstimate({...estimate, status_reason: newReason}))\r\n                                }\r\n                            }}>\r\n                                {estimate?.status_reason || (statusReadOnly ? rejection_reason_missing : rejection_reason_tip )}\r\n                        </Text>\r\n                    </> : \"\"}\r\n                </Col>\r\n            </Row>\r\n           \r\n            {customerData}\r\n\r\n            <Row id=\"add-save-buttons\">\r\n                <Col xs={24} sm={24} md={24} lg={24} xl={24}>\r\n                    <div className='flex_container_end show4'>\r\n                        <Button type=\"primary\" shape=\"round\" icon={<PlusOutlined />} size='large' onClick={() => handleAddProduct(null, 0)} disabled={isNotInProgress(estimate?.status) || !estimate?.customerid || !estimate.id}>Add Product</Button>\r\n                        <Button type=\"primary\" shape=\"round\" icon={statuses.estimate === LoadingState.saving ? <SyncOutlined spin /> : <SaveOutlined /> } size='large' style={{ marginLeft: \"2rem\" }} onClick={() => onSave(dispatch, estimate, history)} disabled={!shouldSave()}>Save</Button>\r\n                        <Button type=\"primary\" shape=\"round\" icon={<CopyOutlined />} size='large' style={{ marginLeft: \"2rem\" }} onClick={() => onDuplicate(dispatch, estimate, history)} disabled={estimate&&isDirty(estimate)}>Clone</Button>\r\n                        {!estimate?.permitId?<Button type=\"primary\" shape=\"round\" icon={<AuditOutlined />} size='large' style={{ marginLeft: \"2rem\" }} onClick={() => window.open(\"../../amhppermits/buildingpermit_card.php?eid=\"+estimate?.id+\"&action=createFromEID&mainmenu=amhppermits\", \"_self\")} disabled={!estimate||!estimate.id}>Create Permit</Button>:\"\"}\r\n                        {estimate?.permitId?<Button type=\"primary\" shape=\"round\" icon={<AuditOutlined />} size='large' style={{ marginLeft: \"2rem\" }} onClick={() => window.open(\"../../amhppermits/buildingpermit_card.php?id=\"+estimate?.permitId+\"&mainmenu=amhppermits\", \"_self\")} disabled={!estimate||!estimate.id}>Show Permit</Button>:\"\"}\r\n                     </div>\r\n                </Col>\r\n            </Row>\r\n\r\n            <Row>\r\n                <Col xs={24} sm={24} md={24} lg={24} xl={24}>\r\n                    <Divider />\r\n                    \r\n                    <div className=\"expand-collapse-buttons\"><Button type=\"link\" onClick={() => setExpandedItems(remainingItems?remainingItems?.map((item, index) => index.toString()):[])}>Expand all</Button> | <Button type=\"link\" onClick={() => setExpandedItems([])}>Collapse all</Button></div>\r\n                    {itemsList}\r\n\r\n                    <Divider />\r\n\r\n                    {problems && problems.length && problems.length>0 ? problems.map((w,i)=>\r\n                        <Alert\r\n                            message={w.type.toUpperCase()}\r\n                            description={w.msg}\r\n                            type={w.type}\r\n                            action={w.link && \r\n                                <Space>\r\n                                    <Button size=\"small\" type=\"ghost\">\r\n                                    Open Item\r\n                                    </Button>\r\n                                </Space>\r\n                                }\r\n                            showIcon\r\n                            className=\"hide-on-print\"\r\n                            style={{\"marginBottom\": \"2rem\"}}\r\n                            key={i}\r\n                        />) : \"\"\r\n                    }\r\n\r\n                    {estimate?.notes ? \r\n                        <>\r\n                            <Title className=\"hide-on-print\" level={5}>Internal Notes:</Title>\r\n                            <TextArea \r\n                                placeholder=\"Notes\" \r\n                                className=\"hide-on-print\"\r\n                                style={{\"marginBottom\": \"2rem\"}}\r\n                                autoSize \r\n                                maxLength={1024}\r\n                                onChange={e => onChangeInternalNotes(e.target.value)}\r\n                                value={estimate?.notes}\r\n                                readOnly={readOnly}\r\n                            />\r\n                        </> : \"\"}\r\n\r\n                    {estimate?.public_notes ? \r\n                        <>\r\n                            <Title level={5}>Additional Notes:</Title>\r\n                            <TextArea \r\n                                placeholder=\"Notes\" \r\n                                style={{\"marginBottom\": \"2rem\"}}\r\n                                autoSize \r\n                                maxLength={1024}\r\n                                onChange={e => onChangePublicNotes(e.target.value)}\r\n                                value={estimate?.public_notes}\r\n                                readOnly={readOnly}\r\n                            />\r\n                        </> : \"\"}\r\n                </Col>\r\n            </Row>\r\n\r\n            {totalsTable}\r\n\r\n            <Divider />\r\n\r\n            <Row>\r\n                <Col xs={24} sm={24} md={24} lg={24} xl={24}>\r\n                    <EstimateOptions readOnly={readOnly} />\r\n                </Col>\r\n            </Row>\r\n\r\n            <ProductOptions \r\n                visible={showProductOptions} \r\n                handleCancel={() => setShowProductOptions(false)} \r\n                handleImpactProduct={addImpactProduct} \r\n                handleHardware={addHardware} \r\n                handleMaterial={addMaterial} \r\n                handleDesign={addDesign} \r\n            />\r\n\r\n            <Space direction=\"vertical\" align=\"center\" style={{width: \"100%\", marginTop: \"1rem\"}} className=\"show-on-print\">\r\n                <Alert\r\n                    description={\r\n                        <>\r\n                            <Title level={5} style={{color: \"red\"}}>\r\n                                There will be a 3% charge for using a credit card<br/>\r\n                                This price is valid for 30 days\r\n                            </Title>\r\n                        </>\r\n                    }\r\n                    type=\"info\"\r\n                    style={{textAlign: \"center\", backgroundColor: \"white\", border: \"0\"}}\r\n                />\r\n            </Space>\r\n        </>\r\n    );\r\n};\r\n\r\nexport default Main","import { Layout } from \"antd\";\r\nimport { Content } from \"antd/lib/layout/layout\";\r\nimport Main from \"../Components/Estimates/Main\";\r\n\r\ninterface EditProps {\r\n    viewMenu: (eid:number) => JSX.Element\r\n} \r\n\r\n/** Default view for editing Estimate */\r\nconst Home = ({viewMenu}:EditProps) => {\r\n    return (\r\n        <Layout className={\"home\"}>\r\n            <Content className='estimateContainer'>\r\n                <Main readOnly={false} viewMenu={viewMenu}/>\r\n            </Content>\r\n        </Layout>\r\n    )\r\n}\r\n\r\nexport default Home","export default __webpack_public_path__ + \"static/media/logo.cbd6aea3.png\";","import { Col, Image, Row, Space, Typography } from \"antd\"\r\nimport * as ds from '../../store/defaultsSlice';\r\nimport { Estimate } from \"../../store/Estimate\";\r\nimport * as es from '../../store/estimatesSlice';\r\nimport { useAppSelector } from \"../../store/hooks\";\r\nimport { formatPhone } from \"../../types/formats\";\r\nimport logo from \"./img/logo.png\"\r\n\r\nconst { Paragraph, Text, Title } = Typography\r\n\r\nconst PrintHeader = () => {\r\n    const defaults: ds.DefaultData | undefined = useAppSelector(ds.selectDefaults)\r\n    const estimate: Estimate | undefined = useAppSelector(es.selectEstimate)\r\n\r\n    let phone1 = estimate?.vendor_phone\r\n    let phone2 = defaults?.company.phone\r\n\r\n    if (!phone1) {\r\n      phone1 = defaults?.company.phone\r\n      phone2 = defaults?.company.fax\r\n    }\r\n    \r\n\r\n    return (<Row gutter={16} align=\"middle\">\r\n      <Col className=\"gutter-row\" span={5}>\r\n        <Image\r\n            src={logo}\r\n//            fallback=\"data:image/png;base64,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\"\r\n        />\r\n      </Col>\r\n      <Col className=\"gutter-row\" span={14}>\r\n        <Space size={[0, 0]} direction=\"vertical\" align=\"center\" style={{width: \"100%\"}}>\r\n            <Title level={4} style={{whiteSpace:\"nowrap\", marginBottom: \"0em\"}}>{defaults?.company.name}</Title>\r\n            <Text style={{whiteSpace:\"nowrap\", fontSize: \".8em\"}}>{defaults?.company.address}, {defaults?.company.town}, {defaults?.company.state}, {defaults?.company.zip}</Text>\r\n            <Paragraph style={{whiteSpace:\"nowrap\"}}>\r\n            <Text strong style={{fontSize: \"1em\"}}>Salesperson:</Text>\r\n            <Text strong style={{marginLeft: \"1em\", fontSize: \"1em\"}}>{formatPhone(phone1)}</Text>\r\n            <Text strong style={{marginLeft: \"3em\", fontSize: \"1em\"}}>Head Office:</Text>\r\n            <Text strong style={{marginLeft: \"1em\", fontSize: \"1em\"}}>{formatPhone(phone2)}</Text>\r\n            </Paragraph>\r\n        </Space>\r\n      </Col>\r\n      <Col className=\"gutter-row\" span={5}>\r\n        \r\n      </Col>\r\n    </Row>)\r\n}\r\n\r\nexport default PrintHeader","import { Layout } from \"antd\";\r\nimport { Content } from \"antd/lib/layout/layout\";\r\nimport Main from \"../Components/Estimates/Main\";\r\nimport PrintHeader from \"../Components/Estimates/PrintHeader\";\r\n\r\ninterface EstimateProps {\r\n    viewMenu: (eid:number) => JSX.Element\r\n} \r\n\r\nconst EstimateView = ({viewMenu}:EstimateProps) => {\r\n    return (\r\n        <Layout className={\"print-estimate\"}>\r\n            <Content className='estimateContainer'>\r\n                <PrintHeader />\r\n                <Main readOnly={true} viewMenu={viewMenu}/>\r\n            </Content>\r\n        </Layout>\r\n    );\r\n};\r\n\r\nexport default EstimateView","import ItemType from \"../types/ItemType\";\r\nimport ModuleType from \"../types/ModuleType\";\r\nimport WinType from \"../types/WinType\";\r\nimport { CustomerDetails, reltype2Markup } from \"./customersSlice\";\r\nimport { Estimate } from './Estimate';\r\nimport { DefaultEstimateItem, EstimateItem } from \"./EstimateItem\";\r\n\r\nexport interface ImpactProductTotals {\r\n    finalprice: number\r\n    sales_price: number\r\n}\r\n\r\nexport interface ImpactProduct extends EstimateItem {\r\n    coating?:string\r\n    colonial_across?:number\r\n    colonial_down?:number\r\n    colonial_fee?:number\r\n    configuration?:string\r\n    frame_color?:string\r\n    glass_color?:string\r\n    glass_type?:string\r\n    height?: number\r\n    heighttxt?: string\r\n    interlayer?:string\r\n    is_colonial?:boolean\r\n    is_def_color?:boolean\r\n    is_def_glass_color?:boolean\r\n    is_screen?:boolean\r\n    is_standard?:boolean\r\n    length?: number\r\n    lengthtxt?: string\r\n    product_ref?:string\r\n    provider?:string\r\n    room_description?:string\r\n    roomnum?:number\r\n    roomtype?:number\r\n    floornum?:number\r\n    width?: number\r\n    widthtxt?: string\r\n}\r\n\r\nexport const DefaultImpactProduct:ImpactProduct = {\r\n    ...DefaultEstimateItem,\r\n    colonial_across:0,\r\n    colonial_down:0,\r\n    colonial_fee:0,\r\n    is_colonial:false,\r\n    is_def_color:true,\r\n    is_def_glass_color:true,\r\n    is_screen:false,\r\n    is_standard:true,\r\n    itemtype: ItemType.Window,\r\n    modtype: ModuleType.ImpactProduct,\r\n    room_description:\"\",\r\n    roomnum:1,\r\n    floornum:1,\r\n    wintype: WinType.SingleHungSeries,\r\n}\r\n\r\nexport const createItemTotals = (e:Estimate, i:ImpactProduct|undefined, c:CustomerDetails|undefined):ImpactProductTotals => {\r\n    if (i) {\r\n        const sales_price = Math.round(\r\n            ((i.cost_price||0)\r\n            + (i.cost_price||0) * reltype2Markup(c?.reltype))*100)/100\r\n    \r\n        const finalprice = \r\n            sales_price\r\n            - (i.cost_price||0) * (i.sales_discount||0)\r\n            + (e.is_installation_included ? (i.inst_price||0) - (i.inst_price||0) * (i.inst_discount||0) : 0)\r\n            + (i.is_colonial ? (i.colonial_fee||0) : 0)\r\n        return {\r\n            sales_price,\r\n            finalprice\r\n        }\r\n    }\r\n    \r\n    return {\r\n        sales_price:0,\r\n        finalprice:0\r\n    }\r\n}\r\n","import Fraction from \"fraction.js\"\r\nimport { itemType2Id } from \"../../types/ItemType\"\r\nimport ModuleType from \"../../types/ModuleType\"\r\nimport WinType from \"../../types/WinType\"\r\nimport { ProductDetails, ProductSummary } from \"../productsSlice\"\r\n\r\nexport const ProductSummaries:ProductSummary[] = [\r\n  { \r\n    \"color\": \"BRONZE\", \r\n    \"heighttxt\": \"25 3/4\",\r\n    \"lengthtxt\": \"2 1/4\",\r\n    \"id\": 522, \r\n    \"itemtype\": 1, \r\n    \"modtype\": ModuleType.ImpactProduct,\r\n    \"glass_color\": \"BRONZE\",\r\n    \"interlayer\": \"CLEAR\",\r\n    \"wintype\": WinType.SingleHungSeries,\r\n    \"name\": \"MyImpactProduct1\", \r\n    \"provider\": \"ECO WINDOWS\", \r\n    \"ref\": \"MyImpactProduct1\", \r\n    \"widthtxt\": \"105 3/4\", \r\n  }, \r\n  { \r\n    \"color\": \"WHITE\", \r\n    \"heighttxt\": \"50 3/8\",\r\n    \"lengthtxt\": \"2 1/4\",\r\n    \"id\": 32, \r\n    \"itemtype\": 1, \r\n    \"modtype\": ModuleType.ImpactProduct,\r\n    \"glass_color\": \"BRONZE\",\r\n    \"interlayer\": \"CLEAR\",\r\n    \"wintype\": WinType.SingleHungSeries,\r\n    \"name\": \"MyImpactProduct2\", \r\n    \"provider\": \"ECO WINDOWS\", \r\n    \"ref\": \"MyImpactProduct2\", \r\n    \"widthtxt\": \"26 1/4\", \r\n  }, \r\n  { \r\n    \"color\": \"WHITE\",\r\n    \"heighttxt\": \"62 3/4\",\r\n    \"lengthtxt\": \"2 1/4\",\r\n    \"id\": 256, \r\n    \"itemtype\": 1, \r\n    \"modtype\": ModuleType.ImpactProduct,\r\n    \"glass_color\": \"BRONZE\",\r\n    \"interlayer\": \"CLEAR\",\r\n    \"wintype\": WinType.FrenchDoor,\r\n    \"name\": \"MyImpactProduct3\", \r\n    \"provider\": \"PGT WINDOWS\", \r\n    \"ref\": \"MyImpactProduct3\", \r\n    \"widthtxt\": \"19 1/8\", \r\n  }, \r\n  { \r\n    \"color\": \"GRAY\", \r\n    \"heighttxt\": \"\",\r\n    \"lengthtxt\": \"2 1/4\",\r\n    \"id\": 1768, \r\n    \"itemtype\": 3, \r\n    \"modtype\": ModuleType.Hardware,\r\n    \"glass_color\": \"WHITE\",\r\n    \"interlayer\": \"WHITE\",\r\n    \"wintype\": WinType.SingleHungSeries,\r\n    \"name\": \"MyImpactProduct4\", \r\n    \"provider\": \"MILLWORK\", \r\n    \"ref\": \"MyImpactProduct4\", \r\n    \"widthtxt\": \"\", \r\n  },\r\n  { \r\n    \"color\": \"WHITE\", \r\n    \"heighttxt\": \"4 1/2\",\r\n    \"lengthtxt\": \"2 1/4\",\r\n    \"id\": 2083, \r\n    \"itemtype\": 3, \r\n    \"modtype\": ModuleType.Material,\r\n    \"glass_color\": \"\",\r\n    \"interlayer\": \"\",\r\n    \"wintype\": WinType.SingleHungSeries,\r\n    \"name\": \"MyMaterial1\", \r\n    \"provider\": \"\", \r\n    \"ref\": \"MyMaterial1\", \r\n    \"widthtxt\": \"3\", \r\n  },\r\n  { \r\n    \"color\": \"WHITE\", \r\n    \"heighttxt\": \"4 1/2\",\r\n    \"lengthtxt\": \"\",\r\n    \"id\": 2093, \r\n    \"itemtype\": 3, \r\n    \"modtype\": ModuleType.Design,\r\n    \"glass_color\": \"\",\r\n    \"interlayer\": \"\",\r\n    \"wintype\": WinType.SingleHungSeries,\r\n    \"name\": \"MyDesign1\", \r\n    \"provider\": \"\", \r\n    \"ref\": \"MyDesign1\", \r\n    \"widthtxt\": \"3\", \r\n  }\r\n]\r\n\r\nexport const GetProductDetails = (id: number): ProductDetails => {\r\n  let ps = ProductSummaries.find(ps => ps.id === id)\r\n  ps = ps ?? {\r\n    \"color\": \"BRONZE\",\r\n    \"heighttxt\": \"25 3/4\",\r\n    \"lengthtxt\": \"2 1/4\",\r\n    \"id\": id,\r\n    \"name\": \"ECO 36 3/4 X 25 3/4 BRONZE/BRONZE CLEAR INTERLAYER\",\r\n    \"itemtype\": 1, \r\n    \"modtype\": ModuleType.ImpactProduct,\r\n    \"glass_color\": \"BRONZE\",\r\n    \"interlayer\": \"WHITE\",\r\n    \"wintype\": WinType.SingleHungSeries,\r\n    \"provider\": \"ECO WINDOWS\",\r\n    \"ref\": \"36.75X25.75HRXOECOBB5.16C\",\r\n    \"widthtxt\": \"36 3/4\",\r\n  }\r\n\r\n  const wf = new Fraction(ps.widthtxt ? ps.widthtxt : 0)\r\n  const hf = new Fraction(ps.heighttxt ? ps.heighttxt : 0)\r\n  const lf = new Fraction(ps.lengthtxt ? ps.lengthtxt : 0)\r\n  const w = ps.widthtxt ? wf.valueOf() : 0\r\n  const h = ps.heighttxt ? hf.valueOf() : 0\r\n  const l = ps.lengthtxt ? lf.valueOf() : 0\r\n\r\n  let p:ProductDetails = {\r\n    ...ps,\r\n    coating: \"\",\r\n    configuration: \"\",\r\n    cost_price: 80,\r\n    frame_color: \"\",\r\n    glass_type: \"\",\r\n    hardwaretype: \"\",\r\n    height: h,\r\n    image: \"/AMCRMERP/htdocs/document.php?modulepart=product&attachment=0&file=\" + (ps.id === 256 ? \"36.75X25.75HRXOECOBB5.16C/36.75X25.75.png\" : \"19.125X25.75SHELECOBB5.16W/26.png\"),\r\n    inst_price: 0,\r\n    is_screen: false,\r\n    itemtype: itemType2Id(\"\"),\r\n    length: l,\r\n    sales_price: 100,\r\n    width: w,\r\n  }\r\n  \r\n  switch(p.modtype) {\r\n    case ModuleType.Material:\r\n    case ModuleType.Design:\r\n      p = {\r\n        ...p,\r\n        itemtype: itemType2Id(\"Hardware\"),\r\n      }\r\n      break\r\n    default:\r\n      p = {\r\n        ...p,\r\n        coating: \"NONE\",\r\n        configuration: \"X\",\r\n        frame_color: \"BRONZE\",\r\n        glass_type: \"Insulated\",\r\n        inst_price: 150,\r\n        is_screen: true,\r\n        itemtype: itemType2Id(\"Window\"),\r\n      }\r\n  }\r\n\r\n  return p\r\n}\r\n","import { createSlice, createAsyncThunk } from '@reduxjs/toolkit'\r\nimport { LoadingState } from '../types/Status'\r\nimport * as mock from './mock/products-mock'\r\nimport { RootState } from './store'\r\nimport Fraction from 'fraction.js'\r\nimport ModuleType from '../types/ModuleType'\r\nimport WinType from '../types/WinType'\r\n\r\nexport type ProductSummary = {\r\n  color: string\r\n  glass_color:string\r\n  heighttxt: string\r\n  id: number\r\n  interlayer:string\r\n  itemtype: number\r\n  lengthtxt: string\r\n  modtype: ModuleType\r\n  name: string\r\n  provider: string\r\n  ref: string\r\n  widthtxt: string\r\n  wintype: WinType\r\n}\r\n\r\nexport type ProductDetails = {\r\n  coating:string\r\n  color: string\r\n  configuration: string\r\n  cost_price: number\r\n  frame_color: string\r\n  glass_color:string\r\n  glass_type:string\r\n  hardwaretype: string\r\n  height: number\r\n  heighttxt: string\r\n  id: number\r\n  image: string\r\n  inst_price: number\r\n  interlayer:string\r\n  is_screen: boolean\r\n  itemtype: number\r\n  length: number\r\n  lengthtxt: string\r\n  modtype: ModuleType\r\n  name: string\r\n  provider: string\r\n  ref: string\r\n  sales_price: number\r\n  width: number\r\n  widthtxt: string\r\n  wintype: WinType\r\n}\r\n\r\nexport type ProductDetailsMap = { \r\n  [key: string]: ProductDetails \r\n}\r\n\r\nexport type ProductDetailsRequests = { \r\n  [id: string]: boolean \r\n}\r\n\r\nexport type ProductsState = {\r\n    productSummaries: ProductSummary[]\r\n    productSummariesById: { [key: number]: ProductSummary }\r\n    productSummariesByRef: { [key: string]: ProductSummary }\r\n    productSummariesStatus: LoadingState,\r\n\r\n    productDetails: ProductDetailsMap\r\n    productDetailsStatus: LoadingState,\r\n\r\n    error: string | null | undefined\r\n}\r\n\r\nconst initialState : ProductsState = {\r\n  productSummaries: [],\r\n  productSummariesById: {},\r\n  productSummariesByRef: {},\r\n  productSummariesStatus: LoadingState.unavailable,\r\n  productDetails: {},\r\n  productDetailsStatus: LoadingState.unavailable,\r\n  error: null,\r\n}\r\n\r\nexport const fetchProductSummaries = createAsyncThunk<ProductSummary[]>('fetchProductSummaries', async (arg:void, thunkAPI:any) => {\r\n  console.log(\"Fetching product summaries\")\r\n  if (process.env.NODE_ENV === \"production\") {\r\n    const response = await fetch(`http://${window.location.hostname}/AMCRMERP/htdocs/custom/amhpestimatesv2/db/getproductsummaries.php`)\r\n    const json:ProductSummary[] = await response.json();\r\n    return json;\r\n  }\r\n  \r\n  // For testing in dev\r\n  return mock.ProductSummaries \r\n})\r\n\r\nexport const fetchProductDetailsById = createAsyncThunk<ProductDetails, number>('fetchProductDetailsById', async (id:number, thunkAPI:any) => {\r\n  let productsState:ProductsState = thunkAPI.getState().products\r\n  if (productsState.productDetails[id])\r\n    return productsState.productDetails[id]\r\n\r\n  if (process.env.NODE_ENV === \"production\") {\r\n    console.log(\"Fetching product \", id)\r\n    const response = await fetch(`http://${window.location.hostname}/AMCRMERP/htdocs/custom/amhpestimatesv2/db/getproductdetails.php?id=${id}`)\r\n    const json:any = await response.json();\r\n    let results = null;\r\n    if (Array.isArray(json) && json.length>0)\r\n      results = json[0];\r\n    else\r\n      results = json;\r\n\r\n    const wf = new Fraction(results.widthtxt ?? 0)\r\n    const hf = new Fraction(results.heighttxt ?? 0)\r\n    const lf = new Fraction(results.lengthtxt ?? 0)\r\n    const w = results.width?Number(results.width):(results.widthtxt?wf.valueOf():0)\r\n    const h = results.height?Number(results.height):(results.heighttxt?hf.valueOf():0)\r\n    const l = results.length?Number(results.length):(results.lengthtxt?lf.valueOf():0)\r\n\r\n    results = {\r\n      ...results,\r\n      id: Number(results.id),\r\n      sales_price: Number(results.sales_price),\r\n      inst_price: Number(results.inst_price),\r\n      cost_price: Number(results.cost_price),\r\n      width: w,\r\n      height: h,\r\n      length: l,\r\n      is_screen: Boolean(results.is_screen)\r\n    }\r\n    return results as ProductDetails;\r\n  }\r\n  \r\n  // For testing in dev\r\n  return mock.GetProductDetails(id)\r\n})\r\n\r\nexport const productsSlice = createSlice({\r\n  name: 'products',\r\n  initialState,\r\n  reducers: {\r\n  },\r\n  extraReducers: (builder) => {\r\n\r\n    builder.addCase(fetchProductSummaries.pending, (state, action) => {\r\n      state.productSummariesStatus = LoadingState.loading\r\n    })\r\n    builder.addCase(fetchProductSummaries.fulfilled, (state, action) => {\r\n      state.productSummariesStatus = LoadingState.succeeded\r\n      state.productSummaries = action.payload\r\n      state.productSummaries.forEach(ps => state.productSummariesById[ps.id] = ps)\r\n      state.productSummaries.forEach(ps => state.productSummariesByRef[ps.ref] = ps)\r\n    })\r\n    builder.addCase(fetchProductSummaries.rejected, (state, action) => {\r\n      state.productSummariesStatus = LoadingState.failed\r\n      state.error = action.error.message\r\n    })\r\n\r\n    builder.addCase(fetchProductDetailsById.pending, (state, action) => {\r\n      state.productDetailsStatus = LoadingState.loading\r\n    })\r\n    builder.addCase(fetchProductDetailsById.fulfilled, (state, action) => {\r\n      state.productDetailsStatus = LoadingState.succeeded\r\n      state.productDetails[action.payload.id] = action.payload \r\n    })\r\n    builder.addCase(fetchProductDetailsById.rejected, (state, action) => {\r\n      state.productDetailsStatus = LoadingState.failed\r\n      state.error = action.error.message\r\n    })\r\n\r\n  }\r\n})\r\n\r\nexport const selectProductSummaries = (state:RootState) : ProductSummary[]|undefined => state.products.productSummaries\r\nexport const selectProductSummariesById = (state:RootState) : { [key: number]: ProductSummary }|undefined => state.products.productSummariesById\r\nexport const selectProductSummariesByRef = (state:RootState) : { [key: string]: ProductSummary }|undefined => state.products.productSummariesByRef\r\nexport const selectProductSummariesStatus = (state:RootState) : LoadingState => state.products.productSummariesStatus\r\n\r\nexport const selectProductDetails = (state:RootState) : ProductDetailsMap|undefined => state.products.productDetails\r\nexport const selectProductDetailsStatus = (state:RootState) : LoadingState => state.products.productDetailsStatus\r\n\r\nexport default productsSlice.reducer","import React from 'react';\r\nimport { Modal, Button } from 'antd';\r\nimport './styles.css';\r\n\r\ntype HardwareConfirmatioProps = {\r\n    isModalVisible: boolean;\r\n    onCancel: () => void;\r\n    onYes?: () => void;\r\n    onNo?: () => void;\r\n}\r\n\r\nconst AddHardwareConfirmation = ({ isModalVisible, onYes, onNo, onCancel }: HardwareConfirmatioProps) => {\r\n    return (\r\n        <Modal\r\n            okButtonProps={{ style: { display: 'none' } }}\r\n            title=\"Do you want to include new hardware?\"\r\n            visible={isModalVisible} \r\n            onCancel={onCancel}>\r\n            <div className='buttons_grid'>\r\n                <Button className='button_product' onClick={() => onYes && onYes()}>Yes</Button>\r\n                <Button className='button_product' onClick={() => onNo && onNo()}>No</Button>\r\n                <Button className='button_product' onClick={() => onCancel && onCancel()}>Cancel</Button>\r\n            </div>\r\n        </Modal>\r\n    );\r\n};\r\n\r\nexport default AddHardwareConfirmation;","import { useCallback, useEffect, useState } from 'react';\r\nimport { Modal, Select, Form, Button } from 'antd';\r\nimport './styles.css';\r\nimport { useAppSelector } from '../../store/hooks';\r\nimport * as ds from '../../store/defaultsSlice';\r\nimport * as ps from '../../store/productsSlice';\r\nimport { LoadingState } from '../../types/Status';\r\nimport { id2ItemType, itemType2Id, ItemTypes } from '../../types/ItemType';\r\nimport { WinTypes } from '../../types/WinType';\r\n\r\ntype ProductSearchProps = {\r\n    visible: boolean\r\n    currentID: number|undefined\r\n    color: string\r\n    glasscolor: string\r\n\r\n    handleProduct: (id:number) => void\r\n    handleCancel: () => void\r\n}\r\nconst { Option } = Select;\r\n\r\nconst ProductSearch = (props: ProductSearchProps) => {\r\n    const [id, setID] = useState(props.currentID)\r\n    const [color, setColor] = useState(props.color)\r\n    const [provider, setProvider] = useState(\"\")\r\n    const [itemtype, setItemType] = useState(\"\")\r\n    const [interlayer, setInterlayer] = useState(\"\")\r\n    const [wintype, setWintype] = useState(\"\")\r\n    const [modtype, setModtype] = useState(\"\")\r\n    const [glassColor, setGlassColor] = useState(props.glasscolor)\r\n    const [ref, setRef] = useState(\"\")\r\n    \r\n    const defaultStatus = useAppSelector(ds.selectDefaultsStatus)\r\n    const defaults: ds.DefaultData | undefined = useAppSelector(ds.selectDefaults)\r\n    const products: ps.ProductSummary[] | undefined = useAppSelector(ps.selectProductSummaries)\r\n    const productsById: { [key: number]: ps.ProductSummary } | undefined = useAppSelector(ps.selectProductSummariesById)\r\n    const productsStatus = useAppSelector(ps.selectProductSummariesStatus)\r\n\r\n    const unspecified = useCallback((o:any) => o === undefined || o === \"None\" || o === \"Any\" || o === \"\" || o === \"0\" || o === 0, [])\r\n    const ifUnspecified = useCallback((o:any, alt:any) => unspecified(o) ? alt : o, [unspecified])\r\n    const id2ProductSummary = (id:number|undefined):ps.ProductSummary|undefined => productsById && id ? productsById[id] : undefined\r\n    const prodSummary = id2ProductSummary(props.currentID)\r\n\r\n    const resetSearch = useCallback(() => {\r\n        setColor(prodSummary?.color || props.color || \"Any\")\r\n        setProvider(ifUnspecified(prodSummary?.provider, \"ECO WINDOWS\"))\r\n        setItemType(ifUnspecified(prodSummary?.itemtype&&id2ItemType(prodSummary?.itemtype).toString(), \"Any\"))\r\n        setInterlayer(ifUnspecified(prodSummary?.interlayer, \"CLEAR\"))\r\n        setWintype(ifUnspecified(prodSummary?.wintype, \"Any\"))\r\n        setModtype(ifUnspecified(prodSummary?.modtype, \"Any\"))\r\n        setGlassColor(prodSummary?.glass_color || props.glasscolor || \"GRAY\")\r\n        setRef(ifUnspecified(prodSummary?.ref, \"None\"))\r\n    }, [ifUnspecified, props.color, props.glasscolor, prodSummary?.color, prodSummary?.provider, prodSummary?.itemtype, prodSummary?.interlayer, prodSummary?.wintype, prodSummary?.modtype, prodSummary?.glass_color, prodSummary?.ref])\r\n\r\n    const clearSearch = useCallback(() => {\r\n        setColor(ifUnspecified(props.color, \"Any\"))\r\n        setProvider(\"Any\")\r\n        setItemType(\"Any\")\r\n        setInterlayer(\"Any\")\r\n        setWintype(\"Any\")\r\n        setModtype(\"Any\")\r\n        setGlassColor(ifUnspecified(props.glasscolor, \"Any\"))\r\n        setRef(\"None\")\r\n    }, [ifUnspecified, props.color, props.glasscolor])\r\n\r\n    useEffect(() => {\r\n        resetSearch()\r\n    }, [props.visible, props.color, props.glasscolor, resetSearch])\r\n\r\n    const filterOption = (input: any, option: any) => {\r\n        const v = option.value.toLowerCase()\r\n        const i = input.toLowerCase()\r\n        return i===\"\" || (v !== null && (v?.indexOf(i) >= 0 || v.indexOf(i) >= 0))\r\n    }\r\n\r\n    const product2Label = (p:ps.ProductSummary|undefined):string => {\r\n        if (p)\r\n            return p.ref\r\n        return \"Any\"\r\n    }\r\n    const id2Ref = (id:number) => id2ProductSummary(id)?.ref\r\n    const isVisibleProductSummary = (p:ps.ProductSummary) => {\r\n        let visible:boolean = true\r\n        visible = visible && (unspecified(color) || p.color === color)\r\n        visible = visible && (unspecified(provider) || p.provider === provider)\r\n        visible = visible && (unspecified(itemtype) || p.itemtype === itemType2Id(itemtype))\r\n        visible = visible && (unspecified(interlayer) || p.interlayer === interlayer)\r\n        visible = visible && (unspecified(wintype) || p.wintype === wintype)\r\n        visible = visible && (unspecified(modtype) || p.modtype === modtype)\r\n        visible = visible && (unspecified(glassColor) || p.glass_color === glassColor)\r\n        return visible\r\n    } \r\n\r\n    const filterReferencesOptionsOnKeyPress = (input: any, option: any) => {\r\n        let p = unspecified(option.key)?undefined:id2ProductSummary(option.key)\r\n        let match:boolean = p!==undefined && isVisibleProductSummary(p)\r\n        match = match && filterOption(input,option)\r\n        return match\r\n    }\r\n    const selectProduct = (id:number) => {\r\n        setID(id)\r\n        setRef(id2Ref(id)||\"\")\r\n    }\r\n\r\n    const interlayers:string[] = (() => {\r\n        const ilmap:{[key:string]: boolean} = {}\r\n        const il:string[] = []\r\n        products?.forEach(p => {\r\n            if (p.interlayer) {\r\n                if (!ilmap[p.interlayer]) {\r\n                    ilmap[p.interlayer] = true\r\n                    il.push(p.interlayer)\r\n                }\r\n            }\r\n        })\r\n        return il\r\n    })()\r\n\r\n    const refs = products?.filter(isVisibleProductSummary).map(p => <Option value={product2Label(p)} key={p.id}>{product2Label(p)}</Option>)\r\n\r\n    return (\r\n        <Modal\r\n            title=\"Search Products\"\r\n            visible={props.visible} \r\n            onCancel={props.handleCancel}\r\n            onOk={() => id && props.handleProduct(id)}\r\n            okButtonProps={{ disabled: !id }}\r\n            footer={[\r\n                <Button key=\"OK\" onClick={() => id && props.handleProduct(id)} disabled={unspecified(ref)}>\r\n                  OK\r\n                </Button>,\r\n                <Button key=\"Cancel\"onClick={props.handleCancel}>\r\n                  Cancel\r\n                </Button>,\r\n                <Button key=\"Clear\"onClick={clearSearch} style={{ marginLeft: \"1rem\"}}>\r\n                    Clear\r\n                </Button>\r\n            ]}\r\n        >\r\n            <Form\r\n                name=\"product-search\"\r\n                labelCol={{ span: 8 }}\r\n                wrapperCol={{ span: 16 }}\r\n                autoComplete=\"off\"\r\n            >\r\n                <Form.Item label=\"Provider\">\r\n                    <Select<string>\r\n                        showSearch\r\n                        className='input show1'\r\n                        optionFilterProp=\"label\"\r\n                        onChange={(txt:string,option:any) => setProvider(option.value)}\r\n                        filterOption={filterOption}\r\n                        value={provider}\r\n                        loading ={defaultStatus===LoadingState.loading}\r\n                        placeholder=\"Select Provider...\"\r\n                    >\r\n                        <Option value=\"Any\" key=\"0\">Any</Option>\r\n                        {defaults?.providers.map(p => <Option value={p.label} key={p.value}>{p.label}</Option>)}\r\n                    </Select>\r\n                </Form.Item>\r\n\r\n                <Form.Item label=\"Color\">\r\n                    <Select\r\n                            showSearch\r\n                            className='input show1'\r\n                            optionFilterProp=\"value\"\r\n                            onChange={(input:string,option:any) => option&&setColor(option.key) }\r\n                            filterOption={(input:string,option:any) => option?.value ? option.value.toString().toLowerCase().indexOf(input.toLowerCase()) >= 0 : true }\r\n                            value={color}\r\n                        >\r\n                        <Option value=\"Any\" key=\"Any\">Any</Option>\r\n                        {defaults?.colors.filter(cd => cd.label!==\"NONE\").map(cd => <Option value={cd.label} key={cd.label}>{cd.label}</Option>)}\r\n                    </Select>\r\n                </Form.Item>\r\n\r\n                <Form.Item label=\"Glass Color\">\r\n                    <Select\r\n                            showSearch\r\n                            className='input show1'\r\n                            optionFilterProp=\"value\"\r\n                            onChange={(input:string,option:any) => option&&setGlassColor(option.key) }\r\n                            filterOption={(input:string,option:any) => option?.value ? option.value.toString().toLowerCase().indexOf(input.toLowerCase()) >= 0 : true }\r\n                            value={glassColor}\r\n                        >\r\n                        <Option value=\"Any\" key=\"Any\">Any</Option>\r\n                        {defaults?.colors.filter(cd => cd.label!==\"NONE\").map(cd => <Option value={cd.label} key={cd.label}>{cd.label}</Option>)}\r\n                    </Select>\r\n                </Form.Item>\r\n\r\n\r\n                <Form.Item label=\"Type of Opening\">\r\n                    <Select \r\n                        className='input show1'\r\n                        onChange={(input:string,option:any) => option&&setItemType(option.key) }\r\n                        value={itemtype}\r\n                    >\r\n                        {ItemTypes.map(i => i===\"None\" ? \"Any\" : i).map(i => <Option value={i} key={i}>{i}</Option>)}\r\n                    </Select>\r\n                </Form.Item>\r\n\r\n                <Form.Item label=\"Interlayer\">\r\n                    <Select \r\n                        className='input show1'\r\n                        onChange={(input:string,option:any) => option&&setInterlayer(option.key) }\r\n                        value={interlayer}\r\n                    >\r\n                        <Option value=\"Any\" key=\"Any\">Any</Option>\r\n                        {interlayers.map(i => <Option value={i} key={i}>{i}</Option>)}\r\n                    </Select>\r\n                </Form.Item>\r\n\r\n                <Form.Item label=\"Type\">\r\n                    <Select \r\n                        className='input show1'\r\n                        onChange={(input:string,option:any) => option&&setWintype(option.key) }\r\n                        value={wintype}\r\n                    >\r\n                        <Option value=\"Any\" key=\"Any\">Any</Option>\r\n                        {WinTypes.map(i => i===\"None\" ? \"Any\" : i).map(i => <Option value={i} key={i}>{i}</Option>)}\r\n                    </Select>\r\n                </Form.Item>\r\n\r\n                <Form.Item label={\"References (\"+refs?.length+\")\"}>\r\n                    <Select\r\n                        showSearch\r\n                        className='input show1'\r\n                        optionFilterProp=\"ref\"\r\n                        onChange={(input:string,option:any) => option ? selectProduct(Number(option.key)) : selectProduct(0) }\r\n                        filterOption={filterReferencesOptionsOnKeyPress}\r\n                        value={ref}\r\n                        loading ={productsStatus===LoadingState.loading}\r\n                        placeholder=\"Select Product Reference...\"\r\n                    >\r\n                        <Option value=\"None\" key=\"0\">None</Option>\r\n                        {refs}\r\n                    </Select> \r\n                </Form.Item>\r\n            </Form>\r\n        </Modal>\r\n    );\r\n};\r\n\r\nexport default ProductSearch;","import { configureStore } from '@reduxjs/toolkit'\r\nimport customersReducer from './customersSlice'\r\nimport estimatesReducer from './estimatesSlice'\r\nimport defaultsReducer from './defaultsSlice'\r\nimport productsReducer from './productsSlice'\r\n\r\nconst store = configureStore({\r\n  reducer: {\r\n    customers: customersReducer,\r\n    estimates: estimatesReducer,\r\n    defaults: defaultsReducer,\r\n    products: productsReducer\r\n  }\r\n})\r\n\r\n// Infer the `RootState` and `AppDispatch` types from the store itself\r\nexport type RootState = ReturnType<typeof store.getState>\r\nexport type AppDispatch = typeof store.dispatch\r\n\r\nexport default store;\r\n","import { useEffect, useState } from 'react';\r\nimport '../../Styles/main.css';\r\nimport { Layout, Row, Col, Typography, Select, Checkbox, InputNumber, Input, Divider, Button, Tooltip, Image, Menu, Dropdown, Space, notification } from 'antd';\r\nimport { CloseOutlined, DownOutlined, InfoCircleOutlined, SaveOutlined } from '@ant-design/icons';\r\nimport RoomOptions, { RoomType } from '../../Components/ModalOptions/RoomOptions';\r\nimport { createItemTotals, DefaultImpactProduct, ImpactProduct } from '../../store/ImpactProduct';\r\nimport * as ds from '../../store/defaultsSlice';\r\nimport * as ps from '../../store/productsSlice';\r\nimport * as es from '../../store/estimatesSlice';\r\nimport { useAppDispatch, useAppSelector } from '../../store/hooks';\r\nimport { isModified, isNew, LoadingState, ModifiedState } from '../../types/Status';\r\nimport { Estimate } from '../../store/Estimate';\r\nimport { asMoney, asPercentage, moneyParser, percentageParser } from '../../types/formats';\r\nimport {id2ItemType} from '../../types/ItemType';\r\nimport AddHardwareConfirmation from '../ModalOptions/AddHardwareConfirmation';\r\nimport WinType from '../../types/WinType';\r\nimport useModifiedAlert from '../../effects/useModifiedAlert';\r\nimport ModuleType from '../../types/ModuleType';\r\nimport MenuItem from 'antd/lib/menu/MenuItem';\r\nimport TextArea from 'rc-textarea';\r\nimport ProductSearch from '../ModalOptions/ProductSearch';\r\nimport store from '../../store/store';\r\n\r\nconst { Content } = Layout;\r\nconst { Title, Text } = Typography;\r\nconst { Option } = Select;\r\n\r\ntype ImpactProductProps = {\r\n    estimate?:Estimate\r\n    item?:ImpactProduct,\r\n    onClose?: (addHardware:boolean) => void\r\n    readOnly: boolean\r\n}\r\n\r\nexport type ProviderName = {\r\n    value: string\r\n    label: string\r\n}\r\n\r\nconst createInitialProductCopy = (item:ImpactProduct|undefined):ImpactProduct => {\r\n    return item ? { ...item } : { ...DefaultImpactProduct }\r\n}\r\n\r\nconst ImpactProductDetail = ({estimate, item, onClose, readOnly}:ImpactProductProps) => {\r\n    const [showRoomOptions, setShowRoomOptions] = useState<boolean>(false)\r\n    const [showAddHardwareConfirmation, setShowAddHardwareConfirmation] = useState<boolean>(false)\r\n    const products: ps.ProductSummary[] | undefined = useAppSelector(ps.selectProductSummaries)\r\n    const productsByRef: { [key: string]: ps.ProductSummary } | undefined = useAppSelector(ps.selectProductSummariesByRef)\r\n    const defaults: ds.DefaultData | undefined = useAppSelector(ds.selectDefaults)\r\n    const defaultStatus = useAppSelector(ds.selectDefaultsStatus)\r\n    const dispatch = useAppDispatch()\r\n    const [impactProduct, setImpactProduct] = useState<ImpactProduct>(() => createInitialProductCopy(item))\r\n    const id2RoomType:ds.RoomTypeConverterFunction = useAppSelector(ds.selectId2RoomTypeConvertor)\r\n    const [editRoomDescription, setEditRoomDescription] = useState(false)\r\n    const [showProductSearch, setShowProductSearch] = useState<boolean>(false)\r\n\r\n    useEffect(() => {\r\n        if (defaults?.colors.length === 0)\r\n            dispatch(ds.fetchDefaults())\r\n    }, [dispatch, defaults])\r\n\r\n    useEffect(() => {\r\n        if (impactProduct.roomtype === undefined)\r\n            setImpactProduct({\r\n                ...impactProduct,\r\n                roomtype: 0\r\n            })\r\n    }, [impactProduct])\r\n\r\n    useEffect(() => {\r\n        if (products === undefined || products.length === 0)\r\n            dispatch(ps.fetchProductSummaries())\r\n    }, [dispatch, products])\r\n\r\n    useModifiedAlert(estimate, item)\r\n\r\n    const onClickSave = () => {\r\n        if (impactProduct.roomtype === 0)\r\n            setShowRoomOptions(true);\r\n        else if (impactProduct.wintype === WinType.FrenchDoor)\r\n            setShowAddHardwareConfirmation(true);\r\n        else {\r\n            saveAndClose(impactProduct, false)\r\n        }\r\n    }\r\n\r\n    const saveAndClose = (p:ImpactProduct|null, addHardware:boolean) => {\r\n        if (p)\r\n            updateOrSave(p)\r\n        onClose && onClose(addHardware);\r\n    }\r\n\r\n    const updateOrSave = async (p:ImpactProduct) => {\r\n        if (isNew(p._modified) && p.id === 0)\r\n            await dispatch(es.addItem(p))\r\n        else\r\n            await dispatch(es.updateItem(p))\r\n\r\n        let e:Estimate|undefined = store.getState().estimates.estimate\r\n        if (e && e.id) {\r\n            dispatch(es.saveEstimate(e)).then((res:any)=>  notification.success({\r\n                message: \"Save Estimate\",\r\n                description: \"Success!\",\r\n                duration: 10\r\n            }))\r\n        }\r\n    }\r\n\r\n    const onSaveRoom = (type:RoomType) => {\r\n        setShowRoomOptions(false);\r\n        if (impactProduct.wintype === WinType.FrenchDoor) {\r\n            updateImpactProduct({\r\n                ...impactProduct,\r\n                roomtype: type\r\n            })\r\n            setShowAddHardwareConfirmation(true);\r\n        }\r\n        else {\r\n            // We need to save the item to the store now because the editor is closing\r\n            updateOrSave({\r\n                ...impactProduct,\r\n                roomtype: type\r\n            })\r\n            saveAndClose(null, false)\r\n        }\r\n    }\r\n\r\n    const onCancelRoom = () => {\r\n        setShowRoomOptions(false);\r\n    }\r\n\r\n    const onCancelAddHardwareConfirmation = () => {\r\n        setShowAddHardwareConfirmation(false);\r\n    }\r\n\r\n    const onCancel = () => {\r\n        onClose && onClose(false);\r\n    }\r\n\r\n    const undefinedOrNone = (o:any) => o === undefined || o === \"Undefined\" || o === \"\"\r\n    const ref2ProductSummary = (ref:string|undefined):ps.ProductSummary|undefined => (productsByRef&&ref) ? productsByRef[ref] : undefined\r\n    const filterOption = (input: any, option: any) => {\r\n        const v = option.value.toLowerCase()\r\n        const i = input.toLowerCase()\r\n        return i===\"\" || (v !== null && (v?.indexOf(i) >= 0 || v.indexOf(i) >= 0))\r\n    }\r\n\r\n    if (impactProduct && estimate) {\r\n        const t = createItemTotals(estimate, impactProduct, estimate?.customer)\r\n        if (impactProduct.sales_price !== t.sales_price || impactProduct.finalprice !== t.finalprice)\r\n            setImpactProduct({\r\n                ...impactProduct,\r\n                sales_price: t.sales_price,\r\n                finalprice: t.finalprice\r\n            })\r\n    }\r\n\r\n    // The reference dropdown contains a list of the product summaries \r\n    // It should show the product used to originally fill in this Impact Product\r\n    // If we change it we must update the associated properties in this impact product\r\n    const updateRef = (id:number) => {\r\n        setShowProductSearch(false)\r\n        dispatch(ps.fetchProductDetailsById(id)).then((details:any) => {\r\n            let p:ps.ProductDetails=details.payload\r\n   \r\n            let newIP:ImpactProduct = {\r\n                ...impactProduct,\r\n                _modified: isModified(impactProduct._modified) ? impactProduct._modified : ModifiedState.modified,\r\n                coating: p.coating,\r\n                configuration: p.configuration,\r\n                color: p.color,\r\n                cost_price: p.cost_price || 0,\r\n                frame_color: p.frame_color,\r\n                glass_color: p.glass_color,\r\n                glass_type: p.glass_type,\r\n                height: p.height,\r\n                heighttxt: p.heighttxt||undefined,\r\n                image: p.image,\r\n                inst_price: p.inst_price || 0,\r\n                interlayer: p.interlayer,\r\n                is_screen: ![WinType.FrenchDoor, WinType.FixedGlass].includes(p.wintype),\r\n                itemtype: id2ItemType(p.itemtype),\r\n                length: p.length,\r\n                lengthtxt: p.lengthtxt||undefined,\r\n                modtype: p.modtype || ModuleType.ImpactProduct,\r\n                name: p.name,\r\n                product_ref: p.ref,\r\n                provider: p.provider,\r\n                sales_price: p.sales_price || 0,\r\n                width: p.width,\r\n                widthtxt: p.widthtxt || undefined,\r\n                wintype: p.wintype,\r\n            }\r\n            updateImpactProduct(newIP)\r\n        })\r\n    }\r\n\r\n    const updateImpactProduct = (newIP:ImpactProduct) => {\r\n        setImpactProduct({\r\n            ...newIP,\r\n            _modified: isNew(newIP._modified) ? ModifiedState.new : ModifiedState.modified\r\n        });\r\n    }\r\n\r\n    const existingRoomDescriptions:string[] = []\r\n    estimate?.items?.forEach(i => {\r\n        if (i.modtype === ModuleType.ImpactProduct) {\r\n            const ip = i as ImpactProduct\r\n            if (ip.room_description && !existingRoomDescriptions.includes(ip.room_description))\r\n                existingRoomDescriptions.push(ip.room_description)\r\n        }\r\n    })\r\n    if (impactProduct.room_description && !existingRoomDescriptions.includes(impactProduct.room_description))\r\n        existingRoomDescriptions.push(impactProduct.room_description)\r\n    existingRoomDescriptions.sort((a,b) => a.localeCompare(b))\r\n\r\n    const roomDescriptionEditor = \r\n            <Menu>\r\n                {existingRoomDescriptions.map((d,i) => <MenuItem key={i} onClick={() => updateImpactProduct({...impactProduct,room_description: d})}>{d}</MenuItem>)}\r\n                <MenuItem key={existingRoomDescriptions.length} onClick={() => setEditRoomDescription(true)}>Click here to write new description</MenuItem>\r\n            </Menu>\r\n    \r\n    return (\r\n        <Layout className='layout'>\r\n            <Content>\r\n                <Title level={2} style={{ color: '#32445e' }}>Impact Product</Title>\r\n                <Row gutter={[24, 24]}>\r\n                    <Col xs={24} sm={24} md={12} lg={12} xl={12}>\r\n                        <Title level={5}>Reference Product</Title>\r\n                        <Button onClick={() => setShowProductSearch(true)} disabled={readOnly}>{impactProduct.product_ref || \"Choose...\"}</Button>\r\n\r\n                        <div className='flex_container block_space show3'>\r\n                            <Checkbox\r\n                                checked={impactProduct.is_standard}\r\n                                onChange={() => {}}\r\n                                disabled={true}\r\n                            >\r\n                                <Title level={5}>Standard</Title>\r\n                            </Checkbox>\r\n                            <Checkbox\r\n                                checked={impactProduct.is_def_color}\r\n                                onChange={(e:any) => updateImpactProduct({...impactProduct,is_def_color:e.target.checked})}\r\n                                disabled={readOnly}\r\n                            >\r\n                                <Title level={5}>Def. Frame Color</Title>\r\n                            </Checkbox>\r\n                            <Checkbox\r\n                                checked={impactProduct.is_def_glass_color}\r\n                                onChange={(e:any) => updateImpactProduct({...impactProduct,is_def_glass_color:e.target.checked})}\r\n                                disabled={readOnly}\r\n                            >\r\n                                <Title level={5}>Def. Glass Color</Title>\r\n                            </Checkbox>\r\n                        </div>\r\n\r\n                        <div className='flex_container block_space show2'>\r\n                            <Title level={5} style={{ marginRight: 15 }}>Type of Room:</Title>\r\n                            <Select<string>\r\n                                showSearch\r\n                                style={{ flexGrow: 1 }}\r\n                                optionFilterProp=\"label\"\r\n                                onChange={(txt:string,p:any) => updateImpactProduct({...impactProduct,roomtype: p.key})}\r\n                                filterOption={filterOption}\r\n                                loading={defaultStatus===LoadingState.loading}\r\n                                value={id2RoomType(impactProduct?.roomtype?.toString())}\r\n                                disabled={readOnly}\r\n                            >\r\n                                {defaults?.roomtypes.map(rt => <Option value={rt.label} key={rt.value}>{rt.label}</Option>)}\r\n                            </Select>\r\n                        </div>\r\n\r\n                        <div className='flex_container block_space show2'>\r\n                            <Title level={5} className='input_text'>Room #</Title>\r\n                            <InputNumber min={1} onChange={(num:number) => updateImpactProduct({...impactProduct,roomnum: num})} value={impactProduct.roomnum||0} disabled={readOnly} />\r\n                            <Title level={5} className='input_text'>Floor #</Title>\r\n                            <InputNumber min={1} onChange={(num:number) => updateImpactProduct({...impactProduct,floornum: num})} value={impactProduct.floornum||0} disabled={readOnly} />\r\n                        </div>\r\n\r\n                        <div className='flex_container block_space show2'>\r\n                            <Title level={5}>Description:</Title>\r\n                            {editRoomDescription ?\r\n                                <TextArea autoFocus onFocus={e => e.target.select()} maxLength={100} style={{marginLeft: \"2rem\", width: \"100%\"}} defaultValue={impactProduct?.room_description} onBlur={e => { updateImpactProduct({...impactProduct,room_description: e.target.value}); setEditRoomDescription(false)} }></TextArea>\r\n                                : <Dropdown overlay={roomDescriptionEditor} disabled={readOnly}>\r\n                                        <Button type=\"link\" onClick={() => setEditRoomDescription(true)} style={{ marginBottom: \".5em\", width: \"100%\", whiteSpace: \"normal\" }} >\r\n                                            <Space>\r\n                                                {impactProduct?.room_description || \"Click to write a new description\"}\r\n                                                <DownOutlined />\r\n                                            </Space>\r\n                                        </Button>\r\n                                  </Dropdown>\r\n\r\n                            }\r\n                        </div>\r\n\r\n                        <Divider />\r\n                        <Title level={5}>Provider</Title>\r\n                        <Input className='input show4' placeholder='Provider' disabled={true} value={undefinedOrNone(impactProduct.provider)?\"None\":impactProduct.provider}/>\r\n\r\n                        <Title level={5}>Type of Opening</Title>\r\n                        <Input className='input show4' placeholder='Type of Opening' disabled={true} value={impactProduct.itemtype||\"\"}/>\r\n\r\n                        <Title level={5}>Type</Title>\r\n                        <Input className='input show4' placeholder='Type' disabled={true} value={impactProduct.wintype}/>\r\n\r\n                        <Title level={5}>Configuration</Title>\r\n                        <Input className='input show3' placeholder='Configuration' disabled={true} value={impactProduct.configuration}/>\r\n\r\n                        <Title level={5}>Frame Color</Title>\r\n                        <Input className='input show1' placeholder='Frame' disabled={true} value={impactProduct.frame_color} />\r\n\r\n                        <div className='flex_container_center block_space'>\r\n                            <Image.PreviewGroup>\r\n                                <Image hidden={impactProduct.image === undefined || impactProduct.image === \"\"}\r\n                                    className='img' src={(process.env.REACT_APP_URL_PREFIX||\"\") + impactProduct.image} alt={impactProduct.name}\r\n                                />\r\n                            </Image.PreviewGroup>\r\n                        </div>\r\n\r\n                    </Col>\r\n\r\n                    <Col xs={24} sm={24} md={12} lg={12} xl={12}>\r\n\r\n                        <div className='block_space show2'>\r\n                            <Checkbox\r\n                                checked={impactProduct.is_colonial}\r\n                                onChange={(e:any) => updateImpactProduct({...impactProduct,is_colonial:e.target.checked})}\r\n                                className='input_colonial'\r\n                                disabled={readOnly}\r\n                            >\r\n                                <Title level={5}>Colonial</Title>\r\n                            </Checkbox>\r\n                            <div className={`flex_container ${impactProduct.is_colonial ? 'show1' : 'hide'}`}>\r\n                                <Text>A:</Text>\r\n                                <InputNumber className='input' placeholder='Across' \r\n                                        style={{ marginLeft: 5, marginRight: 15, width: '25%' }} \r\n                                        onBlur={e => updateImpactProduct({...impactProduct,colonial_across:Number(e.target.value)})}\r\n                                        onStep={(val:number) => updateImpactProduct({...impactProduct,colonial_across:val})}\r\n                                        value={impactProduct.colonial_across} \r\n                                        disabled={readOnly} />\r\n                                <Text>D:</Text>\r\n                                <InputNumber className='input' placeholder='Down' \r\n                                        style={{ marginLeft: 5, width: '25%' }} \r\n                                        onBlur={e => updateImpactProduct({...impactProduct,colonial_down:Number(e.target.value)})}\r\n                                        onStep={(val:number) => updateImpactProduct({...impactProduct,colonial_down:val})}\r\n                                        value={impactProduct.colonial_down} \r\n                                        disabled={readOnly} />\r\n                            </div>\r\n                        </div>\r\n\r\n                        <div className='flex_container block_space'>\r\n                            <Checkbox\r\n                                checked={impactProduct.is_screen}\r\n                                onChange={(e:any) => updateImpactProduct({...impactProduct,is_screen:e.target.checked})}\r\n                                disabled={readOnly || [WinType.FrenchDoor, WinType.FixedGlass].includes(impactProduct.wintype)}\r\n                            >\r\n                                <Title level={5}>Screen</Title>\r\n                            </Checkbox>\r\n                        </div>\r\n\r\n                        <Title level={5}>Sizes</Title>\r\n                        <div className='flex_container block_space show4'>\r\n                            <Text>W:</Text>\r\n                            <Input hidden={true} value={impactProduct.width}/>\r\n                            <Input style={{ marginLeft: 5, marginRight: 15 }} value={impactProduct.widthtxt} disabled={true} />\r\n                            <Text>H:</Text>\r\n                            <Input hidden={true} value={impactProduct.height}/>\r\n                            <Input style={{ marginLeft: 5, marginRight: 15 }} value={impactProduct.heighttxt} disabled={true} />\r\n                            <Text>L:</Text>\r\n                            <Input hidden={true} value={impactProduct.length}/>\r\n                            <Input style={{ marginLeft: 5 }} value={impactProduct.lengthtxt} disabled={true} />\r\n                        </div>\r\n\r\n                        <Title level={5}>Glass Type</Title>\r\n                        <Input className='input show1' placeholder=\"Glass\" disabled={true} value={impactProduct.glass_type} />\r\n\r\n                        <Title level={5}>Glass Color</Title>\r\n                        <Input className='input show3' placeholder=\"Glass Color\" disabled={true} value={impactProduct.glass_color}/>\r\n\r\n                        <Title level={5}>Interlayer</Title>\r\n                        <Input className='input show2' placeholder='Interlayer' disabled={true} value={impactProduct.interlayer}/>\r\n\r\n                        <Title level={5}>Coating</Title>\r\n                        <Input className='input show4' placeholder='Coating' disabled={true} value={impactProduct.coating} />\r\n\r\n                        <Divider />\r\n\r\n                        {estimate?.is_installation_included ?\r\n                            <>\r\n                                <Title level={5}>Installation &amp; Discount %</Title>\r\n                                <div className='flex_container block_space show1'>\r\n                                    <InputNumber className='input' placeholder='Installation' style={{ marginRight: 20 }} disabled={true}\r\n                                            formatter={asMoney}\r\n                                            value={impactProduct.inst_price}\r\n                                        />\r\n                                    <InputNumber className='input' placeholder='Discount' min={0} max={1} step={.01} \r\n                                        onBlur={e => updateImpactProduct({...impactProduct,inst_discount:percentageParser(e.target.value)})}\r\n                                        onStep={(val:number) => updateImpactProduct({...impactProduct,inst_discount:val})}\r\n                                        formatter={asPercentage}\r\n                                        parser={percentageParser}\r\n                                        value={impactProduct.inst_discount} \r\n                                        disabled={readOnly} />\r\n                                </div>\r\n                            </>:\"\"\r\n                        }\r\n\r\n                        {impactProduct.is_colonial ? \r\n                            <>\r\n                                <Title level={5}>Colonial Fee <Tooltip title=\"Colonial is a different material that has an extra cost\"><InfoCircleOutlined twoToneColor='#32445E' /></Tooltip></Title>\r\n                                <InputNumber className='input show1' placeholder='Colonial Fee' \r\n                                    onBlur={e => updateImpactProduct({...impactProduct,colonial_fee:moneyParser(e.target.value)})}\r\n                                    onStep={(val:number) => updateImpactProduct({...impactProduct,colonial_fee:val})}\r\n                                    formatter={asMoney}\r\n                                    parser={moneyParser}\r\n                                    value={impactProduct.colonial_fee} \r\n                                    disabled={readOnly} />\r\n                            </>\r\n                        : \"\"}\r\n\r\n                        <Title level={5}>Sales Price &amp; Discount %</Title>\r\n                        <div className='flex_container block_space'>\r\n                            <InputNumber className='input show4' placeholder='Price' style={{ marginRight: 20 }} disabled={true} \r\n                                value={impactProduct.sales_price}\r\n                                formatter={asMoney}\r\n                            />\r\n                            <InputNumber className='input' placeholder='Discount' min={0} max={1} step={.01}\r\n                                onBlur={e => updateImpactProduct({...impactProduct,sales_discount:percentageParser(e.target.value)})}\r\n                                onStep={(val:number) => updateImpactProduct({...impactProduct,sales_discount:val})}\r\n                                formatter={asPercentage}\r\n                                parser={percentageParser}\r\n                                value={impactProduct.sales_discount} \r\n                                disabled={readOnly} />\r\n                        </div>\r\n\r\n                        <Title level={5}>Final Price: {asMoney(impactProduct.finalprice)}</Title>\r\n\r\n                        <div className='flex_container_end show4'>\r\n                            <Button type={impactProduct&&isModified(impactProduct._modified)?\"primary\":\"ghost\"} shape=\"round\" icon={<SaveOutlined />} size='large' onClick={() => onClickSave()} disabled={readOnly || impactProduct.product_ref === undefined}>{item?\"Save\":\"Add\"}</Button>\r\n                            <Button type=\"primary\" shape=\"round\" icon={<CloseOutlined />} size='large' onClick={() => onCancel()} style={{ marginLeft: \"20px\" }}>Cancel</Button>\r\n                        </div>\r\n                    </Col>\r\n                </Row>\r\n            </Content>\r\n            <RoomOptions isModalVisible={showRoomOptions} handleCancel={() => onCancelRoom()} handleTypeOptions={onSaveRoom} />\r\n            <AddHardwareConfirmation isModalVisible={showAddHardwareConfirmation} onYes={() => saveAndClose(impactProduct, true)} onNo={() => saveAndClose(impactProduct, false)} onCancel={() => onCancelAddHardwareConfirmation()} />\r\n            <ProductSearch \r\n                visible={showProductSearch} \r\n                currentID={ref2ProductSummary(impactProduct.product_ref)?.id} \r\n                color={impactProduct.is_def_color ? (estimate?.defcolor||\"\") : \"\"} \r\n                glasscolor={impactProduct.is_def_glass_color ? (estimate?.defglasscolor||\"\") : \"\"} \r\n\r\n                handleCancel={() => setShowProductSearch(false)} \r\n                handleProduct={updateRef} \r\n            />\r\n        </Layout>\r\n    );\r\n};\r\n\r\nexport default ImpactProductDetail;","import React, { useEffect, useState } from 'react';\r\nimport '../Styles/main.css';\r\nimport { Layout, Spin } from 'antd';\r\nimport * as es from '../store/estimatesSlice';\r\nimport { useAppDispatch, useAppSelector } from '../store/hooks';\r\nimport ImpactProductDetail from '../Components/ProductDetails/ImpactProduct';\r\nimport { EstimateItem } from '../store/EstimateItem';\r\nimport { useHistory, useParams } from 'react-router';\r\nimport { DefaultImpactProduct, ImpactProduct } from '../store/ImpactProduct';\r\nimport { Estimate } from '../store/Estimate';\r\nimport { ModifiedState } from '../types/Status';\r\nimport { isReadOnly } from '../types/EstimateStatus';\r\n\r\nconst { Content } = Layout;\r\n\r\nconst ImpactProductPage = () => {\r\n    const dispatch = useAppDispatch();\r\n    const [item, setItem] = useState<EstimateItem | undefined>(undefined)\r\n    const estimate: Estimate | undefined = useAppSelector(es.selectEstimate)\r\n    var params = useParams<{eid: string, iid: string}>();\r\n    const history = useHistory();\r\n\r\n    useEffect(() => {\r\n        // If we know the eid then load the estimate\r\n        if (params.eid && estimate === undefined)\r\n            dispatch(es.fetchEstimate(Number(params.eid)))\r\n        else\r\n            setItem({\r\n                ...DefaultImpactProduct,\r\n                estimateid: estimate && estimate.id ? estimate.id : 0,\r\n                _modified: ModifiedState.new\r\n            })\r\n    }, [dispatch, params.eid, estimate])\r\n\r\n    useEffect(() => {\r\n        if (params.iid && estimate && estimate.items)\r\n            setItem(estimate.items.find(i => i.id === Number(params.iid)))\r\n    }, [estimate, params.iid])\r\n\r\n    const onClose = (addHardware:boolean) => {\r\n        if (addHardware && estimate && estimate.id)\r\n            history.replace(`/hardware/${estimate.id}`);\r\n        else if (history.length>0)\r\n            history.goBack()\r\n    }\r\n\r\n    const readOnly = isReadOnly(estimate)\r\n    \r\n    return (\r\n        <Layout className='impact'>\r\n            <Content className='impactContainer'>\r\n                {item \r\n                    ?   <ImpactProductDetail\r\n                            estimate={estimate}\r\n                            item={item as ImpactProduct}\r\n                            onClose={onClose}\r\n                            readOnly={readOnly}\r\n                        /> \r\n                    : <Spin size=\"large\" style={{ display: \"flex\", alignSelf: \"center\" }} />}\r\n            </Content>\r\n        </Layout>\r\n    );\r\n};\r\n\r\nexport default ImpactProductPage;","import { useCallback, useEffect, useMemo, useState } from 'react';\r\nimport { Modal, Select, Form, Button } from 'antd';\r\nimport './styles.css';\r\nimport { useAppSelector } from '../../store/hooks';\r\nimport * as ds from '../../store/defaultsSlice';\r\nimport * as ps from '../../store/productsSlice';\r\nimport { LoadingState } from '../../types/Status';\r\nimport ModuleType from '../../types/ModuleType';\r\n\r\ntype MaterialSearchProps = {\r\n    visible: boolean\r\n    currentID: number|undefined\r\n    color: string\r\n\r\n    handleProduct: (id:number) => void\r\n    handleCancel: () => void\r\n}\r\nconst { Option } = Select;\r\n\r\nconst MaterialSearch = (props: MaterialSearchProps) => {\r\n    const [id, setID] = useState(props.currentID)\r\n    const [color, setColor] = useState(props.color)\r\n    const [provider, setProvider] = useState(\"\")\r\n    const [width, setWidth] = useState(\"\")\r\n    const [height, setHeight] = useState(\"\")\r\n    const [length, setLength] = useState(\"\")\r\n    const [ref, setRef] = useState(\"\")\r\n    \r\n    const defaultStatus = useAppSelector(ds.selectDefaultsStatus)\r\n    const defaults: ds.DefaultData | undefined = useAppSelector(ds.selectDefaults)\r\n    const products: ps.ProductSummary[] | undefined = useAppSelector(ps.selectProductSummaries)\r\n    const productsById: { [key: number]: ps.ProductSummary } | undefined = useAppSelector(ps.selectProductSummariesById)\r\n    const productsStatus = useAppSelector(ps.selectProductSummariesStatus)\r\n\r\n    const unspecified = useCallback((o:any) => o === undefined || o === \"None\" || o === \"Any\" || o === \"\" || o === \"0\" || o === 0, [])\r\n    const ifUnspecified = useCallback((o:any, alt:any) => unspecified(o) ? alt : o, [unspecified])\r\n    const id2ProductSummary = (id:number|undefined):ps.ProductSummary|undefined => productsById && id ? productsById[id] : undefined\r\n    const prodSummary = id2ProductSummary(props.currentID)\r\n\r\n    const resetSearch = useCallback(() => {\r\n        setColor(prodSummary?.color || props.color || \"Any\")\r\n        setProvider(ifUnspecified(prodSummary?.provider, \"Any\"))\r\n        setWidth(ifUnspecified(prodSummary?.widthtxt, \"Any\"))\r\n        setHeight(ifUnspecified(prodSummary?.heighttxt, \"Any\"))\r\n        setLength(ifUnspecified(prodSummary?.lengthtxt, \"Any\"))\r\n        setRef(ifUnspecified(prodSummary?.ref, \"None\"))\r\n    }, [prodSummary?.color, prodSummary?.provider, prodSummary?.widthtxt, prodSummary?.heighttxt, prodSummary?.lengthtxt, prodSummary?.ref, props.color, ifUnspecified])\r\n\r\n    const clearSearch = useCallback(() => {\r\n        setColor(ifUnspecified(props.color, \"Any\"))\r\n        setProvider(\"Any\")\r\n        setWidth(\"Any\")\r\n        setHeight(\"Any\")\r\n        setLength(\"Any\")\r\n        setRef(\"None\")\r\n    }, [ifUnspecified, props.color])\r\n\r\n    useEffect(() => {\r\n        resetSearch()\r\n    }, [props.visible, props.color, resetSearch])\r\n\r\n    const filterOption = (input: any, option: any) => {\r\n        const v = option.value.toLowerCase()\r\n        const i = input.toLowerCase()\r\n        return i===\"\" || (v !== null && (v?.indexOf(i) >= 0 || v.indexOf(i) >= 0))\r\n    }\r\n\r\n    const product2Label = (p:ps.ProductSummary|undefined):string => {\r\n        if (p)\r\n            return p.ref\r\n        return \"Any\"\r\n    }\r\n    const id2Ref = (id:number) => id2ProductSummary(id)?.ref\r\n    const materialProducts = useMemo(() => products?.filter(p => p.modtype === ModuleType.Material),  [products])\r\n    const isCandidateProduct = useCallback((p:ps.ProductSummary) => {\r\n        let visible:boolean = true\r\n        visible = visible && (unspecified(color) || p.color === color)\r\n        visible = visible && (unspecified(provider) || p.provider === provider)\r\n        visible = visible && (unspecified(width) || p.widthtxt === width)\r\n        visible = visible && (unspecified(height) || p.heighttxt === height)\r\n        visible = visible && (unspecified(length) || p.lengthtxt === length)\r\n        return visible\r\n    }, [color, height, length, provider, unspecified, width])\r\n\r\n    const filterReferencesOptionsOnKeyPress = (input: any, option: any) => {\r\n        let p = unspecified(option.key)?undefined:id2ProductSummary(option.key)\r\n        let match:boolean = p!==undefined && isCandidateProduct(p)\r\n        match = match && filterOption(input,option)\r\n        return match\r\n    }\r\n    const selectProduct = (id:number) => {\r\n        setID(id)\r\n        setRef(id2Ref(id)||\"\")\r\n    }\r\n\r\n    const candidateProducts = useMemo(() => materialProducts?.filter(isCandidateProduct),  [isCandidateProduct, materialProducts])\r\n    const refs = useMemo(() => candidateProducts?.map(p => <Option value={product2Label(p)} key={p.id}>{product2Label(p)}</Option>), [candidateProducts])\r\n    const widthValues = useMemo(() => {\r\n        const wMap:{[key:string]: string} = {}\r\n        materialProducts?.forEach(p => {\r\n            if (p.widthtxt)\r\n                wMap[p.widthtxt] = p.widthtxt\r\n        })\r\n        return Object.keys(wMap).map(w => <Option value={w} key={w}>{w}</Option>)\r\n    }, [materialProducts])\r\n    const heightValues = useMemo(() => {\r\n        const hMap:{[key:string]: string} = {}\r\n        materialProducts?.forEach(p => {\r\n            if (p.heighttxt)\r\n                hMap[p.heighttxt] = p.heighttxt\r\n        })\r\n        return Object.keys(hMap).map(h => <Option value={h} key={h}>{h}</Option>)\r\n    }, [materialProducts])\r\n    const lengthValues = useMemo(() => {\r\n        const wMap:{[key:string]: string} = {}\r\n        materialProducts?.forEach(p => {\r\n            if (p.lengthtxt)\r\n                wMap[p.lengthtxt] = p.lengthtxt\r\n        })\r\n        return Object.keys(wMap).map(l => <Option value={l} key={l}>{l}</Option>)\r\n    }, [materialProducts])\r\n\r\n    return (\r\n        <Modal\r\n            title=\"Search Products\"\r\n            visible={props.visible} \r\n            onCancel={props.handleCancel}\r\n            onOk={() => id && props.handleProduct(id)}\r\n            okButtonProps={{ disabled: !id }}\r\n            footer={[\r\n                <Button key=\"OK\" onClick={() => id && props.handleProduct(id)} disabled={unspecified(ref)}>\r\n                  OK\r\n                </Button>,\r\n                <Button key=\"Cancel\"onClick={props.handleCancel}>\r\n                  Cancel\r\n                </Button>,\r\n                <Button key=\"Clear\"onClick={clearSearch} style={{ marginLeft: \"1rem\"}}>\r\n                    Clear\r\n                </Button>\r\n            ]}\r\n        >\r\n            <Form\r\n                name=\"product-search\"\r\n                labelCol={{ span: 8 }}\r\n                wrapperCol={{ span: 16 }}\r\n                autoComplete=\"off\"\r\n            >\r\n                <Form.Item label=\"Provider\">\r\n                    <Select<string>\r\n                        showSearch\r\n                        className='input show1'\r\n                        optionFilterProp=\"label\"\r\n                        onChange={(txt:string,option:any) => setProvider(option.value)}\r\n                        filterOption={filterOption}\r\n                        value={provider}\r\n                        loading ={defaultStatus===LoadingState.loading}\r\n                        placeholder=\"Select Provider...\"\r\n                    >\r\n                        <Option value=\"Any\" key=\"0\">Any</Option>\r\n                        {defaults?.providers.map(p => <Option value={p.label} key={p.value}>{p.label}</Option>)}\r\n                    </Select>\r\n                </Form.Item>\r\n\r\n                <Form.Item label=\"Color\">\r\n                    <Select\r\n                            showSearch\r\n                            className='input show1'\r\n                            optionFilterProp=\"value\"\r\n                            onChange={(input:string,option:any) => option&&setColor(option.key) }\r\n                            filterOption={(input:string,option:any) => option?.value ? option.value.toString().toLowerCase().indexOf(input.toLowerCase()) >= 0 : true }\r\n                            value={color}\r\n                        >\r\n                        <Option value=\"Any\" key=\"Any\">Any</Option>\r\n                        {defaults?.colors.filter(cd => cd.label!==\"NONE\").map(cd => <Option value={cd.label} key={cd.label}>{cd.label}</Option>)}\r\n                    </Select>\r\n                </Form.Item>\r\n\r\n                <Form.Item label=\"Width\">\r\n                    <Select\r\n                            showSearch\r\n                            className='input show1'\r\n                            optionFilterProp=\"value\"\r\n                            onChange={(input:string,option:any) => option&&setWidth(option.key) }\r\n                            filterOption={(input:string,option:any) => option?.value ? option.value.toString().toLowerCase().indexOf(input.toLowerCase()) >= 0 : true }\r\n                            value={width}\r\n                        >\r\n                        <Option value=\"Any\" key=\"Any\">Any</Option>\r\n                        {widthValues}\r\n                    </Select>\r\n                </Form.Item>\r\n\r\n                <Form.Item label=\"Height\">\r\n                    <Select\r\n                            showSearch\r\n                            className='input show1'\r\n                            optionFilterProp=\"value\"\r\n                            onChange={(input:string,option:any) => option&&setHeight(option.key) }\r\n                            filterOption={(input:string,option:any) => option?.value ? option.value.toString().toLowerCase().indexOf(input.toLowerCase()) >= 0 : true }\r\n                            value={height}\r\n                        >\r\n                        <Option value=\"Any\" key=\"Any\">Any</Option>\r\n                        {heightValues}\r\n                    </Select>\r\n                </Form.Item>\r\n\r\n                <Form.Item label=\"Length\">\r\n                    <Select\r\n                            showSearch\r\n                            className='input show1'\r\n                            optionFilterProp=\"value\"\r\n                            onChange={(input:string,option:any) => option&&setLength(option.key) }\r\n                            filterOption={(input:string,option:any) => option?.value ? option.value.toString().toLowerCase().indexOf(input.toLowerCase()) >= 0 : true }\r\n                            value={length}\r\n                        >\r\n                        <Option value=\"Any\" key=\"Any\">Any</Option>\r\n                        {lengthValues}\r\n                    </Select>\r\n                </Form.Item>\r\n\r\n                <Form.Item label={\"References (\"+refs?.length+\")\"}>\r\n                    <Select\r\n                        showSearch\r\n                        className='input show1'\r\n                        optionFilterProp=\"ref\"\r\n                        onChange={(input:string,option:any) => option ? selectProduct(Number(option.key)) : selectProduct(0) }\r\n                        filterOption={filterReferencesOptionsOnKeyPress}\r\n                        value={ref}\r\n                        loading ={productsStatus===LoadingState.loading}\r\n                        placeholder=\"Select Product Reference...\"\r\n                    >\r\n                        <Option value=\"None\" key=\"0\">None</Option>\r\n                        {refs}\r\n                    </Select> \r\n                </Form.Item>\r\n            </Form>\r\n        </Modal>\r\n    );\r\n};\r\n\r\nexport default MaterialSearch;","import { useEffect, useState } from 'react';\r\nimport '../../Styles/main.css';\r\nimport { Layout, Row, Col, Typography, InputNumber, Input, Divider, Button, Image, notification } from 'antd';\r\nimport { CloseOutlined, SaveOutlined } from '@ant-design/icons';\r\nimport { createItemTotals, DefaultMaterial, Material } from '../../store/Material';\r\nimport * as ds from '../../store/defaultsSlice';\r\nimport * as ps from '../../store/productsSlice';\r\nimport * as es from '../../store/estimatesSlice';\r\nimport { useAppDispatch, useAppSelector } from '../../store/hooks';\r\nimport { isModified, isNew, ModifiedState } from '../../types/Status';\r\nimport { Estimate } from '../../store/Estimate';\r\nimport { asMoney, asPercentage, percentageParser } from '../../types/formats';\r\nimport {id2ItemType} from '../../types/ItemType';\r\nimport useModifiedAlert from '../../effects/useModifiedAlert';\r\nimport ModuleType from '../../types/ModuleType';\r\nimport store from '../../store/store';\r\nimport MaterialSearch from '../ModalOptions/MaterialSearch';\r\n\r\nconst { Content } = Layout;\r\nconst { Title, Text } = Typography;\r\n\r\ntype MaterialProps = {\r\n    estimate?:Estimate\r\n    item?:Material,\r\n    onClose?: () => void\r\n    readOnly: boolean\r\n}\r\n\r\nexport type ProviderName = {\r\n    value: string\r\n    label: string\r\n}\r\n\r\nconst createInitialProductCopy = (item:Material|undefined):Material => {\r\n    return item ? { ...item } : { ...DefaultMaterial }\r\n}\r\n\r\nconst MaterialDetail = ({estimate, item, onClose, readOnly}:MaterialProps) => {\r\n    const products: ps.ProductSummary[] | undefined = useAppSelector(ps.selectProductSummaries)\r\n    const productsByRef: { [key: string]: ps.ProductSummary } | undefined = useAppSelector(ps.selectProductSummariesByRef)\r\n    const defaults: ds.DefaultData | undefined = useAppSelector(ds.selectDefaults)\r\n    const dispatch = useAppDispatch()\r\n    const [material, setMaterial] = useState<Material>(() => createInitialProductCopy(item))\r\n    const [showProductSearch, setShowProductSearch] = useState<boolean>(false)\r\n\r\n    useEffect(() => {\r\n        if (defaults?.colors.length === 0)\r\n            dispatch(ds.fetchDefaults())\r\n    }, [dispatch, defaults])\r\n\r\n    useEffect(() => {\r\n        if (products === undefined || products.length === 0)\r\n            dispatch(ps.fetchProductSummaries())\r\n    }, [dispatch, products])\r\n\r\n    useModifiedAlert(estimate, item)\r\n\r\n    const onClickSave = () => {\r\n        saveAndClose(material)\r\n    }\r\n\r\n    const saveAndClose = (p:Material|null) => {\r\n        if (p)\r\n            updateOrSave(p)\r\n       onClose && onClose();\r\n    }\r\n\r\n    const updateOrSave = async (p:Material) => {\r\n        if (isNew(p._modified) && p.id === 0)\r\n            await dispatch(es.addItem(p))\r\n        else\r\n            await dispatch(es.updateItem(p))\r\n\r\n        let e:Estimate|undefined = store.getState().estimates.estimate\r\n        if (e && e.id) {\r\n            dispatch(es.saveEstimate(e)).then((res:any)=>  notification.success({\r\n                message: \"Save Estimate\",\r\n                description: \"Success!\",\r\n                duration: 10\r\n            }))\r\n        }\r\n    }\r\n    const onCancel = () => {\r\n        onClose && onClose();\r\n    }\r\n\r\n    const undefinedOrNone = (o:any) => o === undefined || o === \"Undefined\" || o === \"\"\r\n    const ref2ProductSummary = (ref:string|undefined):ps.ProductSummary|undefined => (productsByRef&&ref) ? productsByRef[ref] : undefined\r\n\r\n    if (material && estimate) {\r\n        const t = createItemTotals(estimate, material, estimate?.customer)\r\n        if (material.sales_price !== t.sales_price || material.finalprice !== t.finalprice)\r\n            setMaterial({\r\n                ...material,\r\n                sales_price: t.sales_price,\r\n                finalprice: t.finalprice\r\n            })\r\n    }\r\n\r\n    // The reference dropdown contains a list of the product summaries \r\n    // It should show the product used to originally fill in this Material\r\n    // If we change it we must update the associated properties in this material\r\n    const updateRef = (id:number) => {\r\n        setShowProductSearch(false)\r\n        dispatch(ps.fetchProductDetailsById(id)).then((details:any) => {\r\n            let p:ps.ProductDetails=details.payload\r\n   \r\n            let newM:Material = {\r\n                ...material,\r\n                _modified: isModified(material._modified) ? material._modified : ModifiedState.modified,\r\n                color: p.color,\r\n                cost_price: p.cost_price || 0,\r\n                height: p.height,\r\n                heighttxt: p.heighttxt||undefined,\r\n                image: p.image,\r\n                inst_price: p.inst_price || 0,\r\n                itemtype: id2ItemType(p.itemtype),\r\n                length: p.length,\r\n                lengthtxt: p.lengthtxt||undefined,\r\n                modtype: p.modtype || ModuleType.Material,\r\n                name: p.name,\r\n                product_ref: p.ref,\r\n                provider: p.provider,\r\n                sales_price: p.sales_price || 0,\r\n                width: p.width,\r\n                widthtxt: p.widthtxt || undefined,\r\n                wintype: p.wintype,\r\n            }\r\n            updateMaterial(newM)\r\n        })\r\n    }\r\n\r\n    const updateMaterial = (newM:Material) => {\r\n        setMaterial({\r\n            ...newM,\r\n            _modified: isNew(newM._modified) ? ModifiedState.new : ModifiedState.modified\r\n        });\r\n    }\r\n\r\n    return (\r\n        <Layout className='layout'>\r\n            <Content>\r\n                <Title level={2} style={{ color: '#32445e' }}>Material</Title>\r\n                <Row gutter={[24, 24]}>\r\n                    <Col xs={24} sm={24} md={12} lg={12} xl={12}>\r\n                        <Title level={5}>Reference Product</Title>\r\n                        <Button onClick={() => setShowProductSearch(true)} disabled={readOnly}>{material.product_ref || \"Choose...\"}</Button>\r\n\r\n                        <Divider />\r\n                        <Title level={5}>Provider</Title>\r\n                        <Input className='input show4' placeholder='Provider' disabled={true} value={undefinedOrNone(material.provider)?\"None\":material.provider}/>\r\n\r\n                        <Title level={5}>Type of Opening</Title>\r\n                        <Input className='input show4' placeholder='Type of Opening' disabled={true} value={material.itemtype||\"\"}/>\r\n\r\n                        <Title level={5}>Type</Title>\r\n                        <Input className='input show4' placeholder='Type' disabled={true} value={material.wintype}/>\r\n\r\n                        <Title level={5}>Color</Title>\r\n                        <Input className='input show1' placeholder='Frame' disabled={true} value={material.color} />\r\n\r\n                        <div className='flex_container_center block_space'>\r\n                            <Image.PreviewGroup>\r\n                                <Image hidden={material.image === undefined || material.image === \"\"}\r\n                                    className='img' src={(process.env.REACT_APP_URL_PREFIX||\"\") + material.image} alt={material.name}\r\n                                />\r\n                            </Image.PreviewGroup>\r\n                        </div>\r\n\r\n                    </Col>\r\n\r\n                    <Col xs={24} sm={24} md={12} lg={12} xl={12}>\r\n\r\n                        <Title level={5}>Sizes</Title>\r\n                        <div className='flex_container block_space show4'>\r\n                            <Text>W:</Text>\r\n                            <Input hidden={true} value={material.width}/>\r\n                            <Input style={{ marginLeft: 5, marginRight: 15 }} value={material.widthtxt} disabled={true} />\r\n                            <Text>H:</Text>\r\n                            <Input hidden={true} value={material.height}/>\r\n                            <Input style={{ marginLeft: 5, marginRight: 15 }} value={material.heighttxt} disabled={true} />\r\n                            <Text>L:</Text>\r\n                            <Input hidden={true} value={material.length}/>\r\n                            <Input style={{ marginLeft: 5 }} value={material.lengthtxt} disabled={true} />\r\n                        </div>\r\n\r\n                        <Divider />\r\n\r\n                        <Title level={5}>Sales Price &amp; Discount %</Title>\r\n                        <div className='flex_container block_space'>\r\n                            <InputNumber className='input show4' placeholder='Price' style={{ marginRight: 20 }} disabled={true} \r\n                                value={material.sales_price}\r\n                                formatter={asMoney}\r\n                            />\r\n                            <InputNumber className='input' placeholder='Discount' min={0} max={1} step={.01}\r\n                                onBlur={e => updateMaterial({...material,sales_discount:percentageParser(e.target.value)})}\r\n                                onStep={(val:number) => updateMaterial({...material,sales_discount:val})}\r\n                                formatter={asPercentage}\r\n                                parser={percentageParser}\r\n                                value={material.sales_discount} \r\n                                disabled={readOnly} />\r\n                        </div>\r\n\r\n                        <div className='flex_container block_space show4'>\r\n                            <Text>Quantity:</Text>\r\n                            <InputNumber min={1} style={{ marginLeft: 5 }} \r\n                                onBlur={e => updateMaterial({...material,quantity:Number(e.target.value)})}\r\n                                onStep={(val:number) => updateMaterial({...material,quantity:val})}\r\n                                value={material.quantity} \r\n                                disabled={readOnly} />\r\n                        </div>\r\n\r\n                        <Title level={5}>Final Price: {asMoney(material.finalprice)}</Title>\r\n\r\n                        <div className='flex_container_end show4'>\r\n                            <Button type={material&&isModified(material._modified)?\"primary\":\"ghost\"} shape=\"round\" icon={<SaveOutlined />} size='large' onClick={() => onClickSave()} disabled={readOnly || material.product_ref === undefined}>{item?\"Save\":\"Add\"}</Button>\r\n                            <Button type=\"primary\" shape=\"round\" icon={<CloseOutlined />} size='large' onClick={() => onCancel()} style={{ marginLeft: \"20px\" }}>Cancel</Button>\r\n                        </div>\r\n                    </Col>\r\n                </Row>\r\n            </Content>\r\n            <MaterialSearch \r\n                visible={showProductSearch} \r\n                currentID={ref2ProductSummary(material.product_ref)?.id} \r\n                color={material.color||\"\"} \r\n\r\n                handleCancel={() => setShowProductSearch(false)} \r\n                handleProduct={updateRef} \r\n            />\r\n        </Layout>\r\n    );\r\n};\r\n\r\nexport default MaterialDetail;","import React, { useEffect, useState } from 'react';\r\nimport '../Styles/main.css';\r\nimport { Layout, Spin } from 'antd';\r\nimport * as es from '../store/estimatesSlice';\r\nimport { useAppDispatch, useAppSelector } from '../store/hooks';\r\nimport { EstimateItem } from '../store/EstimateItem';\r\nimport { useHistory, useParams } from 'react-router';\r\nimport { DefaultMaterial, Material } from '../store/Material';\r\nimport { Estimate } from '../store/Estimate';\r\nimport { ModifiedState } from '../types/Status';\r\nimport { isReadOnly } from '../types/EstimateStatus';\r\nimport MaterialDetail from '../Components/ProductDetails/Material';\r\n\r\nconst { Content } = Layout;\r\n\r\nconst MaterialPage = () => {\r\n    const dispatch = useAppDispatch();\r\n    const [item, setItem] = useState<EstimateItem | undefined>(undefined)\r\n    const estimate: Estimate | undefined = useAppSelector(es.selectEstimate)\r\n    var params = useParams<{eid: string, iid: string}>();\r\n    const history = useHistory();\r\n\r\n    useEffect(() => {\r\n        // If we know the eid then load the estimate\r\n        if (params.eid && estimate === undefined)\r\n            dispatch(es.fetchEstimate(Number(params.eid)))\r\n        else\r\n            setItem({\r\n                ...DefaultMaterial,\r\n                estimateid: estimate && estimate.id ? estimate.id : 0,\r\n                _modified: ModifiedState.new\r\n            })\r\n    }, [dispatch, params.eid, estimate])\r\n\r\n    useEffect(() => {\r\n        if (params.iid && estimate && estimate.items)\r\n            setItem(estimate.items.find(i => i.id === Number(params.iid)))\r\n    }, [estimate, params.iid])\r\n\r\n    const onClose = () => {\r\n        if (history.length>0)\r\n            history.goBack()\r\n    }\r\n\r\n    const readOnly = isReadOnly(estimate)\r\n    \r\n    return (\r\n        <Layout className='material'>\r\n            <Content className='materialContainer'>\r\n                {item \r\n                    ?   <MaterialDetail\r\n                            estimate={estimate}\r\n                            item={item as Material}\r\n                            onClose={onClose}\r\n                            readOnly={readOnly}\r\n                        /> \r\n                    : <Spin size=\"large\" style={{ display: \"flex\", alignSelf: \"center\" }} />}\r\n            </Content>\r\n        </Layout>\r\n    );\r\n};\r\n\r\nexport default MaterialPage;","import { useCallback, useEffect, useMemo, useState } from 'react';\r\nimport { Modal, Select, Form, Button } from 'antd';\r\nimport './styles.css';\r\nimport { useAppSelector } from '../../store/hooks';\r\nimport * as ds from '../../store/defaultsSlice';\r\nimport * as ps from '../../store/productsSlice';\r\nimport { LoadingState } from '../../types/Status';\r\nimport ModuleType from '../../types/ModuleType';\r\n\r\ntype DesignSearchProps = {\r\n    visible: boolean\r\n    currentID: number|undefined\r\n    color: string\r\n\r\n    handleProduct: (id:number) => void\r\n    handleCancel: () => void\r\n}\r\nconst { Option } = Select;\r\n\r\nconst DesignSearch = (props: DesignSearchProps) => {\r\n    const [id, setID] = useState(props.currentID)\r\n    const [color, setColor] = useState(props.color)\r\n    const [provider, setProvider] = useState(\"\")\r\n    const [width, setWidth] = useState(\"\")\r\n    const [height, setHeight] = useState(\"\")\r\n    const [length, setLength] = useState(\"\")\r\n    const [ref, setRef] = useState(\"\")\r\n\r\n    const designColors = [\"WHITE\",\"BRONZE\",\"BLACK\",\"CLEAR ANADIS\"].map(n => ({value:n, label:n}))\r\n    \r\n    const defaultStatus = useAppSelector(ds.selectDefaultsStatus)\r\n    const defaults: ds.DefaultData | undefined = useAppSelector(ds.selectDefaults)\r\n    const products: ps.ProductSummary[] | undefined = useAppSelector(ps.selectProductSummaries)\r\n    const productsById: { [key: number]: ps.ProductSummary } | undefined = useAppSelector(ps.selectProductSummariesById)\r\n    const productsStatus = useAppSelector(ps.selectProductSummariesStatus)\r\n\r\n    const unspecified = useCallback((o:any) => o === undefined || o === \"None\" || o === \"Any\" || o === \"\" || o === \"0\" || o === 0, [])\r\n    const ifUnspecified = useCallback((o:any, alt:any) => unspecified(o) ? alt : o, [unspecified])\r\n    const id2ProductSummary = (id:number|undefined):ps.ProductSummary|undefined => productsById && id ? productsById[id] : undefined\r\n    const prodSummary = id2ProductSummary(props.currentID)\r\n\r\n    const resetSearch = useCallback(() => {\r\n        setColor(prodSummary?.color || props.color || \"Any\")\r\n        setProvider(ifUnspecified(prodSummary?.provider, \"Any\"))\r\n        setWidth(ifUnspecified(prodSummary?.widthtxt, \"Any\"))\r\n        setHeight(ifUnspecified(prodSummary?.heighttxt, \"Any\"))\r\n        setLength(ifUnspecified(prodSummary?.lengthtxt, \"Any\"))\r\n        setRef(ifUnspecified(prodSummary?.ref, \"None\"))\r\n    }, [prodSummary?.color, prodSummary?.provider, prodSummary?.widthtxt, prodSummary?.heighttxt, prodSummary?.lengthtxt, prodSummary?.ref, props.color, ifUnspecified])\r\n\r\n    const clearSearch = useCallback(() => {\r\n        setColor(ifUnspecified(props.color, \"Any\"))\r\n        setProvider(\"Any\")\r\n        setWidth(\"Any\")\r\n        setHeight(\"Any\")\r\n        setLength(\"Any\")\r\n        setRef(\"None\")\r\n    }, [ifUnspecified, props.color])\r\n\r\n    useEffect(() => {\r\n        resetSearch()\r\n    }, [props.visible, props.color, resetSearch])\r\n\r\n    const filterOption = (input: any, option: any) => {\r\n        const v = option.value.toLowerCase()\r\n        const i = input.toLowerCase()\r\n        return i===\"\" || (v !== null && (v?.indexOf(i) >= 0 || v.indexOf(i) >= 0))\r\n    }\r\n\r\n    const product2Label = (p:ps.ProductSummary|undefined):string => {\r\n        if (p)\r\n            return p.ref\r\n        return \"Any\"\r\n    }\r\n    const id2Ref = (id:number) => id2ProductSummary(id)?.ref\r\n    const designProducts = useMemo(() => products?.filter(p => p.modtype === ModuleType.Design),  [products])\r\n    const isCandidateProduct = useCallback((p:ps.ProductSummary) => {\r\n        let visible:boolean = true\r\n        visible = visible && (unspecified(color) || p.color === color)\r\n        visible = visible && (unspecified(provider) || p.provider === provider)\r\n        visible = visible && (unspecified(width) || p.widthtxt === width)\r\n        visible = visible && (unspecified(height) || p.heighttxt === height)\r\n        visible = visible && (unspecified(length) || p.lengthtxt === length)\r\n        return visible\r\n    }, [color, height, length, provider, unspecified, width])\r\n\r\n    const filterReferencesOptionsOnKeyPress = (input: any, option: any) => {\r\n        let p = unspecified(option.key)?undefined:id2ProductSummary(option.key)\r\n        let match:boolean = p!==undefined && isCandidateProduct(p)\r\n        match = match && filterOption(input,option)\r\n        return match\r\n    }\r\n    const selectProduct = (id:number) => {\r\n        setID(id)\r\n        setRef(id2Ref(id)||\"\")\r\n    }\r\n\r\n    const candidateProducts = useMemo(() => designProducts?.filter(isCandidateProduct),  [isCandidateProduct, designProducts])\r\n    const refs = useMemo(() => candidateProducts?.map(p => <Option value={product2Label(p)} key={p.id}>{product2Label(p)}</Option>), [candidateProducts])\r\n    const widthValues = useMemo(() => {\r\n        const wMap:{[key:string]: string} = {}\r\n        designProducts?.forEach(p => {\r\n            if (p.widthtxt)\r\n                wMap[p.widthtxt] = p.widthtxt\r\n        })\r\n        return Object.keys(wMap).map(w => <Option value={w} key={w}>{w}</Option>)\r\n    }, [designProducts])\r\n    const heightValues = useMemo(() => {\r\n        const hMap:{[key:string]: string} = {}\r\n        designProducts?.forEach(p => {\r\n            if (p.heighttxt)\r\n                hMap[p.heighttxt] = p.heighttxt\r\n        })\r\n        return Object.keys(hMap).map(h => <Option value={h} key={h}>{h}</Option>)\r\n    }, [designProducts])\r\n\r\n    return (\r\n        <Modal\r\n            title=\"Search Products\"\r\n            visible={props.visible} \r\n            onCancel={props.handleCancel}\r\n            onOk={() => id && props.handleProduct(id)}\r\n            okButtonProps={{ disabled: !id }}\r\n            footer={[\r\n                <Button key=\"OK\" onClick={() => id && props.handleProduct(id)} disabled={unspecified(ref)}>\r\n                  OK\r\n                </Button>,\r\n                <Button key=\"Cancel\"onClick={props.handleCancel}>\r\n                  Cancel\r\n                </Button>,\r\n                <Button key=\"Clear\"onClick={clearSearch} style={{ marginLeft: \"1rem\"}}>\r\n                    Clear\r\n                </Button>\r\n            ]}\r\n        >\r\n            <Form\r\n                name=\"product-search\"\r\n                labelCol={{ span: 8 }}\r\n                wrapperCol={{ span: 16 }}\r\n                autoComplete=\"off\"\r\n            >\r\n                <Form.Item label=\"Provider\">\r\n                    <Select<string>\r\n                        showSearch\r\n                        className='input show1'\r\n                        optionFilterProp=\"label\"\r\n                        onChange={(txt:string,option:any) => setProvider(option.value)}\r\n                        filterOption={filterOption}\r\n                        value={provider}\r\n                        loading ={defaultStatus===LoadingState.loading}\r\n                        placeholder=\"Select Provider...\"\r\n                    >\r\n                        <Option value=\"Any\" key=\"0\">Any</Option>\r\n                        {defaults?.providers.map(p => <Option value={p.label} key={p.value}>{p.label}</Option>)}\r\n                    </Select>\r\n                </Form.Item>\r\n\r\n                <Form.Item label=\"Color\">\r\n                    <Select\r\n                            showSearch\r\n                            className='input show1'\r\n                            optionFilterProp=\"value\"\r\n                            onChange={(input:string,option:any) => option&&setColor(option.key) }\r\n                            filterOption={(input:string,option:any) => option?.value ? option.value.toString().toLowerCase().indexOf(input.toLowerCase()) >= 0 : true }\r\n                            value={color}\r\n                        >\r\n                        <Option value=\"Any\" key=\"Any\">Any</Option>\r\n                        {designColors.filter(cd => cd.label!==\"NONE\").map(cd => <Option value={cd.label} key={cd.label}>{cd.label}</Option>)}\r\n                    </Select>\r\n                </Form.Item>\r\n\r\n                <Form.Item label=\"Width\">\r\n                    <Select\r\n                            showSearch\r\n                            className='input show1'\r\n                            optionFilterProp=\"value\"\r\n                            onChange={(input:string,option:any) => option&&setWidth(option.key) }\r\n                            filterOption={(input:string,option:any) => option?.value ? option.value.toString().toLowerCase().indexOf(input.toLowerCase()) >= 0 : true }\r\n                            value={width}\r\n                        >\r\n                        <Option value=\"Any\" key=\"Any\">Any</Option>\r\n                        {widthValues}\r\n                    </Select>\r\n                </Form.Item>\r\n\r\n                <Form.Item label=\"Height\">\r\n                    <Select\r\n                            showSearch\r\n                            className='input show1'\r\n                            optionFilterProp=\"value\"\r\n                            onChange={(input:string,option:any) => option&&setHeight(option.key) }\r\n                            filterOption={(input:string,option:any) => option?.value ? option.value.toString().toLowerCase().indexOf(input.toLowerCase()) >= 0 : true }\r\n                            value={height}\r\n                        >\r\n                        <Option value=\"Any\" key=\"Any\">Any</Option>\r\n                        {heightValues}\r\n                    </Select>\r\n                </Form.Item>\r\n\r\n                <Form.Item label={\"References (\"+refs?.length+\")\"}>\r\n                    <Select\r\n                        showSearch\r\n                        className='input show1'\r\n                        optionFilterProp=\"ref\"\r\n                        onChange={(input:string,option:any) => option ? selectProduct(Number(option.key)) : selectProduct(0) }\r\n                        filterOption={filterReferencesOptionsOnKeyPress}\r\n                        value={ref}\r\n                        loading ={productsStatus===LoadingState.loading}\r\n                        placeholder=\"Select Product Reference...\"\r\n                    >\r\n                        <Option value=\"None\" key=\"0\">None</Option>\r\n                        {refs}\r\n                    </Select> \r\n                </Form.Item>\r\n            </Form>\r\n        </Modal>\r\n    );\r\n};\r\n\r\nexport default DesignSearch;","import { useEffect, useState } from 'react';\r\nimport '../../Styles/main.css';\r\nimport { Layout, Row, Col, Typography, InputNumber, Input, Divider, Button, Image, notification } from 'antd';\r\nimport { CloseOutlined, SaveOutlined } from '@ant-design/icons';\r\nimport { createItemTotals, DefaultDesign, Design } from '../../store/Design';\r\nimport * as ds from '../../store/defaultsSlice';\r\nimport * as ps from '../../store/productsSlice';\r\nimport * as es from '../../store/estimatesSlice';\r\nimport { useAppDispatch, useAppSelector } from '../../store/hooks';\r\nimport { isModified, isNew, ModifiedState } from '../../types/Status';\r\nimport { Estimate } from '../../store/Estimate';\r\nimport { asMoney, asPercentage, percentageParser } from '../../types/formats';\r\nimport {id2ItemType} from '../../types/ItemType';\r\nimport useModifiedAlert from '../../effects/useModifiedAlert';\r\nimport ModuleType from '../../types/ModuleType';\r\nimport store from '../../store/store';\r\nimport DesignSearch from '../ModalOptions/DesignSearch';\r\n\r\nconst { Content } = Layout;\r\nconst { Title, Text } = Typography;\r\n\r\ntype DesignProps = {\r\n    estimate?:Estimate\r\n    item?:Design,\r\n    onClose?: () => void\r\n    readOnly: boolean\r\n}\r\n\r\nexport type ProviderName = {\r\n    value: string\r\n    label: string\r\n}\r\n\r\nconst createInitialProductCopy = (item:Design|undefined):Design => {\r\n    return item ? { ...item } : { ...DefaultDesign }\r\n}\r\n\r\nconst DesignDetail = ({estimate, item, onClose, readOnly}:DesignProps) => {\r\n    const products: ps.ProductSummary[] | undefined = useAppSelector(ps.selectProductSummaries)\r\n    const productsByRef: { [key: string]: ps.ProductSummary } | undefined = useAppSelector(ps.selectProductSummariesByRef)\r\n    const defaults: ds.DefaultData | undefined = useAppSelector(ds.selectDefaults)\r\n    const dispatch = useAppDispatch()\r\n    const [design, setDesign] = useState<Design>(() => createInitialProductCopy(item))\r\n    const [showProductSearch, setShowProductSearch] = useState<boolean>(false)\r\n\r\n    useEffect(() => {\r\n        if (defaults?.colors.length === 0)\r\n            dispatch(ds.fetchDefaults())\r\n    }, [dispatch, defaults])\r\n\r\n    useEffect(() => {\r\n        if (products === undefined || products.length === 0)\r\n            dispatch(ps.fetchProductSummaries())\r\n    }, [dispatch, products])\r\n\r\n    useModifiedAlert(estimate, item)\r\n\r\n    const onClickSave = () => {\r\n        saveAndClose(design)\r\n    }\r\n\r\n    const saveAndClose = (p:Design|null) => {\r\n        if (p)\r\n            updateOrSave(p)\r\n       onClose && onClose();\r\n    }\r\n\r\n    const updateOrSave = async (p:Design) => {\r\n        if (isNew(p._modified) && p.id === 0)\r\n            await dispatch(es.addItem(p))\r\n        else\r\n            await dispatch(es.updateItem(p))\r\n\r\n        let e:Estimate|undefined = store.getState().estimates.estimate\r\n        if (e && e.id) {\r\n            dispatch(es.saveEstimate(e)).then((res:any)=>  notification.success({\r\n                message: \"Save Estimate\",\r\n                description: \"Success!\",\r\n                duration: 10\r\n            }))\r\n        }\r\n    }\r\n    const onCancel = () => {\r\n        onClose && onClose();\r\n    }\r\n\r\n    const undefinedOrNone = (o:any) => o === undefined || o === \"Undefined\" || o === \"\"\r\n    const ref2ProductSummary = (ref:string|undefined):ps.ProductSummary|undefined => (productsByRef&&ref) ? productsByRef[ref] : undefined\r\n\r\n    if (design && estimate) {\r\n        const t = createItemTotals(estimate, design, estimate?.customer)\r\n        if (design.sales_price !== t.sales_price || design.finalprice !== t.finalprice)\r\n            setDesign({\r\n                ...design,\r\n                sales_price: t.sales_price,\r\n                finalprice: t.finalprice\r\n            })\r\n    }\r\n\r\n    // The reference dropdown contains a list of the product summaries \r\n    // It should show the product used to originally fill in this Design\r\n    // If we change it we must update the associated properties in this design\r\n    const updateRef = (id:number) => {\r\n        setShowProductSearch(false)\r\n        dispatch(ps.fetchProductDetailsById(id)).then((details:any) => {\r\n            let p:ps.ProductDetails=details.payload\r\n   \r\n            let newM:Design = {\r\n                ...design,\r\n                _modified: isModified(design._modified) ? design._modified : ModifiedState.modified,\r\n                color: p.color,\r\n                cost_price: p.cost_price || 0,\r\n                height: p.height,\r\n                heighttxt: p.heighttxt||undefined,\r\n                image: p.image,\r\n                inst_price: p.inst_price || 0,\r\n                itemtype: id2ItemType(p.itemtype),\r\n                modtype: p.modtype || ModuleType.Design,\r\n                name: p.name,\r\n                product_ref: p.ref,\r\n                provider: p.provider,\r\n                sales_price: p.sales_price || 0,\r\n                width: p.width,\r\n                widthtxt: p.widthtxt || undefined,\r\n                wintype: p.wintype,\r\n            }\r\n            updateDesign(newM)\r\n        })\r\n    }\r\n\r\n    const updateDesign = (newM:Design) => {\r\n        setDesign({\r\n            ...newM,\r\n            _modified: isNew(newM._modified) ? ModifiedState.new : ModifiedState.modified\r\n        });\r\n    }\r\n\r\n    return (\r\n        <Layout className='layout'>\r\n            <Content>\r\n                <Title level={2} style={{ color: '#32445e' }}>Design</Title>\r\n                <Row gutter={[24, 24]}>\r\n                    <Col xs={24} sm={24} md={12} lg={12} xl={12}>\r\n                        <Title level={5}>Reference Product</Title>\r\n                        <Button onClick={() => setShowProductSearch(true)} disabled={readOnly}>{design.product_ref || \"Choose...\"}</Button>\r\n\r\n                        <Divider />\r\n                        <Title level={5}>Provider</Title>\r\n                        <Input className='input show4' placeholder='Provider' disabled={true} value={undefinedOrNone(design.provider)?\"None\":design.provider}/>\r\n\r\n                        <Title level={5}>Type of Opening</Title>\r\n                        <Input className='input show4' placeholder='Type of Opening' disabled={true} value={design.itemtype||\"\"}/>\r\n\r\n                        <Title level={5}>Type</Title>\r\n                        <Input className='input show4' placeholder='Type' disabled={true} value={design.wintype}/>\r\n\r\n                        <Title level={5}>Color</Title>\r\n                        <Input className='input show1' placeholder='Frame' disabled={true} value={design.color} />\r\n\r\n                        <div className='flex_container_center block_space'>\r\n                            <Image.PreviewGroup>\r\n                                <Image hidden={design.image === undefined || design.image === \"\"}\r\n                                    className='img' src={(process.env.REACT_APP_URL_PREFIX||\"\") + design.image} alt={design.name}\r\n                                />\r\n                            </Image.PreviewGroup>\r\n                        </div>\r\n\r\n                    </Col>\r\n\r\n                    <Col xs={24} sm={24} md={12} lg={12} xl={12}>\r\n\r\n                        <Title level={5}>Sizes</Title>\r\n                        <div className='flex_container block_space show4'>\r\n                            <Text>W:</Text>\r\n                            <Input hidden={true} value={design.width}/>\r\n                            <Input style={{ marginLeft: 5, marginRight: 15 }} value={design.widthtxt} disabled={true} />\r\n                            <Text>H:</Text>\r\n                            <Input hidden={true} value={design.height}/>\r\n                            <Input style={{ marginLeft: 5, marginRight: 15 }} value={design.heighttxt} disabled={true} />\r\n                        </div>\r\n\r\n                        <Divider />\r\n\r\n                        <Title level={5}>Sales Price &amp; Discount %</Title>\r\n                        <div className='flex_container block_space'>\r\n                            <InputNumber className='input show4' placeholder='Price' style={{ marginRight: 20 }} disabled={true} \r\n                                value={design.sales_price}\r\n                                formatter={asMoney}\r\n                            />\r\n                            <InputNumber className='input' placeholder='Discount' min={0} max={1} step={.01}\r\n                                onBlur={e => updateDesign({...design,sales_discount:percentageParser(e.target.value)})}\r\n                                onStep={(val:number) => updateDesign({...design,sales_discount:val})}\r\n                                formatter={asPercentage}\r\n                                parser={percentageParser}\r\n                                value={design.sales_discount} \r\n                                disabled={readOnly} />\r\n                        </div>\r\n\r\n                        <Title level={5}>Final Price: {asMoney(design.finalprice)}</Title>\r\n\r\n                        <div className='flex_container_end show4'>\r\n                            <Button type={design&&isModified(design._modified)?\"primary\":\"ghost\"} shape=\"round\" icon={<SaveOutlined />} size='large' onClick={() => onClickSave()} disabled={readOnly || design.product_ref === undefined}>{item?\"Save\":\"Add\"}</Button>\r\n                            <Button type=\"primary\" shape=\"round\" icon={<CloseOutlined />} size='large' onClick={() => onCancel()} style={{ marginLeft: \"20px\" }}>Cancel</Button>\r\n                        </div>\r\n                    </Col>\r\n                </Row>\r\n            </Content>\r\n            <DesignSearch \r\n                visible={showProductSearch} \r\n                currentID={ref2ProductSummary(design.product_ref)?.id} \r\n                color={design.color||\"\"} \r\n\r\n                handleCancel={() => setShowProductSearch(false)} \r\n                handleProduct={updateRef} \r\n            />\r\n        </Layout>\r\n    );\r\n};\r\n\r\nexport default DesignDetail;","import React, { useEffect, useState } from 'react';\r\nimport '../Styles/main.css';\r\nimport { Layout, Spin } from 'antd';\r\nimport * as es from '../store/estimatesSlice';\r\nimport { useAppDispatch, useAppSelector } from '../store/hooks';\r\nimport { EstimateItem } from '../store/EstimateItem';\r\nimport { useHistory, useParams } from 'react-router';\r\nimport { DefaultDesign, Design } from '../store/Design';\r\nimport { Estimate } from '../store/Estimate';\r\nimport { ModifiedState } from '../types/Status';\r\nimport { isReadOnly } from '../types/EstimateStatus';\r\nimport DesignDetail from '../Components/ProductDetails/Design';\r\n\r\nconst { Content } = Layout;\r\n\r\nconst DesignPage = () => {\r\n    const dispatch = useAppDispatch();\r\n    const [item, setItem] = useState<EstimateItem | undefined>(undefined)\r\n    const estimate: Estimate | undefined = useAppSelector(es.selectEstimate)\r\n    var params = useParams<{eid: string, iid: string}>();\r\n    const history = useHistory();\r\n\r\n    useEffect(() => {\r\n        // If we know the eid then load the estimate\r\n        if (params.eid && estimate === undefined)\r\n            dispatch(es.fetchEstimate(Number(params.eid)))\r\n        else\r\n            setItem({\r\n                ...DefaultDesign,\r\n                estimateid: estimate && estimate.id ? estimate.id : 0,\r\n                _modified: ModifiedState.new\r\n            })\r\n    }, [dispatch, params.eid, estimate])\r\n\r\n    useEffect(() => {\r\n        if (params.iid && estimate && estimate.items)\r\n            setItem(estimate.items.find(i => i.id === Number(params.iid)))\r\n    }, [estimate, params.iid])\r\n\r\n    const onClose = () => {\r\n        if (history.length>0)\r\n            history.goBack()\r\n    }\r\n\r\n    const readOnly = isReadOnly(estimate)\r\n    \r\n    return (\r\n        <Layout className='design'>\r\n            <Content className='designContainer'>\r\n                {item \r\n                    ?   <DesignDetail\r\n                            estimate={estimate}\r\n                            item={item as Design}\r\n                            onClose={onClose}\r\n                            readOnly={readOnly}\r\n                        /> \r\n                    : <Spin size=\"large\" style={{ display: \"flex\", alignSelf: \"center\" }} />}\r\n            </Content>\r\n        </Layout>\r\n    );\r\n};\r\n\r\nexport default DesignPage;","import ItemType from '../types/ItemType';\r\nimport ModuleType from '../types/ModuleType';\r\nimport WinType from '../types/WinType';\r\nimport { CustomerDetails, reltype2Markup } from \"./customersSlice\";\r\nimport { Estimate } from './Estimate';\r\nimport { DefaultEstimateItem, EstimateItem } from \"./EstimateItem\";\r\n\r\nexport interface HardwareTotals {\r\n    sales_price: number\r\n    finalprice: number\r\n}\r\n\r\nexport interface Hardware extends EstimateItem {\r\n    provider?:string\r\n    product_ref?:string\r\n    hardwaretype?:string\r\n    configuration?:string\r\n}\r\n\r\nexport const DefaultHardware:Hardware = {\r\n    ...DefaultEstimateItem,\r\n    itemtype: ItemType.Hardware,\r\n    modtype: ModuleType.Hardware,\r\n    provider:undefined,\r\n    product_ref:undefined,\r\n    hardwaretype:undefined,\r\n    configuration:undefined,\r\n    wintype: WinType.None,\r\n}\r\n\r\nexport const createItemTotals = (e:Estimate, i:Hardware|undefined, c:CustomerDetails|undefined):HardwareTotals => {\r\n    if (i) {\r\n        const sales_price = Math.round(\r\n            ((i.cost_price||0)\r\n            + (i.cost_price||0) * reltype2Markup(c?.reltype))*100)/100\r\n    \r\n        const finalprice = \r\n            sales_price\r\n            - (i.cost_price||0) * (i.sales_discount||0)\r\n            + (e.is_installation_included ? (i.inst_price||0) - (i.inst_price||0) * (i.inst_discount||0) : 0)\r\n        return {\r\n            sales_price,\r\n            finalprice\r\n        }\r\n    }\r\n    \r\n    return {\r\n        sales_price:0,\r\n        finalprice:0\r\n    }\r\n}\r\n","import { useEffect, useState } from 'react';\r\nimport '../../Styles/main.css';\r\nimport { CloseOutlined, SaveOutlined } from '@ant-design/icons';\r\nimport { Layout, Row, Col, Typography, Select, Input, InputNumber, Divider, Button, Popconfirm, Image, notification } from 'antd';\r\nimport { createItemTotals, DefaultHardware, Hardware } from '../../store/Hardware';\r\nimport * as ds from '../../store/defaultsSlice';\r\nimport * as ps from '../../store/productsSlice';\r\nimport * as es from '../../store/estimatesSlice';\r\nimport { useAppDispatch, useAppSelector } from '../../store/hooks';\r\nimport { WarningOutlined } from '@ant-design/icons';\r\nimport { isModified, isNew, LoadingState, ModifiedState } from '../../types/Status';\r\nimport { useHistory } from 'react-router';\r\nimport { Estimate } from '../../store/Estimate';\r\nimport { asMoney, asPercentage, percentageParser } from '../../types/formats';\r\nimport useModifiedAlert from '../../effects/useModifiedAlert';\r\nimport ModuleType from '../../types/ModuleType';\r\nimport store from '../../store/store';\r\n\r\nconst { Content } = Layout;\r\nconst { Title } = Typography;\r\nconst { Option } = Select;\r\n\r\ntype HardwareProps = {\r\n    estimate?:Estimate\r\n    item?:Hardware\r\n    onClose?: () => void\r\n    readOnly: boolean\r\n}\r\n\r\nconst createInitialProductCopy = (item:Hardware|undefined):Hardware => {\r\n    return item ? { ...item } : { ...DefaultHardware }\r\n}\r\n\r\nconst HardwareDetail = ({estimate, item, onClose, readOnly}:HardwareProps) => {\r\n    const products: ps.ProductSummary[] | undefined = useAppSelector(ps.selectProductSummaries)\r\n    const productsById: { [key: number]: ps.ProductSummary } | undefined = useAppSelector(ps.selectProductSummariesById)\r\n    const productsByRef: { [key: string]: ps.ProductSummary } | undefined = useAppSelector(ps.selectProductSummariesByRef)\r\n    const productsStatus = useAppSelector(ps.selectProductSummariesStatus)\r\n    const defaults: ds.DefaultData | undefined = useAppSelector(ds.selectDefaults)\r\n    const defaultStatus = useAppSelector(ds.selectDefaultsStatus)\r\n    const dispatch = useAppDispatch();\r\n    const history = useHistory();\r\n    const [hardware, setHardware] = useState<Hardware>(() => createInitialProductCopy(item))\r\n\r\n    useEffect(() => {\r\n        if (defaults?.colors.length === 0)\r\n            dispatch(ds.fetchDefaults())\r\n    }, [dispatch, defaults])\r\n\r\n    useEffect(() => {\r\n        if (products === undefined || products.length === 0)\r\n            dispatch(ps.fetchProductSummaries())\r\n    }, [dispatch, products])\r\n\r\n    useModifiedAlert(estimate, item)\r\n\r\n    const handleSubmit = () => {\r\n        history.goBack()\r\n    }\r\n\r\n    const onSave = async () => {\r\n        if (isNew(hardware._modified) && hardware.id === 0)\r\n            await dispatch(es.addItem(hardware))\r\n        else\r\n            await dispatch(es.updateItem(hardware))\r\n            \r\n        let e:Estimate|undefined = store.getState().estimates.estimate\r\n        if (e && e.id) {\r\n            dispatch(es.saveEstimate(e)).then((res:any)=>  notification.success({\r\n                message: \"Save Estimate\",\r\n                description: \"Success!\",\r\n                duration: 10\r\n            }))\r\n        }\r\n        onClose && onClose();\r\n    }\r\n\r\n    const onCancel = () => {\r\n        onClose && onClose();\r\n    }\r\n\r\n    const product2Label = (p:ps.ProductSummary|undefined):string => {\r\n        if (p)\r\n            return p.id + \" - \" + p.name + \" - \" + p.ref\r\n        return \"None\"\r\n    }\r\n    const undefinedOrNone = (o:any) => o === undefined || o === \"None\" || o === \"\"\r\n    const id2ProductSummary = (id:number):ps.ProductSummary|undefined => productsById ? productsById[id] : undefined\r\n    const ref2ProductSummary = (ref:string|undefined):ps.ProductSummary|undefined => (productsByRef&&ref) ? productsByRef[ref] : undefined\r\n    const filterOption = (input: any, option: any) => {\r\n        const v = option.value.toLowerCase()\r\n        const i = input.toLowerCase()\r\n        return i===\"\" || (v !== null && (v?.indexOf(i) >= 0 || v.indexOf(i) >= 0))\r\n    }\r\n    const isVisibleProductSummary = (p:ps.ProductSummary) => {\r\n        let visible:boolean = undefinedOrNone(hardware.provider) || p.provider === hardware.provider\r\n        visible = visible && p.modtype === ModuleType.Hardware\r\n        return visible\r\n    } \r\n    const filterReferencesOptionsOnKeyPress = (input: any, option: any) => {\r\n        let p = undefinedOrNone(option.key)?undefined:id2ProductSummary(option.key)\r\n        let match:boolean = p!==undefined && isVisibleProductSummary(p)\r\n        match = match && filterOption(input, option)\r\n        return match\r\n    }\r\n\r\n    if (hardware && estimate) {\r\n        const t = createItemTotals(estimate, hardware, estimate?.customer)\r\n        if (hardware.sales_price !== t.sales_price || hardware.finalprice !== t.finalprice)\r\n            setHardware({\r\n                ...hardware,\r\n                sales_price: t.sales_price,\r\n                finalprice: t.finalprice\r\n            })\r\n    }\r\n\r\n    // The reference dropdown contains a list of the product summaries \r\n    // It should show the product used to originally fill in this Hardware\r\n    // If we change it we must update the associated properties in this hardware\r\n    const updateRef = (id:number) => {\r\n        dispatch(ps.fetchProductDetailsById(id)).then((details:any) => {\r\n            let p:ps.ProductDetails=details.payload\r\n            let newIP:Hardware = {\r\n                ...hardware,\r\n                _modified: isModified(hardware._modified) ? hardware._modified : ModifiedState.modified,\r\n                color: p.color,\r\n                image: p.image,\r\n                inst_price: p.inst_price || 0,\r\n                name: p.name,\r\n                product_ref: p.ref,\r\n                provider: p.provider,\r\n                cost_price: p.cost_price || 0,\r\n                sales_price: p.sales_price || 0,\r\n                configuration: p.configuration,\r\n                hardwaretype: p.hardwaretype\r\n            }\r\n            updateHardware(newIP)\r\n        })\r\n    }\r\n\r\n    const updateHardware = (newHW:Hardware) => {\r\n        setHardware({\r\n            ...newHW,\r\n            _modified: isNew(newHW._modified) ? ModifiedState.new : ModifiedState.modified\r\n        });\r\n    }\r\n\r\n    return (\r\n        <Layout className='layout'>\r\n            <Content>\r\n                <Title level={2} style={{ color: '#32445e' }}>Hardware</Title>\r\n                <Row gutter={[24, 24]}>\r\n                    <Col xs={24} sm={24} md={12} lg={12} xl={12}>\r\n                        <Title level={5}>Provider</Title>\r\n                        <Select\r\n                            showSearch\r\n                            className='input show1'\r\n                            optionFilterProp=\"label\"\r\n                            onChange={(txt:string,p:any) => updateHardware({...hardware,provider: p.value})}\r\n                            filterOption={filterOption}\r\n                            value={undefinedOrNone(hardware.provider)?\"None\":hardware.provider}\r\n                            loading ={defaultStatus===LoadingState.loading}\r\n                            placeholder=\"Select Provider...\"\r\n                            disabled={readOnly}\r\n                            >\r\n                                <Option value=\"None\" key=\"None\">None</Option>\r\n                                {defaults?.providers.map(p => <Option value={p.label} key={p.value}>{p.label}</Option>)}\r\n                            </Select>\r\n                        {defaultStatus===LoadingState.failed ? <WarningOutlined style={{ marginLeft: \"1rem\", display: \"flex\", alignSelf: \"center\" }} /> : null}\r\n\r\n                        <Title level={5}>Reference</Title>\r\n                        <Select\r\n                            showSearch\r\n                            className='input show1'\r\n                            optionFilterProp=\"ref\"\r\n                            onChange={(input:string,p:any) => p&&updateRef(Number(p.key))}\r\n                            filterOption={filterReferencesOptionsOnKeyPress}\r\n                            value={product2Label(ref2ProductSummary(hardware.product_ref))}\r\n                            loading ={productsStatus===LoadingState.loading}\r\n                            placeholder=\"Select Product Reference...\"\r\n                            disabled={readOnly}\r\n                        >\r\n                            <Option value=\"None\" key=\"0\">None</Option>\r\n                            {products?.filter(isVisibleProductSummary).map(p => <Option value={product2Label(p)} key={p.id}>{product2Label(p)}</Option>)}\r\n                        </Select>\r\n\r\n                        <Divider />\r\n\r\n                        <Title level={5}>Hardware Type</Title>\r\n                        <Input className='input show4' placeholder='Hardware Type' disabled={true}  value={hardware?.hardwaretype} />\r\n\r\n                        <Title level={5}>Configuration</Title>\r\n                        <Input className='input show3' placeholder='Configuration' disabled={true} value={hardware?.configuration}/>\r\n\r\n                        <Title level={5}>Color</Title>\r\n                        <Input className='input show1' placeholder='Color' disabled={true} value={hardware?.color} />\r\n                    </Col>\r\n\r\n                    <Col xs={24} sm={24} md={12} lg={12} xl={12}>\r\n\r\n                        {estimate?.is_installation_included ?\r\n                            <>\r\n                                <Title level={5}>Installation &amp; Discount %</Title>\r\n                                <div className='flex_container block_space show1'>\r\n                                    <InputNumber className='input' placeholder='Installation' style={{ marginRight: 20 }} disabled={true}\r\n                                        formatter={asMoney}\r\n                                        value={hardware.inst_price}\r\n                                    />\r\n                                    <InputNumber className='input' placeholder='Discount' min={0} max={1} step={.01} \r\n                                        onBlur={e => updateHardware({...hardware,inst_discount:percentageParser(e.target.value)})}\r\n                                        onStep={(val:number) => updateHardware({...hardware,inst_discount:val})}\r\n                                        formatter={asPercentage}\r\n                                        parser={percentageParser}\r\n                                        value={hardware.inst_discount} \r\n                                        disabled={readOnly}\r\n                                        />\r\n                                </div>\r\n                            </>:\"\"\r\n                        }\r\n\r\n                        <Title level={5}>Sales Price &amp; Discount %</Title>\r\n                        <div className='flex_container block_space'>\r\n                            <InputNumber className='input show4' placeholder='Price' style={{ marginRight: 20 }} disabled={true} \r\n                                formatter={asMoney}\r\n                                value={hardware.sales_price}\r\n                            />\r\n                            <InputNumber className='input' placeholder='Discount' min={0} max={1} step={.01} \r\n                                onBlur={e => updateHardware({...hardware,sales_discount:percentageParser(e.target.value)})}\r\n                                onStep={(val:number) => updateHardware({...hardware,sales_discount:val})}\r\n                                formatter={asPercentage}\r\n                                parser={percentageParser}\r\n                                value={hardware.sales_discount} \r\n                                disabled={readOnly}\r\n                                />\r\n                        </div>\r\n\r\n                        <Title level={5}>Final Price: {asMoney(hardware.finalprice)}</Title>\r\n\r\n                        <Divider />\r\n                        <div className='flex_container_center block_space'>\r\n                            <Image.PreviewGroup>\r\n                                <Image hidden={hardware.image === undefined || hardware.image === \"\"}\r\n                                    className='img' src={(process.env.REACT_APP_URL_PREFIX||\"\") + hardware.image} alt={hardware.name}\r\n                                />\r\n                            </Image.PreviewGroup>\r\n                        </div>\r\n\r\n                    </Col>\r\n                    <Col xs={24} sm={24} md={12} lg={12} xl={12}>\r\n                    </Col>\r\n                    <Col xs={24} sm={24} md={12} lg={12} xl={12}>\r\n                        <div className='flex_container_center show4'>\r\n                            <Popconfirm placement=\"top\" title='Do you want to include a hardware?' onConfirm={() => handleSubmit()} okText=\"Yes\" cancelText=\"No\">\r\n                                <Button type={hardware&&isModified(hardware._modified)?\"primary\":\"ghost\"} shape=\"round\" icon={<SaveOutlined />} size='large' onClick={() => onSave()} disabled={readOnly || hardware.product_ref === undefined}>{hardware?\"Save\":\"Add\"}</Button>\r\n                                <Button type=\"primary\" shape=\"round\" icon={<CloseOutlined />} size='large' onClick={() => onCancel()} style={{ marginLeft: \"20px\" }}>Cancel</Button>\r\n                            </Popconfirm>\r\n                        </div>\r\n                    </Col>\r\n                </Row>\r\n            </Content>\r\n        </Layout>\r\n    );\r\n};\r\n\r\nexport default HardwareDetail;","import React, { useEffect, useState } from 'react';\r\nimport '../Styles/main.css';\r\nimport { Layout, Spin } from 'antd';\r\nimport * as es from '../store/estimatesSlice';\r\nimport { useAppDispatch, useAppSelector } from '../store/hooks';\r\nimport HardwareDetail from '../Components/ProductDetails/Hardware';\r\nimport { EstimateItem } from '../store/EstimateItem';\r\nimport { useHistory, useParams } from 'react-router';\r\nimport { Hardware, DefaultHardware } from '../store/Hardware';\r\nimport { Estimate } from '../store/Estimate';\r\nimport { ModifiedState } from '../types/Status';\r\nimport { isReadOnly } from '../types/EstimateStatus';\r\n\r\nconst { Content } = Layout;\r\n\r\nconst HardwarePage = () => {\r\n    const dispatch = useAppDispatch();\r\n    const [item, setItem] = useState<EstimateItem | undefined>(undefined)\r\n    const estimate: Estimate | undefined = useAppSelector(es.selectEstimate)\r\n    var params = useParams<{eid: string, iid: string}>();\r\n    const history = useHistory();\r\n\r\n    useEffect(() => {\r\n        // If we know the eid then load the estimate\r\n        if (params.eid && estimate === undefined)\r\n            dispatch(es.fetchEstimate(Number(params.eid)))\r\n        else\r\n            setItem({\r\n                ...DefaultHardware,\r\n                estimateid: estimate && estimate.id ? estimate.id : 0,\r\n                _modified: ModifiedState.new\r\n            })\r\n    }, [dispatch, params.eid, estimate])\r\n\r\n    useEffect(() => {\r\n        if (params.iid && estimate && estimate.items)\r\n            setItem(estimate.items.find(i => i.id === Number(params.iid)))\r\n    }, [estimate, params.iid])\r\n\r\n    const readOnly = isReadOnly(estimate)\r\n\r\n    return (\r\n        <Layout className='hardware'>\r\n            <Content className='hardwareContainer'>\r\n                {item \r\n                    ?   <HardwareDetail\r\n                            estimate={estimate}\r\n                            item={item as Hardware}\r\n                            onClose={history.length>0?()=>history.goBack():undefined}\r\n                            readOnly={readOnly}\r\n                        /> \r\n                    : <Spin size=\"large\" style={{ display: \"flex\", alignSelf: \"center\" }} />}\r\n            </Content>\r\n        </Layout>\r\n    );\r\n};\r\n\r\nexport default HardwarePage;","import { Button, Divider, Space } from \"antd\"\r\nimport Title from \"antd/lib/typography/Title\";\r\nimport { useHistory, useParams } from \"react-router\";\r\nimport { MenuItemData, MenuItemInfo, useAppRoutes } from \"../routes\";\r\n\r\ninterface NoPrintProps {\r\n    getMenuItems: (eid:number, history:any) => MenuItemInfo[]\r\n}\r\n\r\nconst NoPrint = ({getMenuItems}:NoPrintProps) => {\r\n    const appRoutes = useAppRoutes()\r\n    const history = useHistory()\r\n    const { eid } = useParams<{eid?:string}>()\r\n\r\n    return (\r\n        <Space direction=\"vertical\" align=\"center\" style={{width: \"100%\", marginTop: \"4em\"}}>\r\n            <Title>Please do not print this page.</Title>\r\n            <Button type=\"primary\" onClick={() => history.goBack()} style={{marginBottom: \"4em\"}}>Back</Button>\r\n            {getMenuItems(Number(eid), appRoutes).map(mi => {\r\n                    if (mi === \"div\")\r\n                        return <Divider style={{margin: \"1em 0em\", width: \"10em\"}}/>\r\n                    const md = mi as MenuItemData \r\n                    return <Button type=\"primary\" onClick={md.onclick}>{md.title}</Button>\r\n                })\r\n            }\r\n        </Space>\r\n    )\r\n}\r\n\r\nexport default NoPrint","import { Col, Row } from \"antd\";\r\nimport Text from \"antd/lib/typography/Text\";\r\nimport Title from \"antd/lib/typography/Title\";\r\nimport { EstimateTotals } from \"../../store/EstimateTotals\";\r\nimport { asMoney } from \"../../types/formats\";\r\n\r\nexport type TotalsTableProps = {\r\n    totals:EstimateTotals\r\n}\r\n\r\nconst cs1 =  {xs:2,     sm:8,   md:8,   lg:12,  xl:12}\r\nconst cs2 =  {xs:14,    sm:10,  md:10,  lg:8,   xl:8}\r\nconst cs3 =  {xs:8,     sm:6,   md:6,   lg:4,   xl:4}\r\nconst LeftIndent = (props:any) => <Col {...cs1} className={props.className}></Col>\r\nconst TotalText = (props:any) => <Col {...cs2} className={props.className}><Title level={3}>{props.children}</Title></Col>\r\nconst TotalAmount = (props:any) => <Col {...cs3} style={{textAlign:\"right\"}} className={props.className}><Text>{props.children}</Text></Col>\r\n\r\nconst InvoiceTotals = ({totals}: TotalsTableProps) => {\r\n    return (\r\n        <Row className=\"invoice-totals-table\" gutter={[24, 4]}>\r\n            <LeftIndent></LeftIndent>\r\n            <TotalText>Total Amount</TotalText>\r\n            <TotalAmount>{asMoney(totals.finalPrice)}</TotalAmount>\r\n        </Row>)\r\n}\r\n\r\nexport default InvoiceTotals;","import { useEffect, useState } from 'react';\r\nimport '../../Styles/main.css';\r\nimport { Typography, Divider, message, Collapse, Row, Col, Button, Spin, Empty, Alert, Space } from 'antd';\r\nimport { useAppDispatch, useAppSelector } from '../../store/hooks';\r\nimport * as cs from '../../store/customersSlice';\r\nimport * as es from '../../store/estimatesSlice';\r\nimport * as ds from '../../store/defaultsSlice';\r\nimport { useParams } from \"react-router-dom\";\r\nimport ModuleType from '../../types/ModuleType';\r\nimport ImpactProductComponent from '../ProductSummary/ImpactProductComponent';\r\nimport HardwareComponent from '../ProductSummary/HardwareComponent';\r\nimport { Hardware } from '../../store/Hardware';\r\nimport { ImpactProduct } from '../../store/ImpactProduct';\r\nimport { EstimateItem } from '../../store/EstimateItem';\r\nimport { ProductButtons } from '../ProductSummary/ProductComponent';\r\nimport { isDeleted, isModified, LoadingState } from '../../types/Status';\r\nimport { Estimate } from '../../store/Estimate';\r\nimport { WarningOutlined } from '@ant-design/icons';\r\nimport { asMoney } from \"../../types/formats\";\r\nimport TextArea from 'antd/lib/input/TextArea';\r\nimport CompactCustomerData from './CompactCustomerData';\r\nimport { createEstimateTotals } from '../../store/EstimateTotals';\r\nimport InvoiceTotals from './InvoiceTotals';\r\nimport EstimateOptions from './EstimateOptions';\r\nimport MaterialComponent from '../ProductSummary/MaterialComponent';\r\nimport DesignComponent from '../ProductSummary/DesignComponent';\r\n\r\nconst { Title, Text } = Typography;\r\n\r\nconst isLoading = (statuses: any): boolean => {\r\n    if (!isFailed(statuses)) { // False if something failed\r\n        for (const key in statuses) {\r\n            if (statuses[key] === LoadingState.loading)\r\n                return true;\r\n        }\r\n    }\r\n    return false;\r\n}\r\n\r\nconst isFailed = (statuses: any): boolean => {\r\n    for (const key in statuses) {\r\n        if (statuses[key] === LoadingState.failed)\r\n            return true;\r\n    }\r\n    return false;\r\n}\r\n\r\nconst isLoaded = (statuses: any): boolean => {\r\n    for (const key in statuses) {\r\n        if (![LoadingState.succeeded, LoadingState.unavailable, LoadingState.saving, \"\"].includes(statuses[key]))\r\n            return false;\r\n    }\r\n    return true;\r\n}\r\n\r\ntype RenderProductProps = {\r\n    item: EstimateItem\r\n    readOnly: boolean\r\n}\r\n\r\ninterface ParamTypes {\r\n    eid: string\r\n}\r\n\r\nlet showingError: string = \"\";\r\n\r\ninterface MainProps {\r\n    viewMenu: (eid:number) => JSX.Element\r\n} \r\n\r\nconst Invoice = ({viewMenu}:MainProps) => {\r\n    // Data Access\r\n    const dispatch = useAppDispatch();\r\n    const defaults: ds.DefaultData | undefined = useAppSelector(ds.selectDefaults)\r\n    const id2RoomType:ds.RoomTypeConverterFunction = useAppSelector(ds.selectId2RoomTypeConvertor)\r\n    const estimate: Estimate | undefined = useAppSelector(es.selectEstimate)\r\n    var params = useParams<ParamTypes>();\r\n    const [expandedItems, setExpandedItems] = useState<string | string[]>([]);\r\n\r\n    // Status\r\n    const statuses = {\r\n        customer: useAppSelector(cs.selectCustomerNamesStatus),\r\n        customerDetail: useAppSelector(cs.selectCustomerDetailsStatus),\r\n        estimate: useAppSelector(es.selectEstimateStatus),\r\n        estimateError: useAppSelector(es.selectEstimateError),\r\n        default: useAppSelector(ds.selectDefaultsStatus)\r\n    }\r\n\r\n    if (isFailed(statuses) && showingError === \"\") {\r\n        showingError = statuses.estimateError\r\n        message.error(statuses.estimateError, undefined, () => {\r\n            showingError = \"\"\r\n        });\r\n    }\r\n\r\n    // Data retrieval\r\n    useEffect(() => {\r\n        if (estimate === undefined && defaults?.user.name) {\r\n            dispatch(es.fetchEstimate(Number(params.eid)))\r\n        }\r\n    }, [dispatch, params.eid, estimate, defaults?.user.name])\r\n\r\n    useEffect(() => {\r\n        if (defaults?.colors.length === 0)\r\n            dispatch(ds.fetchDefaults())\r\n    }, [dispatch, defaults])\r\n\r\n    const RenderProduct = ({item, readOnly}:RenderProductProps) => {\r\n        const updateItemNo = (val:number) => \r\n            dispatch(es.updateItem({ ...item, itemno: val }))\r\n        const updateQuantity = (val:number) => \r\n            dispatch(es.updateItem({ ...item, quantity: val }))\r\n        if (estimate) {\r\n            switch(item.modtype) {\r\n                case ModuleType.ImpactProduct:\r\n                    return (<ImpactProductComponent readOnly={readOnly} e={estimate} item={item as ImpactProduct} onUpdateQuantity={updateQuantity} onUpdateItemNo={updateItemNo}/> )\r\n                case ModuleType.Hardware:\r\n                    return (<HardwareComponent readOnly={readOnly} e={estimate} item={item as Hardware} onUpdateQuantity={updateQuantity} onUpdateItemNo={updateItemNo}/>)\r\n                case ModuleType.Material:\r\n                    return (<MaterialComponent readOnly={readOnly} e={estimate} item={item as Hardware} onUpdateQuantity={updateQuantity} onUpdateItemNo={updateItemNo}/>)\r\n                case ModuleType.Design:\r\n                    return (<DesignComponent readOnly={readOnly} e={estimate} item={item as Hardware} onUpdateQuantity={updateQuantity} onUpdateItemNo={updateItemNo}/>)\r\n            }\r\n        }\r\n        return <span>Unknown Product: {item.modtype}</span>\r\n    }\r\n\r\n    const getHeaderFromItem = (item:EstimateItem) => {\r\n        let txt = `Opening ${item.itemno}: ${item.name}`\r\n        if (item.modtype === ModuleType.ImpactProduct) {\r\n            let ip:ImpactProduct = item as ImpactProduct\r\n            let roomtype = id2RoomType(ip.roomtype?.toString())\r\n            if (!roomtype || roomtype === \"Unknown\")\r\n                roomtype = \"Room\"\r\n            txt += ` - ${roomtype} ${ip.roomnum ?? \" number missing\"}`\r\n        }\r\n        txt += ` - ${asMoney(item.sales_price)}`\r\n        if (isModified(item._modified))\r\n            return <Text italic strong>{txt}</Text>\r\n        return <Text>{txt}</Text>\r\n    }\r\n\r\n    const readOnly = true\r\n    const remainingItems = estimate?.items?.filter(i => !isDeleted(i._modified))\r\n    let itemsList = null\r\n    if (isLoading(statuses))\r\n        itemsList = <div className='flex_container_center show4'><Spin style={{ marginLeft: \"1rem\", display: \"flex\", alignSelf: \"center\" }} size=\"large\" /></div>\r\n    if (isFailed(statuses))\r\n        itemsList = <div className='flex_container_center show4'><WarningOutlined style={{ marginLeft: \"1rem\", display: \"flex\", alignSelf: \"center\" }} /></div>\r\n    if (isLoaded(statuses)) {\r\n        if (remainingItems === undefined || remainingItems.length === 0) \r\n            itemsList = <div className='flex_container_center show4'><Empty image={Empty.PRESENTED_IMAGE_SIMPLE} description=\"Empty\" style={{margin: \"0px\"}}/></div>\r\n        else\r\n            itemsList = <Collapse activeKey={expandedItems} onChange={(items) => setExpandedItems(items)}>\r\n                    {\r\n                        remainingItems\r\n                            .sort((a,b) => (a.itemno??0) - (b.itemno??0))\r\n                            .map((item, index) => \r\n                            <Collapse.Panel className=\"item-summary\" header={getHeaderFromItem(item)} key={index} extra={<ProductButtons readOnly={readOnly} item={item} itemIndex={index+1} />}>\r\n                                <RenderProduct item={item} readOnly={readOnly} />\r\n                            </Collapse.Panel>)\r\n                    }\r\n                </Collapse>\r\n    }\r\n\r\n    const totals = createEstimateTotals(estimate, estimate?.add_sales_discount||0, estimate?.add_inst_discount||0, estimate?.permits||0, estimate?.salestax||0)\r\n    \r\n    const customerData = <CompactCustomerData \r\n            estimate={estimate}\r\n            isFailed={isFailed(statuses)}\r\n        />\r\n\r\n    return (\r\n        <>\r\n            <Row>\r\n                <Col xs={24}>\r\n                    <Title level={3} style={{ color: '#32445e', textAlign:\"center\", float: \"left\", width: \"100%\" }}>Invoice</Title>\r\n                    {estimate && estimate.id && viewMenu(estimate.id)}\r\n                </Col>\r\n            </Row>\r\n           \r\n            {customerData}\r\n\r\n            <Row>\r\n                <Col xs={24} sm={24} md={24} lg={24} xl={24}>\r\n                    <Divider />\r\n                    \r\n                    <div className=\"expand-collapse-buttons\"><Button type=\"link\" onClick={() => setExpandedItems(remainingItems?remainingItems?.map((item, index) => index.toString()):[])}>Expand all</Button> | <Button type=\"link\" onClick={() => setExpandedItems([])}>Collapse all</Button></div>\r\n                    {itemsList}\r\n\r\n                    <Divider />\r\n\r\n                    <Title className=\"hide-on-print\" level={5}>Internal Notes:</Title>\r\n                    <TextArea \r\n                        showCount \r\n                        placeholder=\"Internal Notes\" \r\n                        className=\"hide-on-print\"\r\n                        style={{\"marginBottom\": \"2rem\"}}\r\n                        autoSize \r\n                        maxLength={1024}\r\n                        value={estimate?.notes}\r\n                        readOnly={readOnly}\r\n                    />\r\n\r\n                    <Title level={5}>Additional Notes:</Title>\r\n                    <TextArea \r\n                        showCount \r\n                        placeholder=\"Notes\" \r\n                        style={{\"marginBottom\": \"2rem\"}}\r\n                        autoSize \r\n                        maxLength={1024}\r\n                        value={estimate?.public_notes}\r\n                        readOnly={readOnly}\r\n                    />\r\n                </Col>\r\n            </Row>\r\n\r\n            <InvoiceTotals totals={totals} />\r\n\r\n            <Divider />\r\n\r\n            <Row>\r\n                <Col xs={24} sm={24} md={24} lg={24} xl={24}>\r\n                    <EstimateOptions readOnly={readOnly} />\r\n                </Col>\r\n            </Row>\r\n\r\n            <Space direction=\"vertical\" align=\"center\" style={{width: \"100%\", marginTop: \"1rem\"}} className=\"show-on-print\">\r\n                <Alert\r\n                    description={\r\n                        <>\r\n                            <Title level={5} style={{color: \"red\"}}>\r\n                                There will be a 3% charge for using a credit card\r\n                            </Title>\r\n                        </>\r\n                    }\r\n                    type=\"info\"\r\n                    style={{textAlign: \"center\", backgroundColor: \"white\", border: \"0\"}}\r\n                />\r\n            </Space>\r\n        </>\r\n    );\r\n};\r\n\r\nexport default Invoice","import { Layout } from \"antd\";\r\nimport { Content } from \"antd/lib/layout/layout\";\r\nimport Invoice from \"../Components/Estimates/Invoice\";\r\nimport PrintHeader from \"../Components/Estimates/PrintHeader\";\r\n\r\ninterface EstimateProps {\r\n    viewMenu: (eid:number) => JSX.Element\r\n} \r\n\r\nconst InvoiceView = ({viewMenu}:EstimateProps) => {\r\n    return (\r\n        <Layout className={\"print-estimate\"}>\r\n            <Content className='estimateContainer'>\r\n                <PrintHeader />\r\n                <Invoice viewMenu={viewMenu}/>\r\n            </Content>\r\n        </Layout>\r\n    );\r\n};\r\n\r\nexport default InvoiceView","import { Col } from \"antd\";\r\n\r\nexport type SignatureProps = {\r\n    title:string\r\n    name:string\r\n    className?:string\r\n    width:number\r\n}\r\n\r\nconst TitleCol = (props:any) => <Col xs={props.width} md={props.width/4} className={\"signature-title-cell\"+(props.className?\" \"+props.className+\"-cell\":\"\")}><div className={\"signature-title-text\"+(props.className?\" \"+props.className+\"-text\":\"\")}>{props.children}</div></Col>\r\nconst NameCol = (props:any) => <Col xs={props.width} md={props.width*3/4} className={\"signature-name-cell\"+(props.className?\" \"+props.className+\"-cell\":\"\")}><div className={\"signature-name-text\"+(props.className?\" \"+props.className+\"-text\":\"\")}>{props.children}</div></Col>\r\n\r\nconst Signature = ({title, name, className, width}: SignatureProps) => {\r\n    return (\r\n        <>\r\n            <TitleCol width={width} className={className}>{title}:</TitleCol>\r\n            <NameCol width={width} className={className}>{name}</NameCol>\r\n        </>)\r\n}\r\n\r\nexport default Signature;","import { useEffect, useState } from 'react';\r\nimport '../../Styles/main.css';\r\nimport { Typography, Divider, message, Collapse, Row, Col, Button, Spin, Empty, Alert, Space } from 'antd';\r\nimport { useAppDispatch, useAppSelector } from '../../store/hooks';\r\nimport * as cs from '../../store/customersSlice';\r\nimport * as es from '../../store/estimatesSlice';\r\nimport * as ds from '../../store/defaultsSlice';\r\nimport { useParams } from \"react-router-dom\";\r\nimport ModuleType from '../../types/ModuleType';\r\nimport ImpactProductComponent from '../ProductSummary/ImpactProductComponent';\r\nimport HardwareComponent from '../ProductSummary/HardwareComponent';\r\nimport { Hardware } from '../../store/Hardware';\r\nimport { ImpactProduct } from '../../store/ImpactProduct';\r\nimport { EstimateItem } from '../../store/EstimateItem';\r\nimport { ProductButtons } from '../ProductSummary/ProductComponent';\r\nimport { isDeleted, isModified, LoadingState } from '../../types/Status';\r\nimport { Estimate } from '../../store/Estimate';\r\nimport { WarningOutlined } from '@ant-design/icons';\r\nimport { asMoney } from \"../../types/formats\";\r\nimport TextArea from 'antd/lib/input/TextArea';\r\nimport CompactCustomerData from './CompactCustomerData';\r\nimport { createEstimateTotals } from '../../store/EstimateTotals';\r\nimport Signature from './Signature';\r\nimport TotalsTable from './TotalsTable';\r\nimport EstimateOptions from './EstimateOptions';\r\nimport MaterialComponent from '../ProductSummary/MaterialComponent';\r\nimport DesignComponent from '../ProductSummary/DesignComponent';\r\n\r\nconst { Title, Text } = Typography;\r\n\r\nconst isLoading = (statuses: any): boolean => {\r\n    if (!isFailed(statuses)) { // False if something failed\r\n        for (const key in statuses) {\r\n            if (statuses[key] === LoadingState.loading)\r\n                return true;\r\n        }\r\n    }\r\n    return false;\r\n}\r\n\r\nconst isFailed = (statuses: any): boolean => {\r\n    for (const key in statuses) {\r\n        if (statuses[key] === LoadingState.failed)\r\n            return true;\r\n    }\r\n    return false;\r\n}\r\n\r\nconst isLoaded = (statuses: any): boolean => {\r\n    for (const key in statuses) {\r\n        if (![LoadingState.succeeded, LoadingState.unavailable, LoadingState.saving, \"\"].includes(statuses[key]))\r\n            return false;\r\n    }\r\n    return true;\r\n}\r\n\r\ntype RenderProductProps = {\r\n    item: EstimateItem\r\n    readOnly: boolean\r\n}\r\n\r\ninterface ParamTypes {\r\n    eid: string\r\n}\r\n\r\nlet showingError: string = \"\";\r\n\r\ninterface MainProps {\r\n    viewMenu: (eid:number) => JSX.Element\r\n} \r\n\r\nconst Contract = ({viewMenu}:MainProps) => {\r\n    // Data Access\r\n    const dispatch = useAppDispatch();\r\n    const defaults: ds.DefaultData | undefined = useAppSelector(ds.selectDefaults)\r\n    const id2RoomType:ds.RoomTypeConverterFunction = useAppSelector(ds.selectId2RoomTypeConvertor)\r\n    const estimate: Estimate | undefined = useAppSelector(es.selectEstimate)\r\n    var params = useParams<ParamTypes>();\r\n    const [expandedItems, setExpandedItems] = useState<string | string[]>([]);\r\n\r\n    // Status\r\n    const statuses = {\r\n        customer: useAppSelector(cs.selectCustomerNamesStatus),\r\n        customerDetail: useAppSelector(cs.selectCustomerDetailsStatus),\r\n        estimate: useAppSelector(es.selectEstimateStatus),\r\n        estimateError: useAppSelector(es.selectEstimateError),\r\n        default: useAppSelector(ds.selectDefaultsStatus)\r\n    }\r\n\r\n    if (isFailed(statuses) && showingError === \"\") {\r\n        showingError = statuses.estimateError\r\n        message.error(statuses.estimateError, undefined, () => {\r\n            showingError = \"\"\r\n        });\r\n    }\r\n\r\n    // Data retrieval\r\n    useEffect(() => {\r\n        if (estimate === undefined && defaults?.user.name) {\r\n            dispatch(es.fetchEstimate(Number(params.eid)))\r\n        }\r\n    }, [dispatch, params.eid, estimate, defaults?.user.name])\r\n\r\n    useEffect(() => {\r\n        if (defaults?.colors.length === 0)\r\n            dispatch(ds.fetchDefaults())\r\n    }, [dispatch, defaults])\r\n\r\n    const RenderProduct = ({item, readOnly}:RenderProductProps) => {\r\n        const updateItemNo = (val:number) => \r\n            dispatch(es.updateItem({ ...item, itemno: val }))\r\n        const updateQuantity = (val:number) => \r\n            dispatch(es.updateItem({ ...item, quantity: val }))\r\n        if (estimate) {\r\n            switch(item.modtype) {\r\n                case ModuleType.ImpactProduct:\r\n                    return (<ImpactProductComponent readOnly={readOnly} e={estimate} item={item as ImpactProduct} onUpdateQuantity={updateQuantity} onUpdateItemNo={updateItemNo}/> )\r\n                case ModuleType.Hardware:\r\n                    return (<HardwareComponent readOnly={readOnly} e={estimate} item={item as Hardware} onUpdateQuantity={updateQuantity} onUpdateItemNo={updateItemNo}/>)\r\n                case ModuleType.Material:\r\n                    return (<MaterialComponent readOnly={readOnly} e={estimate} item={item as Hardware} onUpdateQuantity={updateQuantity} onUpdateItemNo={updateItemNo}/>)\r\n                case ModuleType.Design:\r\n                    return (<DesignComponent readOnly={readOnly} e={estimate} item={item as Hardware} onUpdateQuantity={updateQuantity} onUpdateItemNo={updateItemNo}/>)\r\n            }\r\n        }\r\n        return <span>Unknown Product: {item.modtype}</span>\r\n    }\r\n\r\n    const getHeaderFromItem = (item:EstimateItem) => {\r\n        let txt = `Opening ${item.itemno}: ${item.name}`\r\n        if (item.modtype === ModuleType.ImpactProduct) {\r\n            let ip:ImpactProduct = item as ImpactProduct\r\n            let roomtype = id2RoomType(ip.roomtype?.toString())\r\n            if (!roomtype || roomtype === \"Unknown\")\r\n                roomtype = \"Room\"\r\n            txt += ` - ${roomtype} ${ip.roomnum ?? \" number missing\"}`\r\n        }\r\n        txt += ` - ${asMoney(item.sales_price)}`\r\n        if (isModified(item._modified))\r\n            return <Text italic strong>{txt}</Text>\r\n        return <Text>{txt}</Text>\r\n    }\r\n\r\n    const readOnly = true\r\n    const remainingItems = estimate?.items?.filter(i => !isDeleted(i._modified))\r\n    let itemsList = null\r\n    if (isLoading(statuses))\r\n        itemsList = <div className='flex_container_center show4'><Spin style={{ marginLeft: \"1rem\", display: \"flex\", alignSelf: \"center\" }} size=\"large\" /></div>\r\n    if (isFailed(statuses))\r\n        itemsList = <div className='flex_container_center show4'><WarningOutlined style={{ marginLeft: \"1rem\", display: \"flex\", alignSelf: \"center\" }} /></div>\r\n    if (isLoaded(statuses)) {\r\n        if (remainingItems === undefined || remainingItems.length === 0) \r\n            itemsList = <div className='flex_container_center show4'><Empty image={Empty.PRESENTED_IMAGE_SIMPLE} description=\"Empty\" style={{margin: \"0px\"}}/></div>\r\n        else\r\n            itemsList = <Collapse activeKey={expandedItems} onChange={(items) => setExpandedItems(items)}>\r\n                    {\r\n                        remainingItems\r\n                            .sort((a,b) => (a.itemno??0) - (b.itemno??0))\r\n                            .map((item, index) => \r\n                            <Collapse.Panel className=\"item-summary\" header={getHeaderFromItem(item)} key={index} extra={<ProductButtons readOnly={readOnly} item={item} itemIndex={index+1} />}>\r\n                                <RenderProduct item={item} readOnly={readOnly} />\r\n                            </Collapse.Panel>)\r\n                    }\r\n                </Collapse>\r\n    }\r\n\r\n    const totals = createEstimateTotals(estimate, estimate?.add_sales_discount||0, estimate?.add_inst_discount||0, estimate?.permits||0, estimate?.salestax||0)\r\n    \r\n    const customerData = <CompactCustomerData \r\n            estimate={estimate}\r\n            isFailed={isFailed(statuses)}\r\n        />\r\n\r\n    return (\r\n        <>\r\n            <Row>\r\n                <Col xs={24}>\r\n                    <Title level={3} style={{ color: '#32445e', textAlign:\"center\", float: \"left\", width: \"100%\" }}>Contract</Title>\r\n                    {estimate && estimate.id && viewMenu(estimate.id)}\r\n                </Col>\r\n            </Row>\r\n           \r\n            {customerData}\r\n\r\n            <Row>\r\n                <Col xs={24} sm={24} md={24} lg={24} xl={24}>\r\n                    <Divider />\r\n                    \r\n                    <div className=\"expand-collapse-buttons\"><Button type=\"link\" onClick={() => setExpandedItems(remainingItems?remainingItems?.map((item, index) => index.toString()):[])}>Expand all</Button> | <Button type=\"link\" onClick={() => setExpandedItems([])}>Collapse all</Button></div>\r\n                    {itemsList}\r\n\r\n                    <Divider />\r\n\r\n                    <Title className=\"hide-on-print\" level={5}>Internal Notes:</Title>\r\n                    <TextArea \r\n                        showCount \r\n                        placeholder=\"Internal Notes\" \r\n                        className=\"hide-on-print\"\r\n                        style={{\"marginBottom\": \"2rem\"}}\r\n                        autoSize \r\n                        maxLength={1024}\r\n                        value={estimate?.notes}\r\n                        readOnly={readOnly}\r\n                    />\r\n\r\n                    <Title level={5}>Additional Notes:</Title>\r\n                    <TextArea \r\n                        showCount \r\n                        placeholder=\"Notes\" \r\n                        style={{\"marginBottom\": \"2rem\"}}\r\n                        autoSize \r\n                        maxLength={1024}\r\n                        value={estimate?.public_notes}\r\n                        readOnly={readOnly}\r\n                    />\r\n                </Col>\r\n            </Row>\r\n\r\n            <TotalsTable \r\n                totals={totals} \r\n                includeInstallation={estimate?.is_installation_included || false}\r\n                readOnly={readOnly}\r\n            />\r\n\r\n            <Divider />\r\n\r\n            <Row>\r\n                <Col xs={24} sm={24} md={24} lg={24} xl={24}>\r\n                    <EstimateOptions readOnly={readOnly} />\r\n                </Col>\r\n            </Row>\r\n\r\n            <Space direction=\"vertical\" align=\"center\" style={{width: \"100%\", marginTop: \"1rem\"}} className=\"show-on-print\">\r\n                <Alert\r\n                    description={\r\n                        <>\r\n                            <Title level={5} style={{color: \"red\"}}>\r\n                                There will be a 3% charge for using a credit card\r\n                            </Title>\r\n                        </>\r\n                    }\r\n                    type=\"info\"\r\n                    style={{textAlign: \"center\", backgroundColor: \"white\", border: \"0\"}}\r\n                />\r\n            </Space>\r\n\r\n            <Row>\r\n                <Signature title=\"Qualifier\" name={estimate?.qualifiername || \"\"} className=\"qualifier\" width={12}/>\r\n                <Signature title=\"Accepted By\" name={estimate?.customer?.customername || \"\"} className=\"accepted-by\" width={12}/>\r\n                <Signature title=\"Representative\" name={estimate?.vendor || \"\"} className=\"representative\" width={12}/>\r\n            </Row>\r\n        </>\r\n    );\r\n};\r\n\r\nexport default Contract","import { Layout } from \"antd\";\r\nimport { Content } from \"antd/lib/layout/layout\";\r\nimport Contract from \"../Components/Estimates/Contract\";\r\nimport PrintHeader from \"../Components/Estimates/PrintHeader\";\r\n\r\ninterface EstimateProps {\r\n    viewMenu: (eid:number) => JSX.Element\r\n} \r\n\r\nconst ContractView = ({viewMenu}:EstimateProps) => {\r\n    return (\r\n        <Layout className={\"print-estimate\"}>\r\n            <Content className='estimateContainer'>\r\n                <PrintHeader />\r\n                <Contract viewMenu={viewMenu}/>\r\n            </Content>\r\n        </Layout>\r\n    );\r\n};\r\n\r\nexport default ContractView","import { Suspense, useEffect, useMemo } from 'react';\r\nimport AppLayout from './Layout/Layout';\r\nimport { Switch, Route, useHistory, useLocation } from \"react-router-dom\";\r\nimport { AppstoreOutlined, CloseOutlined, DollarCircleOutlined, EditOutlined, MenuFoldOutlined, SolutionOutlined } from '@ant-design/icons';\r\nimport { Dropdown, Menu } from 'antd';\r\n\r\nimport Home from './Pages/Home';\r\nimport EstimateView from './Pages/EstimateView';\r\nimport ModuleImpactProducts from './Pages/ImpactProduct';\r\nimport ModuleMaterials from './Pages/Material';\r\nimport ModuleDesign from './Pages/Design';\r\nimport ModuleHardware from './Pages/Hardware';\r\nimport NoPrint from './Pages/NoPrint';\r\nimport InvoiceView from './Pages/InvoiceView';\r\nimport ContractView from './Pages/ContractView';\r\n\r\ninterface AppRoutes {\r\n  canPrint: () => boolean\r\n  showEstimate: (eid:number) => void\r\n  showPrintableEstimate: (eid:number) => void\r\n  showInvoice: (eid:number) => void\r\n  showContract: (eid:number) => void\r\n  showNoPrint: () => void\r\n  closeEstimate: () => void\r\n  getMenuKey: () => string\r\n}\r\n\r\nexport const useAppRoutes = ():AppRoutes => {\r\n  const history = useHistory()\r\n  const location = useLocation()\r\n\r\n  return useMemo(() => ({\r\n      canPrint: () => location.pathname.startsWith(\"/estimate\") || location.pathname.startsWith(\"/invoice\") || location.pathname.startsWith(\"/contract\"),\r\n      showEstimate: (eid:number) => history.push(`/${eid}`),\r\n      showPrintableEstimate: (eid:number) => history.push(`/estimate/${eid}`),\r\n      showInvoice: (eid:number) => history.push(`/invoice/${eid}`),\r\n      showContract: (eid:number) => history.push(`/contract/${eid}`),\r\n      showNoPrint: () => history.push(location.pathname.replace('/','/noprint/')),\r\n      closeEstimate: () => { \r\n        history.push(`/`); \r\n        window.location.href=window.location.href + \"../list.php\" \r\n      },\r\n      getMenuKey: () => location.pathname.startsWith(\"/estimate\") ? \"estimate\" : location.pathname.startsWith(\"/invoice\") ? \"invoice\" : location.pathname.startsWith(\"/contract\") ? \"contract\" : \"home\"\r\n    }), [history, location])\r\n}\r\n\r\nexport interface MenuItemData {\r\n  key: string\r\n  title: string\r\n  icon: JSX.Element\r\n  onclick: () => void\r\n}\r\nexport type MenuItemInfo = MenuItemData | string\r\n\r\nconst getMenuItems = (eid:number, appRoutes:AppRoutes):MenuItemInfo[] => [\r\n    {\r\n      key: \"home\",\r\n      title: \"Home\",\r\n      icon: <EditOutlined />,\r\n      onclick: () => appRoutes.showEstimate(eid)\r\n    },\r\n    {\r\n      key: \"estimate\",\r\n      title: \"Print Estimate\",\r\n      icon: <AppstoreOutlined />,\r\n      onclick: () => appRoutes.showPrintableEstimate(eid)\r\n    },\r\n    {\r\n      key: \"invoice\",\r\n      title: \"Print Invoice\",\r\n      icon: <DollarCircleOutlined />,\r\n      onclick: () => appRoutes.showInvoice(eid)\r\n    },\r\n    {\r\n      key: \"contract\",\r\n      title: \"Print Contract\",\r\n      icon: <SolutionOutlined />,\r\n      onclick: () => appRoutes.showContract(eid)\r\n    },\r\n    \"div\",\r\n    {\r\n      key: \"close\",\r\n      title: \"Close Estimate\",\r\n      icon: <CloseOutlined />,\r\n      onclick: () => appRoutes.closeEstimate()\r\n    },\r\n  ]\r\n\r\nconst Routes = () => {\r\n  const appRoutes = useAppRoutes()\r\n  const menuKey = appRoutes.getMenuKey()\r\n\r\n  const beforePrint = () => {\r\n    if (!appRoutes.canPrint())\r\n      appRoutes.showNoPrint()\r\n  }\r\n\r\n  useEffect(() => {\r\n      window.addEventListener(\"beforeprint\", beforePrint);\r\n      return () => window.removeEventListener(\"beforeprint\", beforePrint)\r\n  })\r\n\r\n  const overlay = (eid:number) => \r\n    <Menu selectedKeys={[menuKey]}>\r\n      {getMenuItems(eid, appRoutes).map((v, i) => {\r\n          if (v===\"div\")\r\n            return <Menu.Divider key={\"\"+i} style={{margin: \".5em 0em\"}} />\r\n          const mi = v as MenuItemData\r\n          return <Menu.Item key={mi.key} icon={mi.icon} onClick={mi.onclick}>{mi.title}</Menu.Item>\r\n        })\r\n      }\r\n    </Menu>\r\n\r\n  const menu = (eid:number) => (<Dropdown.Button overlay={overlay(eid)} icon={<MenuFoldOutlined />} style={{ marginLeft: \"-5em\", marginTop: \".5em\"}} className=\"hide-on-print-only\"/>)\r\n\r\n  return (\r\n    <div className=\"estimatesv2\">\r\n      <Suspense fallback={<h1>Loading</h1>}>\r\n        <AppLayout>\r\n          <Switch>\r\n            <Route exact path='/hardware/:eid?/:iid?' component={ModuleHardware} />\r\n            <Route path='/impact/:eid?/:iid?' component={ModuleImpactProducts} />\r\n            <Route path='/material/:eid?/:iid?' component={ModuleMaterials} />\r\n            <Route path='/design/:eid?/:iid?' component={ModuleDesign} />\r\n            <Route path='/estimate/:eid?'><EstimateView viewMenu={menu} /></Route>\r\n            <Route path='/invoice/:eid?'><InvoiceView viewMenu={menu} /></Route>\r\n            <Route path='/Contract/:eid?'><ContractView viewMenu={menu} /></Route>\r\n            <Route path='/noprint/:eid?'><NoPrint getMenuItems={getMenuItems}/></Route>\r\n            <Route path='/:eid?'><Home viewMenu={menu} /></Route>\r\n          </Switch>\r\n        </AppLayout>\r\n      </Suspense>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default Routes;","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport { BrowserRouter } from 'react-router-dom';\r\nimport Routes from './routes';\r\n\r\nimport store from './store/store'\r\nimport { Provider } from 'react-redux'\r\n\r\nvar appElement = document.getElementById('root');\r\n\r\nReactDOM.render(\r\n  <React.StrictMode>\r\n    <Provider store={store}>\r\n      <BrowserRouter basename={`${process.env.REACT_APP_ROUTES_URL}`}>\r\n        <Routes />\r\n      </BrowserRouter>\r\n    </Provider>\r\n  </React.StrictMode>,\r\n  appElement\r\n);\r\n"],"sourceRoot":""}